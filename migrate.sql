-- Populate lookup tables in the new schema using data from the 2025-09-23 dump.
BEGIN;

INSERT INTO sexes (id, sexe) VALUES
  (1, 'femme'),
  (2, 'homme'),
  (3, 'autre')
ON CONFLICT (id) DO NOTHING;

INSERT INTO nationalites (id, nationalite) VALUES
  (1, 'française'),
  (2, 'américaine'),
  (3, 'allemande'),
  (4, 'italienne'),
  (5, 'espagnole'),
  (6, 'chinoise'),
  (7, 'japonaise'),
  (8, 'russe'),
  (9, 'canadienne'),
  (10, 'brésilienne'),
  (11, 'indienne'),
  (12, 'mexicaine'),
  (13, 'argentine'),
  (14, 'australienne'),
  (15, 'sud-africaine'),
  (16, 'nigériane'),
  (17, 'égyptienne'),
  (18, 'marocaine'),
  (19, 'algérienne'),
  (20, 'tunisienne'),
  (21, 'libyenne'),
  (22, 'soudanaise'),
  (23, 'éthiopienne'),
  (24, 'kenyane'),
  (25, 'ougandaise'),
  (26, 'rwandaise'),
  (27, 'tanzanienne'),
  (28, 'gabonaise'),
  (29, 'congolaise'),
  (30, 'angolaise'),
  (31, 'mozambicaine'),
  (32, 'cap-verdienne'),
  (33, 'sénégalaise'),
  (34, 'malienne'),
  (35, 'burkinabée'),
  (36, 'nigérienne'),
  (37, 'tchadienne'),
  (38, 'centrafricaine'),
  (39, 'camerounaise'),
  (40, 'gabonaise'),
  (41, 'équato-guinéenne'),
  (42, 'gabonaise'),
  (43, 'malgache'),
  (44, 'togolaise'),
  (45, 'roumaine'),
  (46, 'hongroise'),
  (47, 'slovaque'),
  (48, 'albanaise'),
  (49, 'belge'),
  (50, 'taïwanaise'),
  (51, 'turque'),
  (52, 'tchèque'),
  (53, 'vietnamienne'),
  (54, 'équatorienne'),
  (55, 'kazakhe'),
  (56, 'luxembourgeoise'),
  (57, 'ukrainienne'),
  (58, 'anglaise')
ON CONFLICT (id) DO NOTHING;

INSERT INTO grades (id, grade) VALUES
  (1, 'classe normale'),
  (2, 'hors classe'),
  (3, 'classe exceptionnelle'),
  (4, '1ère classe'),
  (5, '2ème classe')
ON CONFLICT (id) DO NOTHING;

INSERT INTO corps_chercheurs (id, corps) VALUES
  (1, 'chargé de recherche'),
  (2, 'directeur de recherche'),
  (5, 'Inria Starting Faculty Position')
ON CONFLICT (id) DO NOTHING;

INSERT INTO corps_enseignants_chercheurs (id, corps) VALUES
  (3, 'maître de conférences'),
  (4, 'professeur'),
  (5, 'Inria Starting Faculty Position'),
  (6, 'professeur agrégé'),
  (7, 'Chaire de Professeur Junior')
ON CONFLICT (id) DO NOTHING;

INSERT INTO corps_biatss (id, corps) VALUES
  (8, 'TCH'),
  (9, 'AI'),
  (10, 'IE'),
  (11, 'IR'),
  (12, 'AJT'),
  (13, 'postdoc')
ON CONFLICT (id) DO NOTHING;

INSERT INTO categories_financements_theses (id, categorie, description) VALUES
  (1, 'CD', 'Financement d''état'),
  (2, 'CDCOL', 'Collectivités territoriales (dont financement régionaux)'),
  (3, 'CDAGE', 'Agences françaises de financements publics de la recherche'),
  (4, 'CIFRE', 'Convention CIFRE'),
  (5, 'CDORG', 'Financements privés d''organisations implantées en France'),
  (6, 'CDUE', 'Financements de la commission européenne'),
  (7, 'CDETR', 'Financements étrangers'),
  (8, 'CDFC', 'Financements des organismes de formation continue'),
  (9, 'CDINT', 'Organismes internationaux'),
  (10, 'AUT', 'Autres')
ON CONFLICT (id) DO NOTHING;

INSERT INTO laboratoires (id, nom, acronyme, numero, date_creation) VALUES
  (1, 'Laboratoire Bordelais de Recherche en Informatique', 'LaBRI', 5800, '1987-01-01')
ON CONFLICT (id) DO NOTHING;



INSERT INTO ecoles_doctorales (id, ecole_doctorale, numero) VALUES
  (1, 'EDMI', 39),
  (3, 'autre', 0)
ON CONFLICT (id) DO NOTHING;

INSERT INTO personnes (id, nom, prenom, sexe, nationalite, date_naissance) VALUES
  (1, 'AGULLO', 'Emanuel', 2, NULL, '1981-02-18'),
  (2, 'AHMED', 'Toufik', 2, NULL, '1976-08-03'),
  (3, 'ALEXANDRE', 'Frédéric', 2, NULL, '1964-05-31'),
  (4, 'ALLALI', 'Julien', 2, NULL, '1977-06-01'),
  (5, 'AUBER', 'David', 2, NULL, '1975-04-15'),
  (6, 'AUMAGE', 'Olivier', 2, NULL, '1976-05-16'),
  (7, 'AVAL', 'Jean-Christophe', 2, NULL, '1974-07-08'),
  (8, 'BACH', 'Benjamin', 2, NULL, '2000-01-01'),
  (9, 'BALDACCI', 'Fabien', 2, NULL, '1982-12-04'),
  (10, 'BARLA', 'Pascal', 2, NULL, '1980-08-12'),
  (11, 'BARTHOU', 'Denis', 2, NULL, '1970-12-02'),
  (12, 'BASSET', 'Jean', 2, NULL, '1995-09-07'),
  (13, 'BAUDON', 'Olivier', 2, NULL, '1962-02-14'),
  (14, 'BEAUMONT', 'Olivier', 2, NULL, '1970-09-16'),
  (15, 'BENARD', 'Pierre', 2, NULL, '1985-01-27'),
  (16, 'BENOIS-PINEAU', 'Jenny', 1, NULL, '1960-05-04'),
  (17, 'BERGER RIDEL', 'Héléna', 1, NULL, '1975-06-16'),
  (18, 'BEURTON-AIMAR', 'Marie', 1, NULL, '1958-01-19'),
  (19, 'BIANCHI', 'Giuliana', 1, NULL, '1955-01-19'),
  (20, 'BIENVENU', 'Meghyn', 1, NULL, '1981-10-14'),
  (21, 'BIENVENU', 'Laurent', 2, NULL, '1981-10-31'),
  (22, 'BIGO', 'Louis', 2, NULL, '1986-07-14'),
  (23, 'BILLAUD', 'Michel', 2, NULL, '1958-08-01'),
  (24, 'BLANC', 'Carole', 1, NULL, '1965-05-06'),
  (25, 'BLANC', 'Xavier', 2, NULL, '1975-10-03'),
  (26, 'BLIN', 'Guillaume', 2, NULL, '1979-12-21'),
  (27, 'BON', 'Elisabeth', 1, NULL, '1968-04-14'),
  (28, 'BONAMY', 'Marthe', 1, NULL, '1990-10-02'),
  (29, 'BONICHON', 'Nicolas', 2, NULL, '1975-01-16'),
  (30, 'BOUCHARD', 'Sébastien', 2, NULL, '1990-09-21'),
  (31, 'BOURGEAIS', 'Victoria', 1, NULL, '1996-07-02'),
  (32, 'BOURQUI', 'Romain', 2, NULL, '1981-10-31'),
  (33, 'BOUSQUET-MELOU', 'Mireille', 1, NULL, '1967-05-12'),
  (34, 'BOUSSICAULT', 'Adrien', 2, NULL, '1982-11-08'),
  (35, 'BRAQUELAIRE', 'Achille', 2, NULL, '1958-02-24'),
  (36, 'BRUNEAU-QUEYREIX', 'Joachim', 2, NULL, '1991-02-07'),
  (37, 'BUGEAU', 'Aurélie', 1, NULL, '1982-09-17'),
  (38, 'CARRERE', 'Fréderique', 1, NULL, '1961-06-08'),
  (39, 'CASTEIGTS', 'Arnaud', 2, NULL, '1980-12-30'),
  (40, 'CHAUMETTE', 'Serge', 2, NULL, '1966-10-04'),
  (41, 'CLEMENT', 'Michael', 2, NULL, '1990-04-11'),
  (42, 'CLEMENT', 'Lionel', 2, NULL, '1964-11-18'),
  (43, 'CONSEL', 'Charles', 2, NULL, '1960-08-22'),
  (44, 'COULAUD', 'Olivier', 2, NULL, '1961-08-29'),
  (45, 'COUNILH', 'Marie-Christine', 1, NULL, '1961-04-26'),
  (46, 'COUPE', 'Pierrick', 2, NULL, '1980-03-28'),
  (47, 'DANIEL', 'Mélodie', 1, NULL, '1995-10-31'),
  (48, 'DEGUEULE', 'Thomas', 2, NULL, '1990-01-29'),
  (49, 'DELBRUEL', 'Stéphane', 2, NULL, '1986-02-01'),
  (50, 'DELECROIX', 'Vincent', 2, NULL, '1984-10-26'),
  (51, 'DELMAS', 'Olivier', 2, NULL, '1967-04-30'),
  (52, 'DELORD', 'Xavier', 2, NULL, '1964-10-23'),
  (53, 'DENIS', 'Alexandre', 2, NULL, '1977-05-28'),
  (54, 'DESAINTE-CATHERINE', 'Myriam', 1, NULL, '1958-02-13'),
  (55, 'DESBARATS', 'Pascal', 2, NULL, '1972-08-28'),
  (56, 'DIALLO', 'Gayo', 2, NULL, '1975-08-12'),
  (57, 'DOMENGER', 'Jean-Philippe', 2, NULL, '1963-04-25'),
  (58, 'DRAGICEVIK', 'Pierre', 2, NULL, '1973-08-08'),
  (59, 'DROSS', 'François', 2, NULL, '1991-05-05'),
  (60, 'DUCHON', 'Philippe', 2, NULL, '1969-10-17'),
  (61, 'DULUCQ', 'Serge', 2, NULL, '1957-01-25'),
  (62, 'DURAND', 'Irène', 1, NULL, '1961-12-13'),
  (63, 'DURRENS', 'Pascal', 2, NULL, '1956-06-16'),
  (64, 'DUTOUR', 'Isabelle', 1, NULL, '1969-03-10'),
  (65, 'ESNARD', 'Aurélien', 2, NULL, '1978-10-12'),
  (66, 'EYRAUD-DUBOIS', 'Lionel', 2, NULL, '1980-09-30'),
  (67, 'FALLERI', 'Jean-Remy', 2, NULL, '1982-10-09'),
  (68, 'FAVERGE', 'Mathieu', 2, NULL, '1983-11-11'),
  (69, 'FELIX', 'Patrick', 2, NULL, '1957-02-21'),
  (70, 'FERRARO', 'Charles Pascal', 2, NULL, '1972-08-22'),
  (71, 'FIGUEIRA', 'Diego', 2, NULL, '1980-09-02'),
  (72, 'FIJALKOW', 'Nathanaël', 2, NULL, '1987-08-01'),
  (73, 'FIJALKOW', 'Joanna', 1, NULL, '1986-05-02'),
  (74, 'FLEURY', 'Emmanuel', 2, NULL, '1972-03-08'),
  (75, 'FRIOUX', 'Clemence', 1, NULL, '1992-05-25'),
  (76, 'GAUWIN', 'Olivier', 2, NULL, '1980-03-24'),
  (77, 'GAVOILLE', 'Cyril', 2, NULL, '1970-12-27'),
  (78, 'GIMBERT', 'Hugo', 2, NULL, '1979-04-20'),
  (79, 'GIOT', 'Romain', 2, NULL, '1984-12-08'),
  (80, 'GIOVANNANGELI', 'Loann', 2, NULL, '1996-11-09'),
  (81, 'GIRAUD', 'Luc', 2, NULL, '1965-07-16'),
  (82, 'GOGLIN', 'Brice', 2, NULL, '1978-11-26'),
  (83, 'GONZATO', 'Jean-Christophe', 2, NULL, '1971-05-02'),
  (84, 'GRELLOIS', 'Charles', 2, NULL, '1988-02-05'),
  (85, 'GRIFFAULT', 'Alain', 2, NULL, '1960-02-20'),
  (86, 'GUENNEBAUD', 'Gaël', 2, NULL, '1980-03-17'),
  (87, 'GUEORGUIEVA', 'Stefka', 1, NULL, '1961-06-27'),
  (88, 'GUERMOUCHE', 'Abdou', 2, NULL, '1978-11-13'),
  (89, 'GUERMOUCHE', 'Amina', 1, NULL, '1985-03-05'),
  (90, 'GUIBERT', 'Olivier', 2, NULL, '1965-08-28'),
  (91, 'GUITTON', 'Pascal', 2, NULL, '1959-02-09'),
  (93, 'HACHET', 'Martin', 2, NULL, '1977-05-13'),
  (94, 'HAMOUDI', 'Yassine', 2, NULL, '1993-01-06'),
  (95, 'HANNA', 'Pierre', 2, NULL, '1974-05-19'),
  (96, 'HANUSSE', 'Nicolas', 2, NULL, '1972-01-03'),
  (97, 'HERBRETEAU', 'Frédéric', 2, NULL, '1975-11-21'),
  (98, 'IDRISSI KAISSOUNI', 'Sihame', 1, NULL, '1975-12-05'),
  (99, 'JEANNOT', 'Emmanuel', 2, NULL, '1969-05-07'),
  (100, 'HOCQUARD', 'Hervé', 2, NULL, '1974-07-17'),
  (101, 'JURINE', 'Fabrice', 2, NULL, '1971-04-03'),
  (102, 'KELLY', 'Michaël', 2, NULL, '1986-08-27'),
  (103, 'KING', 'Steven', 2, NULL, '1957-10-08'),
  (104, 'KLASING', 'Ralf', 2, NULL, '1964-01-01'),
  (105, 'KOUA', 'Alexandre', 2, NULL, '1989-02-10'),
  (106, 'KUNTZ', 'Pierre', 2, NULL, '1974-08-04'),
  (107, 'KYPRIANOU', 'Antoine', 2, NULL, '1965-12-11'),
  (108, 'LAKHLEF', 'Hicham', 2, NULL, '1994-08-17'),
  (109, 'LAMALI', 'Mohamed Lamine', 2, NULL, '1985-01-31'),
  (110, 'LAPOIRE', 'Denis', 2, NULL, '1965-09-22'),
  (111, 'LE BORGNE', 'Yvan', 2, NULL, '1976-04-05'),
  (112, 'LE METAYER', 'Daniel', 2, NULL, '1957-05-21'),
  (113, 'LEPETIT', 'Vincent', 2, NULL, '1970-04-05'),
  (114, 'LEVI', 'Gabriele', 2, NULL, '1987-06-08'),
  (115, 'LIMA PILLA', 'Laercio', 2, NULL, '1987-05-26'),
  (116, 'LIORET', 'Roselyne', 1, NULL, '1960-10-17'),
  (117, 'LITMAN', 'Diane', 1, NULL, '1968-07-06'),
  (118, 'LOMBARDY', 'Sylvain', 2, NULL, '1975-10-15'),
  (119, 'LOTTE', 'Fabien', 2, NULL, '1983-03-20'),
  (120, 'LY', 'Olivier', 2, NULL, '1973-04-04'),
  (121, 'MAABOUT', 'Sofian', 2, NULL, '1967-06-23'),
  (122, 'MAGNASCAK', 'Barbora', 1, NULL, '1987-08-24'),
  (123, 'MAHIEUT', 'François', 2, NULL, '1980-04-18'),
  (124, 'MALOT', 'Mickael', 2, NULL, '1976-09-03'),
  (125, 'MANNEVILLE', 'Laure', 1, NULL, '1974-02-17'),
  (126, 'MARCKERT', 'Jean-Francois', 2, NULL, '1972-07-30'),
  (127, 'MARTIN', 'Eric', 2, NULL, '1968-04-28'),
  (128, 'MASSIAS', 'Henri', 2, NULL, '1962-07-17'),
  (129, 'MAZOIT', 'Frédéric', 2, NULL, '1975-02-09'),
  (130, 'MERCIER', 'Guillaume', 2, NULL, '1976-07-24'),
  (131, 'MERCIER', 'Mathieu', 2, NULL, '1985-12-05'),
  (132, 'MILANI', 'Alessia', 1, NULL, '1976-01-14'),
  (133, 'MORANDAT', 'Floréal', 2, NULL, '1982-08-21'),
  (134, 'NARBEL', 'Philippe', 2, NULL, '1963-06-18'),
  (135, 'NICOLAS', 'Henri', 2, NULL, '1965-12-07'),
  (136, 'NICKLAUS', 'Rémi', 2, NULL, '1987-07-31'),
  (137, 'PAILLARD', 'Tristan', 2, NULL, '1986-04-08'),
  (138, 'PALLEZ-AUPY', 'Guillaume', 2, NULL, '1988-11-20'),
  (139, 'PARENT', 'Christian', 2, NULL, '1959-03-08'),
  (140, 'PASSAULT', 'Grégoire', 2, NULL, '1989-07-11'),
  (141, 'PECHER', 'Arnaud', 2, NULL, '1973-05-15'),
  (142, 'PELLEGRINI', 'François', 2, NULL, '1968-10-19'),
  (143, 'PENAULT-LORENZ', 'Aurélien', 2, NULL, '1978-01-07'),
  (144, 'PETER', 'Andréa', 1, NULL, '1986-06-06'),
  (145, 'PHILIPPART', 'Pierre', 2, NULL, '1972-01-31'),
  (146, 'PIALAULT', 'Sophie', 1, NULL, '1974-04-24'),
  (147, 'PLACE', 'Thomas', 2, NULL, '1983-06-17'),
  (148, 'POPOV', 'Mihail', 2, NULL, '1990-03-13'),
  (149, 'PORTAIL', 'Laurent', 2, NULL, '1966-02-23'),
  (150, 'PRIVAT', 'Gilles', 2, NULL, '1961-06-13'),
  (151, 'RAMET', 'Pierre', 2, NULL, '1971-10-13'),
  (152, 'RASKIN', 'Mikhaïl', 2, NULL, '1987-08-21'),
  (153, 'RENAULT', 'David', 2, NULL, '1977-02-02'),
  (154, 'REUTER', 'Patrick', 2, NULL, '1974-05-20'),
  (155, 'RIVAL', 'Xavier', 2, NULL, '1978-07-29'),
  (156, 'ROBERT', 'Stéphane', 2, NULL, '1959-11-17'),
  (157, 'ROBINE', 'Matthias', 2, NULL, '1976-11-11'),
  (158, 'ROLLAND', 'Jean-Raymond', 2, NULL, '1968-02-04'),
  (159, 'ROLLET', 'Antoine', 2, NULL, '1978-03-31'),
  (160, 'ROUGIER', 'Nicolas', 2, NULL, '1972-02-14'),
  (161, 'RUNDELL', 'David', 2, NULL, '1959-02-19'),
  (162, 'SADOU', 'Nouria', 1, NULL, '1965-08-31'),
  (163, 'SANDON', 'Claude', 1, NULL, '1962-12-17'),
  (164, 'SCHAEFFER', 'Guilhem', 2, NULL, '1988-03-17'),
  (165, 'SCHLICK', 'Christophe', 2, NULL, '1966-01-22'),
  (166, 'SERRANO', 'Melina', 1, NULL, '1983-05-31'),
  (167, 'SIMON', 'Laurent', 2, NULL, '1973-04-09'),
  (168, 'SOPENA', 'Eric', 2, NULL, '1961-01-12'),
  (169, 'STANTON', 'Isabelle', 1, NULL, '1977-04-08'),
  (170, 'STRANDH', 'Robert', 2, NULL, '1955-02-09'),
  (171, 'SOPENA', 'Nathalie', 1, NULL, '1973-02-08'),
  (172, 'SUTRE', 'Gregoire', 2, NULL, '1975-03-04'),
  (173, 'SWARTVAGHER', 'Philippe', 2, NULL, '1996-07-21'),
  (174, 'TA', 'Vinh-Thong', 2, NULL, '1978-04-11'),
  (175, 'TERRIER', 'François', 2, NULL, '1959-09-26'),
  (176, 'THOMAS', 'Romain', 2, NULL, '1973-03-10'),
  (177, 'TOURABI', 'Myriam', 1, NULL, '1978-03-04'),
  (178, 'TRAN', 'Quang-Huy', 2, NULL, '1990-07-25'),
  (179, 'TRON', 'Frederic', 2, NULL, '1974-01-15'),
  (180, 'VARIGNON', 'Denis', 2, NULL, '1974-05-15'),
  (181, 'VIGNA', 'Sebastian', 2, NULL, '1972-06-26'),
  (182, 'VILLARD', 'Guillaume', 2, NULL, '1983-07-20'),
  (183, 'WAVRE', 'Florence', 1, NULL, '1966-03-29'),
  (184, 'ZAFRILLA', 'Gilbert', 2, NULL, '1955-12-27'),
  (185, 'ZERMOUTI', 'Yassine', 2, NULL, '1995-07-17'),
  (186, 'ZIANI', 'Mohamed', 2, NULL, '1995-11-04'),
  (187, 'ZIGHED', 'Djamel', 2, NULL, '1965-04-09'),
  (188, 'ZOUAOUI', 'Adel', 2, NULL, '1977-01-29'),
  (189, 'ZUBER', 'Stéphanie', 1, NULL, '1975-02-12'),
  (190, 'ZUBENKO', 'Alexandre', 2, NULL, '1989-06-12'),
  (191, 'ZIAT', 'Aicha', 1, NULL, '1965-08-02'),
  (192, 'AINSWORTH', 'Anthony', 2, NULL, '1953-01-09'),
  (193, 'ALAGHA', 'Hasan', 2, NULL, '1978-01-01'),
  (194, 'AMOUROUX', 'Christophe', 2, NULL, '1962-01-27'),
  (195, 'BAILES', 'Paul', 2, NULL, '1957-07-05'),
  (196, 'BAKIR', 'Yasmina', 1, NULL, '1978-03-01'),
  (197, 'BERNAT', 'Virginie', 1, NULL, '1970-05-28'),
  (198, 'CAPELLE', 'Éric', 2, NULL, '1968-01-07'),
  (199, 'CHASSAING', 'Philippe', 2, NULL, '1958-09-16'),
  (200, 'COLLET', 'Christine', 1, NULL, '1959-03-05'),
  (201, 'LAPALME', 'Guy', 2, NULL, '1951-09-17'),
  (202, 'LATOUR-DANTES', 'Astrid', 1, NULL, '1968-05-15'),
  (203, 'LE LAURAIN', 'Sylvie', 1, NULL, '1961-11-28'),
  (204, 'LESAGE', 'Emmanuelle', 1, NULL, '1981-12-30'),
  (205, 'MANSENCAL', 'Boris', 2, NULL, '1976-05-15'),
  (206, 'MARY', 'Patrick', 2, NULL, '1958-07-08'),
  (207, 'MERSIER', 'Annick', 1, NULL, '1967-11-28'),
  (208, 'MEYRE', 'Elia', 1, NULL, '1970-07-23'),
  (209, 'PENNANECH', 'Cyril', 2, NULL, '1970-07-18'),
  (210, 'POINT', 'Gerald', 2, NULL, '1972-01-11'),
  (211, 'ROUBINEAU', 'Catherine', 1, NULL, '1964-07-12'),
  (212, 'UNG', 'Pascal', 2, NULL, '1966-05-25'),
  (213, 'ALBERTIN', 'Doriann', 2, NULL, '1996-12-21'),
  (214, 'AMORENA', 'Xavier', 2, NULL, '1973-07-12'),
  (215, 'BARBIERI', 'Sebastian', 2, NULL, '1989-08-01'),
  (216, 'BEAUDOUX', 'Vincent', 2, NULL, '1988-01-05'),
  (217, 'BECTARD', 'Mathieu', 2, NULL, '2004-06-04'),
  (218, 'BELLY', 'Marius', 2, NULL, '2000-07-02'),
  (219, 'BIANE', 'Célia', 1, NULL, '1989-09-05'),
  (220, 'BOYENVAL', 'Deborah', 1, NULL, '1994-02-12'),
  (221, 'BRAZIER', 'Charles', 2, NULL, '1992-08-28'),
  (222, 'BROCAIRE', 'Cyprien', 2, NULL, '2002-09-26'),
  (223, 'CARRILLO LINDADO', 'Hernan Camilo', 2, NULL, '1995-09-30'),
  (224, 'CASTRO BERMUDEZ', 'Blanca Alicia', 1, NULL, '1994-01-09'),
  (225, 'CHATILLON', 'Romain', 2, NULL, '1986-08-08'),
  (226, 'CHATRIE', 'Frédéric', 2, NULL, '1990-06-19'),
  (227, 'CHEVALIER', 'Arthur', 2, NULL, '1995-02-10'),
  (228, 'CIMA', 'Gianluca', 2, NULL, '1992-11-20'),
  (229, 'CUBILIER', 'Titien', 2, NULL, '1997-11-09'),
  (230, 'DANTAS', 'Laurie', 1, NULL, '1999-07-07'),
  (231, 'DARBO', 'Elodie', 1, NULL, '1983-10-29'),
  (232, 'DARTOIS', 'Stéphane', 2, NULL, '1988-05-03'),
  (233, 'DESCOTTE', 'Maria Emilia', 1, NULL, '1984-09-14'),
  (234, 'DOUVIER', 'Claire', 1, NULL, '1973-10-02'),
  (235, 'DOVGAL', 'Sergey', 2, NULL, '1993-01-06'),
  (236, 'DUPOUEY', 'Léo', 2, NULL, '2000-05-20'),
  (237, 'ESTÉRIE', 'Pierre', 2, NULL, '1987-08-09'),
  (238, 'FEICAL', 'Arafat', 2, NULL, '2001-04-07'),
  (239, 'FERRERO', 'Cédrik', 2, NULL, '1970-04-29'),
  (240, 'FOUCAUD', 'Florent', 2, NULL, '1986-03-19'),
  (241, 'GADEA', 'Timothé', 2, NULL, '2000-08-26'),
  (242, 'GALLOT', 'Léo', 2, NULL, '1999-08-03'),
  (243, 'GASTALDI', 'Bastien', 2, NULL, '2000-09-10'),
  (244, 'GHOSH', 'Arka', 2, NULL, '1998-03-08'),
  (245, 'GLORIAN', 'Gaël', 2, NULL, '1991-05-16'),
  (246, 'GNAYA', 'Imed', 2, NULL, '1996-09-11'),
  (247, 'GUSAK', 'Julia', 1, NULL, '1991-02-05'),
  (248, 'HOFFMANN', 'Alexis', 2, NULL, '1999-01-18'),
  (249, 'JATON', 'Gaël', 2, NULL, '1981-12-07'),
  (250, 'KELLER', 'Thibaud', 2, NULL, '1990-08-28'),
  (251, 'KNIAZEV', 'Roman', 2, NULL, '1997-09-01'),
  (252, 'KOZHEMIACHENKO', 'Danill', 2, NULL, '1995-01-16'),
  (253, 'KROGMEIER', 'Claudia', 1, NULL, '1992-01-23'),
  (254, 'KSOURI', 'Chahrazed', 1, NULL, '1990-12-03'),
  (255, 'LABORDE-ZUBIETA', 'Patxi', 2, NULL, '1990-03-15'),
  (256, 'LABROUSSE', 'Maïté', 1, NULL, '1958-05-05'),
  (257, 'LACAULE', 'Ophélie', 1, NULL, '1995-08-04'),
  (259, 'LAPLACE', 'Rémi', 2, NULL, '1985-08-29'),
  (260, 'LARBI', 'Ali', 2, NULL, '1983-02-25'),
  (261, 'LARBI', 'Wahiba', 1, NULL, '1983-10-20'),
  (262, 'LARRALDE', 'Joseph', 2, NULL, '1981-06-19'),
  (263, 'LATAPPY', 'Corentin', 2, NULL, '2000-11-29'),
  (264, 'LAUMOND', 'Antoine', 2, NULL, '1995-09-29'),
  (265, 'LORTO', 'Laura', 1, NULL, '1991-07-04'),
  (266, 'MARGUERITTE', 'Gaëtan', 2, NULL, '1999-04-22'),
  (267, 'MEDETOV', 'Seyktamal', 2, NULL, '1981-04-10'),
  (268, 'MERCIER', 'Chloé', 1, NULL, '1994-02-16'),
  (269, 'MOHAMMADPOUR BEJARGAFSHEH', 'Reza', 2, NULL, '1991-12-29'),
  (270, 'MONLEZUN', 'Lucas', 2, NULL, '1999-01-21'),
  (271, 'MONTFERME', 'Robin', 2, NULL, '1998-01-17'),
  (272, 'MOUHOUB', 'Noureddine', 2, NULL, '1995-07-19'),
  (273, 'MOUILLON', 'Baptiste', 2, NULL, '2000-05-30'),
  (274, 'NACIRI', 'Mehdi', 2, NULL, '1997-09-10'),
  (275, 'N''GUYEN', 'Steve', 2, NULL, '1983-03-24'),
  (276, 'OUADA', 'Farah Sarah', 2, NULL, '1989-12-13'),
  (277, 'OUVRARD', 'Paul', 2, NULL, '1994-04-08'),
  (278, 'PAN', 'Xingyu', 2, NULL, '1988-03-30'),
  (279, 'PIAZZA', 'Remy', 2, NULL, '1996-09-21'),
  (280, 'PORET', 'Maxime', 2, NULL, '1994-04-14'),
  (281, 'PROUZEAU', 'Arnaud', 2, NULL, '1991-12-30'),
  (282, 'PULARI', 'Subin', 2, NULL, '1996-03-04'),
  (283, 'RAHMANI', 'Saïd', 2, NULL, '1991-08-12'),
  (284, 'RIVA', 'Sarah', 1, NULL, '1995-10-15'),
  (285, 'ROBILLARD', 'Rebeca-Maria', 1, NULL, '1983-05-14'),
  (286, 'SARAIN', 'Shervin', 2, NULL, '1995-01-10'),
  (287, 'VAGINAY', 'Athénaïs', 1, NULL, '1993-12-13'),
  (288, 'VALLET', 'Jason', 2, NULL, '1989-07-04'),
  (289, 'VANDENHOVE', 'Pierre', 2, NULL, '1995-12-31'),
  (290, 'VERDI', 'Hugo', 2, NULL, '1987-04-03'),
  (291, 'VU', 'Manh Tu', 2, NULL, '1993-08-23'),
  (292, 'WOLF', 'Petra', 1, NULL, '1992-12-29'),
  (293, 'YEBDA', 'Thinhinane', 1, NULL, '1994-08-10'),
  (294, 'PACANOWSKI', 'Romain', 2, NULL, '1979-03-18'),
  (295, 'SENIZERGUES', 'Géraud', 2, NULL, '1957-03-09')
ON CONFLICT (id) DO NOTHING;

SELECT setval(pg_get_serial_sequence('personnes', 'id'), COALESCE(MAX(id), 1)) FROM personnes;

WITH membres_complementaires (nom, prenom, sexe, nationalite, date_naissance) AS (
VALUES
  ('HILAIRE', 'Mathieu', 2, NULL, '1994-08-17'),
  ('HINAUT', 'Xavier', 2, NULL, '1985-04-28'),
  ('HOFER', 'Ludovic', 2, NULL, '1990-01-06'),
  ('HUBER', 'Félix', 2, NULL, '1987-07-04'),
  ('ILCINKAS', 'David', 2, NULL, '1980-05-03'),
  ('JACOB', 'Pierre', 2, NULL, '1993-01-20'),
  ('JANIN', 'David', 2, NULL, '1967-03-16'),
  ('JANSEN', 'Yvonne', 1, NULL, '1980-08-13'),
  ('JOHNEN', 'Colette', 1, NULL, '1961-10-01'),
  ('JOURNET', 'Nicholas', 2, NULL, '1979-11-10'),
  ('KARDOS', 'Frantisek', 2, NULL, '1981-06-24'),
  ('KRIEF', 'Francine', 1, NULL, '1959-07-24'),
  ('LABBE', 'Sébastien', 2, NULL, '1983-06-17'),
  ('LAGARDE', 'Guillaume', 2, NULL, '1989-08-11'),
  ('LEROUX', 'Jerome', 2, NULL, '1976-09-14'),
  ('MAGONI', 'Damien', 2, NULL, '1971-09-17'),
  ('MELANCON', 'Guy', 2, NULL, '1961-04-28'),
  ('METIVIER', 'Yves', 2, NULL, '1957-11-28'),
  ('MORANDAT', 'Floreal', 2, NULL, '1982-08-21'),
  ('MOSBAH', 'Mohamed', 2, NULL, '1964-08-21'),
  ('MUSCHOLL', 'Anca', 1, NULL, '1967-01-12'),
  ('NAMYST', 'Raymond', 2, NULL, '1969-05-31'),
  ('NEGRU', 'Daniel', 2, NULL, '1979-05-24'),
  ('PAULEVE', 'Loïc', 2, NULL, '1985-04-11'),
  ('PENELLE', 'Vincent', 2, NULL, '1988-02-24'),
  ('PINAUD', 'Bruno', 2, NULL, '1978-01-05'),
  ('RAFFINOT', 'Mathieu', 2, NULL, '1973-12-04'),
  ('RAGUIN', 'Adelaide', 1, NULL, '2000-01-01'),
  ('REVEILLERE', 'Laurent', 2, NULL, '1974-07-22'),
  ('ROBBES', 'Romain', 2, NULL, '1980-12-23'),
  ('ROUAS', 'Jean-Luc', 2, NULL, '1979-08-14'),
  ('SAILLARD', 'Emmanuelle', 1, NULL, '1988-07-28'),
  ('SHERMAN', 'David', 2, NULL, '1964-01-18'),
  ('TANASA', 'Nicolae Adrian', 2, NULL, '1979-05-27'),
  ('TEYLO', 'Luan', 2, NULL, '2000-01-01'),
  ('THEBAULT', 'Patricia', 1, NULL, '1969-12-06'),
  ('THIBAULT', 'Samuel', 2, NULL, '1981-09-03'),
  ('TRAVERS', 'Corentin', 2, NULL, '1978-10-24'),
  ('URICARU', 'Raluca', 1, NULL, '1982-08-07'),
  ('VIALARD', 'Anne', 1, NULL, '1971-06-21'),
  ('VIEVILLE', 'Thierry', 2, NULL, '2000-01-01'),
  ('WACRENIER', 'Pierre-André', 2, NULL, '1967-11-22'),
  ('WALUKIEWICZ', 'Igor', 2, NULL, '1968-03-05'),
  ('WEIL', 'Pascal', 2, NULL, '1960-09-27'),
  ('ZANON BOITO', 'Francieli', 1, NULL, '1988-12-15'),
  ('ZEITOUN', 'Marc', 2, NULL, '1967-07-09'),
  ('ZEMMARI', 'Akka', 2, NULL, '1973-03-01'),
  ('CASSEAU', 'Christophe', 2, NULL, '2024-01-01'),
  ('AMSILI', 'Safia', 1, NULL, '1997-09-20'),
  ('BERNI', 'Emanuela', 1, NULL, '1972-03-27'),
  ('CAPELLE', 'Benoït', 2, NULL, '1975-06-17'),
  ('FONTAINE', 'Michael', 2, NULL, '1971-08-31'),
  ('FURMENTO', 'Nathalie', 1, NULL, '1971-07-29'),
  ('GARCIA', 'Isabelle', 1, NULL, '1972-02-25'),
  ('GODARD', 'Chloé', 1, NULL, '1977-06-24'),
  ('GUERIN', 'Katel', 1, NULL, '1972-12-18'),
  ('GUIARD SCHMID', 'Stéphanie', 1, NULL, '1972-01-03'),
  ('HINNENBERGER', 'Magali', 1, NULL, '1971-03-18'),
  ('ISSOULI', 'Alexandre', 2, NULL, '1986-01-07'),
  ('LACROIX', 'Pierre', 2, NULL, '1967-07-26'),
  ('LALANNE', 'Frédéric', 2, NULL, '1990-02-25'),
  ('LARROUY', 'Gabriel', 2, NULL, '1978-06-04'),
  ('Nouveau', 'Nouveau', 1, NULL, '2024-01-01')
)
INSERT INTO personnes (nom, prenom, sexe, nationalite, date_naissance)
SELECT mc.nom, mc.prenom, mc.sexe, mc.nationalite::integer, mc.date_naissance::date
FROM membres_complementaires mc
WHERE NOT EXISTS (
  SELECT 1
  FROM personnes p
  WHERE p.nom = mc.nom
    AND p.prenom = mc.prenom
);

INSERT INTO etablissements (id, etablissement) VALUES
  (1, 'Université de Bordeaux'),
  (2, 'Inria Bordeaux'),
  (3, 'CNRS'),
  (4, 'Bordeaux INP'),
  (5, 'Université Paris-Saclay'),
  (6, 'ENS Rennes'),
  (7, 'ENS Lyon'),
  (8, 'Université de Lille'),
  (9, 'Université de Lorraine'),
  (10, 'Université de Montpellier'),
  (11, 'Université de Toulouse III'),
  (12, 'Université Bordeaux Montaigne'),
  (13, 'Université Paris-Diderot'),
  (14, 'SupOptique'),
  (15, 'Ecole Nationale d''Ingénieurs de Metz'),
  (16, 'Université de SFAX'),
  (17, 'Université de Limoges'),
  (18, 'Université de Navarre San Sebastian'),
  (19, 'Université Technique du Danemark Kongens Lyngby'),
  (20, 'Ecole polytechnique université de Lyon'),
  (21, 'EFREI Paris France Cretéil'),
  (22, 'Université Rovira I Virgili Tarragone'),
  (23, 'Université de Monastir'),
  (24, 'Université Paris Cité'),
  (25, 'Ecole centrale de Nantes'),
  (26, 'Université de technologie de Compiègne'),
  (27, 'Université de Rennes 1'),
  (28, 'Université Fédérale Fluminense'),
  (29, 'Université de Strasbourg'),
  (30, 'Université Grenoble Alpes'),
  (31, 'Aix-Marseille Université'),
  (32, 'ENSIIE'),
  (33, 'Polytech Lille'),
  (34, 'Université Paris-Est Marne-la-Vallée'),
  (35, 'Université de Carthage Bizerte'),
  (36, 'ESPCI ParisTech'),
  (37, 'University of Potsdam'),
  (38, 'Université de l''Illinois'),
  (39, 'Université de Lyon'),
  (40, 'Université Sidi Mohamed Ben Abdellah'),
  (41, 'Université de Versailles Saint Quentin'),
  (42, 'BULL ATOS'),
  (43, 'Université de Clermont-Ferrand-II'),
  (44, 'Institut d''Optique Graduate School Palaiseau'),
  (45, 'ALPhANOV'),
  (46, 'SIG-IMAGE'),
  (47, 'Université Paris-Descartes'),
  (48, 'Université Houari-Boumediene'),
  (81, 'Ambassade d''Algérie en France'),
  (82, 'CEA'),
  (83, 'I2S'),
  (84, 'Chennai Mathematical Institute'),
  (85, 'EA4T'),
  (86, 'Bordeaux Sciences Agro'),
  (87, 'Grenoble INP'),
  (88, 'IBM France'),
  (89, 'Education Nationale'),
  (90, 'INSA Toulouse'),
  (91, 'THALES'),
  (92, 'Atos Integration'),
  (93, 'Radboud University Nijmegen'),
  (94, 'ADERA'),
  (95, 'SNCF'),
  (96, 'LYNXDRONE'),
  (97, 'AUREA'),
  (98, 'SIRIC BRIO2'),
  (99, 'STARTUP KUNE'),
  (100, 'BEIHANG UNIVERSITY'),
  (101, 'Bourse'),
  (102, 'Goodyear S.A'),
  (103, 'UNIVERSITÉ LAVAL'),
  (104, 'Ubisoft Bordeaux'),
  (105, 'Universidad Nacional de La Plata'),
  (106, 'International Institute of Information Technology Hyderabad'),
  (107, 'Université de Perpignan'),
  (108, 'SERMA Safety & Security'),
  (109, 'General Electric'),
  (110, 'BNP Paribas Personal Finance'),
  (111, 'Université catholique Péter Pázmány'),
  (112, 'Télécom ParisTech'),
  (113, 'École Nationale Supérieure d’Informatique pour l’Industrie et l’Entreprise'),
  (114, 'EFREI Paris'),
  (115, 'IDEMIA'),
  (116, 'University of Medicine'),
  (117, 'Université de Trente '),
  (118, 'ESTIA Bidart'),
  (119, 'Naval Group'),
  (120, 'LECTRA SA'),
  (121, 'Institut national des télécommunications et des technologies de l''information et de la communication'),
  (122, 'National Taipei University of Business Taipei'),
  (123, 'NATIONAL CHENG KUNG UNIVERSITY'),
  (124, 'ENS Cachan'),
  (125, 'École nationale supérieure d''informatique Alger'),
  (126, 'University de Grenoble Alpes'),
  (127, 'Université Pierre-et-Marie-Curie'),
  (128, 'Sorbonne Universités'),
  (129, 'Université de Sousse'),
  (130, 'JOADA'),
  (131, 'UTC - Compiègne'),
  (132, 'CETIM Sud Ouest'),
  (133, 'Promyze'),
  (134, 'La Sapienza University'),
  (135, 'INRAE'),
  (136, 'Ecole d''ingénieurs du Mans'),
  (137, 'CIS Valley'),
  (138, 'Université de La Réunion'),
  (139, 'ENS de l''éclectronique et de ses applications- Cergy-Pontoise'),
  (140, 'Université de Valladolid'),
  (141, 'Université Reims-Champagne-Ardenne'),
  (142, 'CONACYT - Consejo Nacional de Ciencia y Tecnología'),
  (143, 'Instituto Politécnico Nacional Tijuana'),
  (144, 'Auréa agrosciences'),
  (145, 'Université d''Augsbourg'),
  (146, 'Université de Vérone'),
  (147, 'University of Münster'),
  (148, 'ITECA'),
  (149, 'Université de Padoue'),
  (150, 'ENS ESI Alger'),
  (151, 'University of Antwerp'),
  (152, 'Lucine'),
  (153, 'BERGER LEVRAULT'),
  (154, 'Ecole Nationale supérieure de cognitique - Institut polytechnique de Bordeaux'),
  (155, 'Université autonome de Barcelone'),
  (156, 'Bull SAS'),
  (157, 'IFPEN '),
  (158, 'Skolkovo Institute of Science and Technology'),
  (159, 'Université technique de Rhénanie-Westphalie'),
  (160, 'Univesité des sciences, des techniques et des technologies de Bamako'),
  (161, 'Johns Hopkins University'),
  (162, 'CERFACS'),
  (163, 'University of Electronic Science and Technology of China'),
  (164, 'InfleXys'),
  (165, 'University of Illinois'),
  (166, 'Ferrocampus'),
  (167, 'Université d''Oran'),
  (168, 'Université Amiens Picardie Jules Verne'),
  (169, 'Universidade Federal de Santa Catarina Florianópolis'),
  (170, 'CNAM'),
  (171, 'DataDirectNetworks France'),
  (172, 'Université de Rouen Normandie'),
  (173, 'Université Paris XI'),
  (174, 'Indian Institute of Technology Kharagpur'),
  (175, 'Institut International de Technologie de Sfax'),
  (176, 'Scille'),
  (177, 'École polytechnique fédérale de Zurich'),
  (178, 'École Nationale Supérieure de Sciences Appliquées et de Technologies Lannion'),
  (179, 'Alltech Nouvelle Aquitaine'),
  (180, 'Vegetal signals'),
  (181, 'Institut supérieur des sciences appliquées et de technologie de Sousse'),
  (182, 'Université de la Manouba'),
  (185, 'Orosys'),
  (186, 'Mangrove'),
  (187, 'Université Libre de Bruxelles'),
  (188, 'Pas de gratification'),
  (189, 'La Rochelle Université'),
  (190, 'Ecole Nationale d''Ingénieurs de Tunis'),
  (191, 'ENSC'),
  (192, 'Ecole Nationale d''Ingénieurs de Brest')
ON CONFLICT (id) DO NOTHING;

INSERT INTO affectations_laboratoires (personne, laboratoire, date_debut) VALUES
  ((SELECT id FROM personnes WHERE id = 1), 1, '2010-01-01'),
  ((SELECT id FROM personnes WHERE id = 2), 1, '2004-09-01'),
  ((SELECT id FROM personnes WHERE id = 3), 1, '2012-02-01'),
  ((SELECT id FROM personnes WHERE id = 4), 1, '2006-09-01'),
  ((SELECT id FROM personnes WHERE id = 5), 1, '2018-10-01'),
  ((SELECT id FROM personnes WHERE id = 6), 1, '2003-09-25'),
  ((SELECT id FROM personnes WHERE id = 7), 1, '2004-10-01'),
  ((SELECT id FROM personnes WHERE id = 8), 1, '2024-01-02'),
  ((SELECT id FROM personnes WHERE id = 9), 1, '2012-09-01'),
  ((SELECT id FROM personnes WHERE id = 10), 1, '2007-09-01'),
  ((SELECT id FROM personnes WHERE id = 11), 1, '1998-09-01'),
  ((SELECT id FROM personnes WHERE id = 12), 1, '2024-09-01'),
  ((SELECT id FROM personnes WHERE id = 13), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 14), 1, '2001-09-01'),
  ((SELECT id FROM personnes WHERE id = 15), 1, '2013-09-01'),
  ((SELECT id FROM personnes WHERE id = 16), 1, '2001-09-01'),
  ((SELECT id FROM personnes WHERE id = 17), 1, '2023-09-01'),
  ((SELECT id FROM personnes WHERE id = 18), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 19), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 20), 1, '2018-10-01'),
  ((SELECT id FROM personnes WHERE id = 21), 1, '2018-10-01'),
  ((SELECT id FROM personnes WHERE id = 22), 1, '2023-09-01'),
  ((SELECT id FROM personnes WHERE id = 23), 1, '1999-01-01'),
  ((SELECT id FROM personnes WHERE id = 24), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 25), 1, '2010-09-01'),
  ((SELECT id FROM personnes WHERE id = 26), 1, '2014-11-01'),
  ((SELECT id FROM personnes WHERE id = 27), 1, '2005-09-01'),
  ((SELECT id FROM personnes WHERE id = 28), 1, '2015-12-01'),
  ((SELECT id FROM personnes WHERE id = 29), 1, '1999-12-01'),
  ((SELECT id FROM personnes WHERE id = 30), 1, '2023-09-02'),
  ((SELECT id FROM personnes WHERE id = 31), 1, '2023-09-01'),
  ((SELECT id FROM personnes WHERE id = 32), 1, '2005-10-01'),
  ((SELECT id FROM personnes WHERE id = 33), 1, '1990-01-01'),
  ((SELECT id FROM personnes WHERE id = 34), 1, '2010-09-01'),
  ((SELECT id FROM personnes WHERE id = 35), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 36), 1, '2018-09-01'),
  ((SELECT id FROM personnes WHERE id = 37), 1, '2010-09-01'),
  ((SELECT id FROM personnes WHERE id = 38), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 39), 1, '2012-09-01'),
  ((SELECT id FROM personnes WHERE id = 40), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 41), 1, '2018-09-01'),
  ((SELECT id FROM personnes WHERE id = 42), 1, '2005-09-01'),
  ((SELECT id FROM personnes WHERE id = 43), 1, '1993-09-01'),
  ((SELECT id FROM personnes WHERE id = 44), 1, '2001-09-01'),
  ((SELECT id FROM personnes WHERE id = 45), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 46), 1, '2019-09-01'),
  ((SELECT id FROM personnes WHERE id = 47), 1, '2023-09-01'),
  ((SELECT id FROM personnes WHERE id = 48), 1, '2020-01-01'),
  ((SELECT id FROM personnes WHERE id = 49), 1, '2021-10-01'),
  ((SELECT id FROM personnes WHERE id = 50), 1, '2013-10-01'),
  ((SELECT id FROM personnes WHERE id = 51), 1, '1998-09-01'),
  ((SELECT id FROM personnes WHERE id = 52), 1, '1994-09-01'),
  ((SELECT id FROM personnes WHERE id = 53), 1, '2004-10-01'),
  ((SELECT id FROM personnes WHERE id = 54), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 55), 1, '2002-09-01'),
  ((SELECT id FROM personnes WHERE id = 56), 1, '2015-01-01'),
  ((SELECT id FROM personnes WHERE id = 57), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 58), 1, '2021-09-01'),
  ((SELECT id FROM personnes WHERE id = 59), 1, '2020-12-01'),
  ((SELECT id FROM personnes WHERE id = 60), 1, '1997-10-01'),
  ((SELECT id FROM personnes WHERE id = 61), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 62), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 63), 1, '2005-09-01'),
  ((SELECT id FROM personnes WHERE id = 64), 1, '1998-01-01'),
  ((SELECT id FROM personnes WHERE id = 65), 1, '2006-09-01'),
  ((SELECT id FROM personnes WHERE id = 66), 1, '2007-09-01'),
  ((SELECT id FROM personnes WHERE id = 67), 1, '2010-09-01'),
  ((SELECT id FROM personnes WHERE id = 68), 1, '2012-09-01'),
  ((SELECT id FROM personnes WHERE id = 69), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 70), 1, '1999-01-01'),
  ((SELECT id FROM personnes WHERE id = 71), 1, '2014-10-01'),
  ((SELECT id FROM personnes WHERE id = 72), 1, '2018-01-15'),
  ((SELECT id FROM personnes WHERE id = 73), 1, '2019-01-14'),
  ((SELECT id FROM personnes WHERE id = 74), 1, '2005-09-01'),
  ((SELECT id FROM personnes WHERE id = 75), 1, '2020-01-01'),
  ((SELECT id FROM personnes WHERE id = 76), 1, '2011-09-01'),
  ((SELECT id FROM personnes WHERE id = 77), 1, '1996-01-01'),
  ((SELECT id FROM personnes WHERE id = 78), 1, '2007-11-01'),
  ((SELECT id FROM personnes WHERE id = 79), 1, '2013-09-01'),
  ((SELECT id FROM personnes WHERE id = 80), 1, '2024-09-01'),
  ((SELECT id FROM personnes WHERE id = 81), 1, '2009-09-01'),
  ((SELECT id FROM personnes WHERE id = 82), 1, '2019-10-01'),
  ((SELECT id FROM personnes WHERE id = 83), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 84), 1, '2022-09-01'),
  ((SELECT id FROM personnes WHERE id = 85), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 86), 1, '2008-11-01'),
  ((SELECT id FROM personnes WHERE id = 87), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 88), 1, '2005-09-01'),
  ((SELECT id FROM personnes WHERE id = 89), 1, '2022-09-01'),
  ((SELECT id FROM personnes WHERE id = 90), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 91), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 93), 1, '2017-10-01'),
  ((SELECT id FROM personnes WHERE id = 94), 1, '2023-09-04'),
  ((SELECT id FROM personnes WHERE id = 95), 1, '2005-09-01'),
  ((SELECT id FROM personnes WHERE id = 96), 1, '2001-10-01'),
  ((SELECT id FROM personnes WHERE id = 97), 1, '2001-09-01'),
  ((SELECT id FROM personnes WHERE id = 98), 1, '2024-09-01'),
  ((SELECT id FROM personnes WHERE id = 99), 1, '2017-02-01'),
  ((SELECT id FROM personnes WHERE id = 100), 1, '2009-09-01'),
  ((SELECT id FROM personnes WHERE id = 101), 1, '2018-09-01'),
  ((SELECT id FROM personnes WHERE id = 102), 1, '2023-09-05'),
  ((SELECT id FROM personnes WHERE id = 103), 1, '2007-11-01'),
  ((SELECT id FROM personnes WHERE id = 104), 1, '2022-09-01'),
  ((SELECT id FROM personnes WHERE id = 105), 1, '1996-09-01'),
  ((SELECT id FROM personnes WHERE id = 106), 1, '2021-09-01'),
  ((SELECT id FROM personnes WHERE id = 107), 1, '1999-10-18'),
  ((SELECT id FROM personnes WHERE id = 108), 1, '2008-09-01'),
  ((SELECT id FROM personnes WHERE id = 109), 1, '2008-11-20'),
  ((SELECT id FROM personnes WHERE id = 110), 1, '2012-09-01'),
  ((SELECT id FROM personnes WHERE id = 111), 1, '2005-11-01'),
  ((SELECT id FROM personnes WHERE id = 112), 1, '1993-09-01'),
  ((SELECT id FROM personnes WHERE id = 113), 1, '2017-01-01'),
  ((SELECT id FROM personnes WHERE id = 114), 1, '2023-09-01'),
  ((SELECT id FROM personnes WHERE id = 115), 1, '2024-09-01'),
  ((SELECT id FROM personnes WHERE id = 116), 1, '2016-09-01'),
  ((SELECT id FROM personnes WHERE id = 117), 1, '1998-01-01'),
  ((SELECT id FROM personnes WHERE id = 118), 1, '2005-10-01'),
  ((SELECT id FROM personnes WHERE id = 119), 1, '2016-09-01'),
  ((SELECT id FROM personnes WHERE id = 120), 1, '2015-09-01'),
  ((SELECT id FROM personnes WHERE id = 121), 1, '2021-09-01'),
  ((SELECT id FROM personnes WHERE id = 122), 1, '2012-09-01'),
  ((SELECT id FROM personnes WHERE id = 123), 1, '2019-10-01'),
  ((SELECT id FROM personnes WHERE id = 124), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 125), 1, '1998-08-01'),
  ((SELECT id FROM personnes WHERE id = 126), 1, '2008-09-01'),
  ((SELECT id FROM personnes WHERE id = 127), 1, '2005-10-01'),
  ((SELECT id FROM personnes WHERE id = 128), 1, '2006-09-01'),
  ((SELECT id FROM personnes WHERE id = 129), 1, '2007-01-01'),
  ((SELECT id FROM personnes WHERE id = 130), 1, '2006-09-01'),
  ((SELECT id FROM personnes WHERE id = 131), 1, '1997-01-02'),
  ((SELECT id FROM personnes WHERE id = 132), 1, '2010-09-01'),
  ((SELECT id FROM personnes WHERE id = 133), 1, '2012-09-01'),
  ((SELECT id FROM personnes WHERE id = 134), 1, '1993-10-01'),
  ((SELECT id FROM personnes WHERE id = 135), 1, '2006-09-01'),
  ((SELECT id FROM personnes WHERE id = 136), 1, '2002-09-01'),
  ((SELECT id FROM personnes WHERE id = 137), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 138), 1, '2007-09-01'),
  ((SELECT id FROM personnes WHERE id = 139), 1, '2005-09-01'),
  ((SELECT id FROM personnes WHERE id = 140), 1, '2016-09-01'),
  ((SELECT id FROM personnes WHERE id = 141), 1, '2013-11-01'),
  ((SELECT id FROM personnes WHERE id = 142), 1, '2018-10-01'),
  ((SELECT id FROM personnes WHERE id = 143), 1, '2002-09-01'),
  ((SELECT id FROM personnes WHERE id = 144), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 145), 1, '2017-09-01'),
  ((SELECT id FROM personnes WHERE id = 146), 1, '2008-09-01'),
  ((SELECT id FROM personnes WHERE id = 147), 1, '2012-09-01'),
  ((SELECT id FROM personnes WHERE id = 148), 1, '2021-01-01'),
  ((SELECT id FROM personnes WHERE id = 149), 1, '2021-09-01'),
  ((SELECT id FROM personnes WHERE id = 150), 1, '2015-09-01'),
  ((SELECT id FROM personnes WHERE id = 151), 1, '2024-09-01'),
  ((SELECT id FROM personnes WHERE id = 152), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 153), 1, '2022-09-01'),
  ((SELECT id FROM personnes WHERE id = 154), 1, '2005-09-01'),
  ((SELECT id FROM personnes WHERE id = 155), 1, '2006-09-01'),
  ((SELECT id FROM personnes WHERE id = 156), 1, '2017-10-01'),
  ((SELECT id FROM personnes WHERE id = 157), 1, '2023-02-01'),
  ((SELECT id FROM personnes WHERE id = 158), 1, '2011-09-01'),
  ((SELECT id FROM personnes WHERE id = 159), 1, '2005-09-01'),
  ((SELECT id FROM personnes WHERE id = 160), 1, '2010-09-01'),
  ((SELECT id FROM personnes WHERE id = 161), 1, '2013-09-01'),
  ((SELECT id FROM personnes WHERE id = 162), 1, '2017-12-01'),
  ((SELECT id FROM personnes WHERE id = 163), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 164), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 165), 1, '2013-09-01'),
  ((SELECT id FROM personnes WHERE id = 166), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 167), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 168), 1, '2001-10-01'),
  ((SELECT id FROM personnes WHERE id = 169), 1, '2023-09-03'),
  ((SELECT id FROM personnes WHERE id = 170), 1, '2010-09-01'),
  ((SELECT id FROM personnes WHERE id = 171), 1, '2015-09-01'),
  ((SELECT id FROM personnes WHERE id = 172), 1, '2023-10-01'),
  ((SELECT id FROM personnes WHERE id = 173), 1, '2007-09-01'),
  ((SELECT id FROM personnes WHERE id = 174), 1, '2008-09-01'),
  ((SELECT id FROM personnes WHERE id = 175), 1, '2010-09-01'),
  ((SELECT id FROM personnes WHERE id = 176), 1, '2012-09-01'),
  ((SELECT id FROM personnes WHERE id = 177), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 178), 1, '2012-01-01'),
  ((SELECT id FROM personnes WHERE id = 179), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 180), 1, '2001-10-01'),
  ((SELECT id FROM personnes WHERE id = 181), 1, '2004-08-01'),
  ((SELECT id FROM personnes WHERE id = 182), 1, '2019-09-01'),
  ((SELECT id FROM personnes WHERE id = 183), 1, '2005-09-01'),
  ((SELECT id FROM personnes WHERE id = 184), 1, '2001-09-01'),
  ((SELECT id FROM personnes WHERE id = 186), 1, '2022-01-01'),
  ((SELECT id FROM personnes WHERE id = 188), 1, '2020-09-01'),
  ((SELECT id FROM personnes WHERE id = 189), 1, '2013-10-14'),
  ((SELECT id FROM personnes WHERE id = 190), 1, '2004-12-01'),
  ((SELECT id FROM personnes WHERE id = 191), 1, '2012-10-01'),
  ((SELECT id FROM personnes WHERE id = 192), 1, '2005-02-01'),
  ((SELECT id FROM personnes WHERE id = 193), 1, '2015-12-01'),
  ((SELECT id FROM personnes WHERE id = 194), 1, '2024-12-01'),
  ((SELECT id FROM personnes WHERE id = 195), 1, '2011-10-01'),
  ((SELECT id FROM personnes WHERE id = 196), 1, '2020-01-01'),
  ((SELECT id FROM personnes WHERE id = 197), 1, '2006-12-01'),
  ((SELECT id FROM personnes WHERE id = 198), 1, '2016-12-01'),
  ((SELECT id FROM personnes WHERE id = 199), 1, '2009-10-01'),
  ((SELECT id FROM personnes WHERE id = 200), 1, '2012-07-02'),
  ((SELECT id FROM personnes WHERE id = 201), 1, '2024-01-08'),
  ((SELECT id FROM personnes WHERE id = 202), 1, '2011-05-01'),
  ((SELECT id FROM personnes WHERE id = 203), 1, '2011-01-01'),
  ((SELECT id FROM personnes WHERE id = 204), 1, '2016-09-01'),
  ((SELECT id FROM personnes WHERE id = 205), 1, '2004-12-01'),
  ((SELECT id FROM personnes WHERE id = 206), 1, '2006-12-01'),
  ((SELECT id FROM personnes WHERE id = 207), 1, '2015-09-01'),
  ((SELECT id FROM personnes WHERE id = 208), 1, '2007-08-01'),
  ((SELECT id FROM personnes WHERE id = 209), 1, '2019-07-01'),
  ((SELECT id FROM personnes WHERE id = 210), 1, '2002-08-01'),
  ((SELECT id FROM personnes WHERE id = 211), 1, '2004-04-01'),
  ((SELECT id FROM personnes WHERE id = 212), 1, '1998-07-01'),
  ((SELECT id FROM personnes WHERE id = 213), 1, '2023-01-01'),
  ((SELECT id FROM personnes WHERE id = 214), 1, '2019-04-01'),
  ((SELECT id FROM personnes WHERE id = 215), 1, '2019-09-01'),
  ((SELECT id FROM personnes WHERE id = 216), 1, '2018-02-01'),
  ((SELECT id FROM personnes WHERE id = 217), 1, '2024-11-15'),
  ((SELECT id FROM personnes WHERE id = 218), 1, '2024-12-02'),
  ((SELECT id FROM personnes WHERE id = 219), 1, '2024-10-01'),
  ((SELECT id FROM personnes WHERE id = 220), 1, '2024-01-01'),
  ((SELECT id FROM personnes WHERE id = 221), 1, '2023-09-04'),
  ((SELECT id FROM personnes WHERE id = 222), 1, '2022-11-01'),
  ((SELECT id FROM personnes WHERE id = 223), 1, '2020-10-01'),
  ((SELECT id FROM personnes WHERE id = 224), 1, '2023-11-01'),
  ((SELECT id FROM personnes WHERE id = 225), 1, '2016-12-12'),
  ((SELECT id FROM personnes WHERE id = 226), 1, '2020-09-10'),
  ((SELECT id FROM personnes WHERE id = 227), 1, '2020-12-01'),
  ((SELECT id FROM personnes WHERE id = 228), 1, '2021-02-12'),
  ((SELECT id FROM personnes WHERE id = 229), 1, '2021-11-01'),
  ((SELECT id FROM personnes WHERE id = 230), 1, '2022-06-01'),
  ((SELECT id FROM personnes WHERE id = 231), 1, '2019-10-01'),
  ((SELECT id FROM personnes WHERE id = 232), 1, '2019-11-15'),
  ((SELECT id FROM personnes WHERE id = 233), 1, '2018-01-15'),
  ((SELECT id FROM personnes WHERE id = 234), 1, '2024-04-02'),
  ((SELECT id FROM personnes WHERE id = 235), 1, '2020-09-01'),
  ((SELECT id FROM personnes WHERE id = 236), 1, '2024-10-01'),
  ((SELECT id FROM personnes WHERE id = 237), 1, '2020-11-01'),
  ((SELECT id FROM personnes WHERE id = 238), 1, '2024-10-01'),
  ((SELECT id FROM personnes WHERE id = 239), 1, '2023-04-03'),
  ((SELECT id FROM personnes WHERE id = 240), 1, '2019-09-01'),
  ((SELECT id FROM personnes WHERE id = 241), 1, '2024-11-01'),
  ((SELECT id FROM personnes WHERE id = 242), 1, '2024-10-01'),
  ((SELECT id FROM personnes WHERE id = 243), 1, '2024-10-15'),
  ((SELECT id FROM personnes WHERE id = 244), 1, '2024-10-01'),
  ((SELECT id FROM personnes WHERE id = 245), 1, '2020-02-02'),
  ((SELECT id FROM personnes WHERE id = 246), 1, '2021-03-01'),
  ((SELECT id FROM personnes WHERE id = 247), 1, '2022-07-01'),
  ((SELECT id FROM personnes WHERE id = 248), 1, '2022-10-01'),
  ((SELECT id FROM personnes WHERE id = 249), 1, '2019-02-01'),
  ((SELECT id FROM personnes WHERE id = 250), 1, '2017-09-01'),
  ((SELECT id FROM personnes WHERE id = 251), 1, '2024-09-01'),
  ((SELECT id FROM personnes WHERE id = 252), 1, '2024-10-01'),
  ((SELECT id FROM personnes WHERE id = 253), 1, '2023-02-01'),
  ((SELECT id FROM personnes WHERE id = 254), 1, '2017-09-01'),
  ((SELECT id FROM personnes WHERE id = 255), 1, '2014-10-01'),
  ((SELECT id FROM personnes WHERE id = 256), 1, '2007-10-01'),
  ((SELECT id FROM personnes WHERE id = 257), 1, '2023-09-15'),
  ((SELECT id FROM personnes WHERE id = 259), 1, '2018-09-01'),
  ((SELECT id FROM personnes WHERE id = 260), 1, '2021-01-01'),
  ((SELECT id FROM personnes WHERE id = 261), 1, '2021-09-01'),
  ((SELECT id FROM personnes WHERE id = 262), 1, '2023-02-01'),
  ((SELECT id FROM personnes WHERE id = 263), 1, '2024-09-01'),
  ((SELECT id FROM personnes WHERE id = 264), 1, '2016-04-01'),
  ((SELECT id FROM personnes WHERE id = 265), 1, '2018-05-28'),
  ((SELECT id FROM personnes WHERE id = 266), 1, '2023-11-01'),
  ((SELECT id FROM personnes WHERE id = 267), 1, '2020-09-01'),
  ((SELECT id FROM personnes WHERE id = 268), 1, '2020-10-01'),
  ((SELECT id FROM personnes WHERE id = 269), 1, '2020-10-01'),
  ((SELECT id FROM personnes WHERE id = 270), 1, '2022-10-01'),
  ((SELECT id FROM personnes WHERE id = 271), 1, '2021-10-01'),
  ((SELECT id FROM personnes WHERE id = 272), 1, '2019-11-01'),
  ((SELECT id FROM personnes WHERE id = 273), 1, '2024-09-01'),
  ((SELECT id FROM personnes WHERE id = 274), 1, '2021-11-01'),
  ((SELECT id FROM personnes WHERE id = 275), 1, '2016-05-23'),
  ((SELECT id FROM personnes WHERE id = 276), 1, '2021-09-01'),
  ((SELECT id FROM personnes WHERE id = 277), 1, '2017-10-01'),
  ((SELECT id FROM personnes WHERE id = 278), 1, '2018-10-15'),
  ((SELECT id FROM personnes WHERE id = 279), 1, '2021-03-15'),
  ((SELECT id FROM personnes WHERE id = 280), 1, '2019-10-01'),
  ((SELECT id FROM personnes WHERE id = 282), 1, '2024-10-01'),
  ((SELECT id FROM personnes WHERE id = 283), 1, '2019-09-01'),
  ((SELECT id FROM personnes WHERE id = 284), 1, '2022-12-01'),
  ((SELECT id FROM personnes WHERE id = 285), 1, '2020-09-01'),
  ((SELECT id FROM personnes WHERE id = 286), 1, '2018-10-15'),
  ((SELECT id FROM personnes WHERE id = 287), 1, '2024-04-01'),
  ((SELECT id FROM personnes WHERE id = 288), 1, '2013-10-01'),
  ((SELECT id FROM personnes WHERE id = 289), 1, '2023-10-01'),
  ((SELECT id FROM personnes WHERE id = 290), 1, '2023-07-01'),
  ((SELECT id FROM personnes WHERE id = 291), 1, '2019-11-04'),
  ((SELECT id FROM personnes WHERE id = 292), 1, '2023-11-01'),
  ((SELECT id FROM personnes WHERE id = 293), 1, '2018-10-15'),
  ((SELECT id FROM personnes WHERE id = 294), 1, '2021-12-01'),
  ((SELECT id FROM personnes WHERE id = 295), 1, '1997-01-01')
ON CONFLICT DO NOTHING;

INSERT INTO emplois (personne, etablissement, date_debut) VALUES
  ((SELECT id FROM personnes WHERE id = 1), 2, '2010-01-01'),
  ((SELECT id FROM personnes WHERE id = 2), 4, '2004-09-01'),
  ((SELECT id FROM personnes WHERE id = 3), 2, '2012-02-01'),
  ((SELECT id FROM personnes WHERE id = 4), 4, '2006-09-01'),
  ((SELECT id FROM personnes WHERE id = 5), 1, '2018-10-01'),
  ((SELECT id FROM personnes WHERE id = 6), 2, '2003-09-25'),
  ((SELECT id FROM personnes WHERE id = 7), 3, '2004-10-01'),
  ((SELECT id FROM personnes WHERE id = 8), 2, '2024-01-02'),
  ((SELECT id FROM personnes WHERE id = 9), 1, '2012-09-01'),
  ((SELECT id FROM personnes WHERE id = 10), 2, '2007-09-01'),
  ((SELECT id FROM personnes WHERE id = 11), 4, '1998-09-01'),
  ((SELECT id FROM personnes WHERE id = 12), 1, '2024-09-01'),
  ((SELECT id FROM personnes WHERE id = 13), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 14), 2, '2001-09-01'),
  ((SELECT id FROM personnes WHERE id = 15), 1, '2013-09-01'),
  ((SELECT id FROM personnes WHERE id = 16), 1, '2001-09-01'),
  ((SELECT id FROM personnes WHERE id = 17), 1, '2023-09-01'),
  ((SELECT id FROM personnes WHERE id = 18), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 19), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 20), 3, '2018-10-01'),
  ((SELECT id FROM personnes WHERE id = 21), 3, '2018-10-01'),
  ((SELECT id FROM personnes WHERE id = 22), 4, '2023-09-01'),
  ((SELECT id FROM personnes WHERE id = 23), 1, '1999-01-01'),
  ((SELECT id FROM personnes WHERE id = 24), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 25), 1, '2010-09-01'),
  ((SELECT id FROM personnes WHERE id = 26), 1, '2014-11-01'),
  ((SELECT id FROM personnes WHERE id = 27), 1, '2005-09-01'),
  ((SELECT id FROM personnes WHERE id = 28), 3, '2015-12-01'),
  ((SELECT id FROM personnes WHERE id = 29), 1, '1999-12-01'),
  ((SELECT id FROM personnes WHERE id = 30), 4, '2023-09-02'),
  ((SELECT id FROM personnes WHERE id = 31), 1, '2023-09-01'),
  ((SELECT id FROM personnes WHERE id = 32), 1, '2005-10-01'),
  ((SELECT id FROM personnes WHERE id = 33), 3, '1990-01-01'),
  ((SELECT id FROM personnes WHERE id = 34), 1, '2010-09-01'),
  ((SELECT id FROM personnes WHERE id = 35), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 36), 4, '2018-09-01'),
  ((SELECT id FROM personnes WHERE id = 37), 1, '2010-09-01'),
  ((SELECT id FROM personnes WHERE id = 38), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 39), 1, '2012-09-01'),
  ((SELECT id FROM personnes WHERE id = 40), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 41), 4, '2018-09-01'),
  ((SELECT id FROM personnes WHERE id = 42), 1, '2005-09-01'),
  ((SELECT id FROM personnes WHERE id = 43), 4, '1993-09-01'),
  ((SELECT id FROM personnes WHERE id = 44), 2, '2001-09-01'),
  ((SELECT id FROM personnes WHERE id = 45), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 46), 3, '2019-09-01'),
  ((SELECT id FROM personnes WHERE id = 47), 1, '2023-09-01'),
  ((SELECT id FROM personnes WHERE id = 48), 3, '2020-01-01'),
  ((SELECT id FROM personnes WHERE id = 49), 1, '2021-10-01'),
  ((SELECT id FROM personnes WHERE id = 50), 3, '2013-10-01'),
  ((SELECT id FROM personnes WHERE id = 51), 1, '1998-09-01'),
  ((SELECT id FROM personnes WHERE id = 52), 4, '1994-09-01'),
  ((SELECT id FROM personnes WHERE id = 53), 2, '2004-10-01'),
  ((SELECT id FROM personnes WHERE id = 54), 4, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 55), 1, '2002-09-01'),
  ((SELECT id FROM personnes WHERE id = 56), 1, '2015-01-01'),
  ((SELECT id FROM personnes WHERE id = 57), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 58), 2, '2021-09-01'),
  ((SELECT id FROM personnes WHERE id = 59), 1, '2020-12-01'),
  ((SELECT id FROM personnes WHERE id = 60), 1, '1997-10-01'),
  ((SELECT id FROM personnes WHERE id = 61), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 62), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 63), 3, '2005-09-01'),
  ((SELECT id FROM personnes WHERE id = 64), 1, '1998-01-01'),
  ((SELECT id FROM personnes WHERE id = 65), 1, '2006-09-01'),
  ((SELECT id FROM personnes WHERE id = 66), 2, '2007-09-01'),
  ((SELECT id FROM personnes WHERE id = 67), 4, '2010-09-01'),
  ((SELECT id FROM personnes WHERE id = 68), 4, '2012-09-01'),
  ((SELECT id FROM personnes WHERE id = 69), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 70), 1, '1999-01-01'),
  ((SELECT id FROM personnes WHERE id = 71), 3, '2014-10-01'),
  ((SELECT id FROM personnes WHERE id = 72), 3, '2018-01-15'),
  ((SELECT id FROM personnes WHERE id = 73), 3, '2019-01-14'),
  ((SELECT id FROM personnes WHERE id = 74), 1, '2005-09-01'),
  ((SELECT id FROM personnes WHERE id = 75), 2, '2020-01-01'),
  ((SELECT id FROM personnes WHERE id = 76), 1, '2011-09-01'),
  ((SELECT id FROM personnes WHERE id = 77), 1, '1996-01-01'),
  ((SELECT id FROM personnes WHERE id = 78), 3, '2007-11-01'),
  ((SELECT id FROM personnes WHERE id = 79), 1, '2013-09-01'),
  ((SELECT id FROM personnes WHERE id = 80), 1, '2024-09-01'),
  ((SELECT id FROM personnes WHERE id = 81), 2, '2009-09-01'),
  ((SELECT id FROM personnes WHERE id = 82), 2, '2019-10-01'),
  ((SELECT id FROM personnes WHERE id = 83), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 84), 4, '2022-09-01'),
  ((SELECT id FROM personnes WHERE id = 85), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 86), 2, '2008-11-01'),
  ((SELECT id FROM personnes WHERE id = 87), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 88), 1, '2005-09-01'),
  ((SELECT id FROM personnes WHERE id = 89), 4, '2022-09-01'),
  ((SELECT id FROM personnes WHERE id = 90), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 91), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 93), 2, '2017-10-01'),
  ((SELECT id FROM personnes WHERE id = 94), 3, '2023-09-04'),
  ((SELECT id FROM personnes WHERE id = 95), 1, '2005-09-01'),
  ((SELECT id FROM personnes WHERE id = 96), 3, '2001-10-01'),
  ((SELECT id FROM personnes WHERE id = 97), 4, '2001-09-01'),
  ((SELECT id FROM personnes WHERE id = 99), 2, '2017-02-01'),
  ((SELECT id FROM personnes WHERE id = 100), 1, '2009-09-01'),
  ((SELECT id FROM personnes WHERE id = 104), 3, '2022-09-01'),
  ((SELECT id FROM personnes WHERE id = 108), 4, '2008-09-01'),
  ((SELECT id FROM personnes WHERE id = 109), 1, '2008-11-20'),
  ((SELECT id FROM personnes WHERE id = 110), 4, '2012-09-01'),
  ((SELECT id FROM personnes WHERE id = 111), 3, '2005-11-01'),
  ((SELECT id FROM personnes WHERE id = 113), 1, '2017-01-01'),
  ((SELECT id FROM personnes WHERE id = 115), 3, '2024-09-01'),
  ((SELECT id FROM personnes WHERE id = 118), 4, '2005-10-01'),
  ((SELECT id FROM personnes WHERE id = 119), 2, '2016-09-01'),
  ((SELECT id FROM personnes WHERE id = 120), 1, '2015-09-01'),
  ((SELECT id FROM personnes WHERE id = 121), 1, '2021-09-01'),
  ((SELECT id FROM personnes WHERE id = 126), 3, '2008-09-01'),
  ((SELECT id FROM personnes WHERE id = 129), 1, '2007-01-01'),
  ((SELECT id FROM personnes WHERE id = 130), 4, '2006-09-01'),
  ((SELECT id FROM personnes WHERE id = 132), 4, '2010-09-01'),
  ((SELECT id FROM personnes WHERE id = 133), 4, '2012-09-01'),
  ((SELECT id FROM personnes WHERE id = 134), 1, '1993-10-01'),
  ((SELECT id FROM personnes WHERE id = 135), 1, '2006-09-01'),
  ((SELECT id FROM personnes WHERE id = 138), 2, '2007-09-01'),
  ((SELECT id FROM personnes WHERE id = 140), 1, '2016-09-01'),
  ((SELECT id FROM personnes WHERE id = 141), 1, '2013-11-01'),
  ((SELECT id FROM personnes WHERE id = 142), 1, '2018-10-01'),
  ((SELECT id FROM personnes WHERE id = 147), 1, '2012-09-01'),
  ((SELECT id FROM personnes WHERE id = 148), 2, '2021-01-01'),
  ((SELECT id FROM personnes WHERE id = 151), 1, '2024-09-01'),
  ((SELECT id FROM personnes WHERE id = 152), 1, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 153), 4, '2022-09-01'),
  ((SELECT id FROM personnes WHERE id = 154), 1, '2005-09-01'),
  ((SELECT id FROM personnes WHERE id = 157), 1, '2023-02-01'),
  ((SELECT id FROM personnes WHERE id = 159), 4, '2005-09-01'),
  ((SELECT id FROM personnes WHERE id = 160), 2, '2010-09-01'),
  ((SELECT id FROM personnes WHERE id = 165), 1, '2013-09-01'),
  ((SELECT id FROM personnes WHERE id = 167), 4, '1997-01-01'),
  ((SELECT id FROM personnes WHERE id = 168), 1, '2001-10-01'),
  ((SELECT id FROM personnes WHERE id = 170), 1, '2010-09-01'),
  ((SELECT id FROM personnes WHERE id = 172), 3, '2023-10-01'),
  ((SELECT id FROM personnes WHERE id = 173), 4, '2007-09-01'),
  ((SELECT id FROM personnes WHERE id = 174), 4, '2008-09-01'),
  ((SELECT id FROM personnes WHERE id = 202), 3, '2011-05-01'),
  ((SELECT id FROM personnes WHERE id = 203), 1, '2011-01-01'),
  ((SELECT id FROM personnes WHERE id = 204), 3, '2016-09-01'),
  ((SELECT id FROM personnes WHERE id = 205), 4, '2004-12-01'),
  ((SELECT id FROM personnes WHERE id = 206), 1, '2006-12-01'),
  ((SELECT id FROM personnes WHERE id = 207), 1, '2015-09-01'),
  ((SELECT id FROM personnes WHERE id = 208), 3, '2007-08-01'),
  ((SELECT id FROM personnes WHERE id = 209), 3, '2019-07-01'),
  ((SELECT id FROM personnes WHERE id = 210), 3, '2002-08-01'),
  ((SELECT id FROM personnes WHERE id = 211), 3, '2004-04-01'),
  ((SELECT id FROM personnes WHERE id = 212), 3, '1998-07-01'),
  ((SELECT id FROM personnes WHERE id = 213), 1, '2023-01-01'),
  ((SELECT id FROM personnes WHERE id = 214), 1, '2019-04-01'),
  ((SELECT id FROM personnes WHERE id = 215), 1, '2019-09-01'),
  ((SELECT id FROM personnes WHERE id = 216), 3, '2018-02-01'),
  ((SELECT id FROM personnes WHERE id = 217), 1, '2024-11-15'),
  ((SELECT id FROM personnes WHERE id = 218), 1, '2024-12-02'),
  ((SELECT id FROM personnes WHERE id = 219), 1, '2024-10-01'),
  ((SELECT id FROM personnes WHERE id = 220), 1, '2024-01-01'),
  ((SELECT id FROM personnes WHERE id = 221), 1, '2023-09-04'),
  ((SELECT id FROM personnes WHERE id = 222), 1, '2022-11-01'),
  ((SELECT id FROM personnes WHERE id = 223), 1, '2020-10-01'),
  ((SELECT id FROM personnes WHERE id = 224), 1, '2023-11-01'),
  ((SELECT id FROM personnes WHERE id = 225), 1, '2016-12-12'),
  ((SELECT id FROM personnes WHERE id = 226), 1, '2020-09-10'),
  ((SELECT id FROM personnes WHERE id = 227), 1, '2020-12-01'),
  ((SELECT id FROM personnes WHERE id = 228), 3, '2021-02-12'),
  ((SELECT id FROM personnes WHERE id = 229), 1, '2021-11-01'),
  ((SELECT id FROM personnes WHERE id = 230), 4, '2022-06-01'),
  ((SELECT id FROM personnes WHERE id = 231), 1, '2019-10-01'),
  ((SELECT id FROM personnes WHERE id = 232), 1, '2019-11-15'),
  ((SELECT id FROM personnes WHERE id = 233), 1, '2018-01-15'),
  ((SELECT id FROM personnes WHERE id = 234), 1, '2024-04-02'),
  ((SELECT id FROM personnes WHERE id = 235), 1, '2020-09-01'),
  ((SELECT id FROM personnes WHERE id = 236), 1, '2024-10-01'),
  ((SELECT id FROM personnes WHERE id = 237), 1, '2020-11-01'),
  ((SELECT id FROM personnes WHERE id = 238), 2, '2024-10-01'),
  ((SELECT id FROM personnes WHERE id = 239), 4, '2023-04-03'),
  ((SELECT id FROM personnes WHERE id = 240), 1, '2019-09-01'),
  ((SELECT id FROM personnes WHERE id = 241), 1, '2024-11-01'),
  ((SELECT id FROM personnes WHERE id = 242), 1, '2024-10-01'),
  ((SELECT id FROM personnes WHERE id = 243), 1, '2024-10-15'),
  ((SELECT id FROM personnes WHERE id = 244), 1, '2024-10-01'),
  ((SELECT id FROM personnes WHERE id = 245), 1, '2020-02-02'),
  ((SELECT id FROM personnes WHERE id = 246), 1, '2021-03-01'),
  ((SELECT id FROM personnes WHERE id = 247), 2, '2022-07-01'),
  ((SELECT id FROM personnes WHERE id = 248), 1, '2022-10-01'),
  ((SELECT id FROM personnes WHERE id = 249), 1, '2019-02-01'),
  ((SELECT id FROM personnes WHERE id = 250), 1, '2017-09-01'),
  ((SELECT id FROM personnes WHERE id = 251), 1, '2024-09-01'),
  ((SELECT id FROM personnes WHERE id = 252), 1, '2024-10-01'),
  ((SELECT id FROM personnes WHERE id = 253), 2, '2023-02-01'),
  ((SELECT id FROM personnes WHERE id = 254), 1, '2017-09-01'),
  ((SELECT id FROM personnes WHERE id = 255), 1, '2014-10-01'),
  ((SELECT id FROM personnes WHERE id = 256), 1, '2007-10-01'),
  ((SELECT id FROM personnes WHERE id = 257), 1, '2023-09-15'),
  ((SELECT id FROM personnes WHERE id = 259), 1, '2018-09-01'),
  ((SELECT id FROM personnes WHERE id = 260), 1, '2021-01-01'),
  ((SELECT id FROM personnes WHERE id = 261), 1, '2021-09-01'),
  ((SELECT id FROM personnes WHERE id = 262), 1, '2023-02-01'),
  ((SELECT id FROM personnes WHERE id = 263), 1, '2024-09-01'),
  ((SELECT id FROM personnes WHERE id = 264), 1, '2016-04-01'),
  ((SELECT id FROM personnes WHERE id = 265), 4, '2018-05-28'),
  ((SELECT id FROM personnes WHERE id = 266), 1, '2023-11-01'),
  ((SELECT id FROM personnes WHERE id = 267), 1, '2020-09-01'),
  ((SELECT id FROM personnes WHERE id = 268), 1, '2020-10-01'),
  ((SELECT id FROM personnes WHERE id = 269), 1, '2020-10-01'),
  ((SELECT id FROM personnes WHERE id = 270), 1, '2022-10-01'),
  ((SELECT id FROM personnes WHERE id = 271), 3, '2021-10-01'),
  ((SELECT id FROM personnes WHERE id = 272), 1, '2019-11-01'),
  ((SELECT id FROM personnes WHERE id = 273), 1, '2024-09-01'),
  ((SELECT id FROM personnes WHERE id = 274), 1, '2021-11-01'),
  ((SELECT id FROM personnes WHERE id = 276), 1, '2021-09-01'),
  ((SELECT id FROM personnes WHERE id = 277), 1, '2017-10-01'),
  ((SELECT id FROM personnes WHERE id = 278), 1, '2018-10-15'),
  ((SELECT id FROM personnes WHERE id = 279), 1, '2021-03-15'),
  ((SELECT id FROM personnes WHERE id = 280), 4, '2019-10-01'),
  ((SELECT id FROM personnes WHERE id = 282), 3, '2024-10-01'),
  ((SELECT id FROM personnes WHERE id = 283), 1, '2019-09-01'),
  ((SELECT id FROM personnes WHERE id = 284), 1, '2022-12-01'),
  ((SELECT id FROM personnes WHERE id = 285), 3, '2020-09-01'),
  ((SELECT id FROM personnes WHERE id = 286), 1, '2018-10-15'),
  ((SELECT id FROM personnes WHERE id = 287), 1, '2024-04-01'),
  ((SELECT id FROM personnes WHERE id = 288), 1, '2013-10-01'),
  ((SELECT id FROM personnes WHERE id = 289), 1, '2023-10-01'),
  ((SELECT id FROM personnes WHERE id = 290), 1, '2023-07-01'),
  ((SELECT id FROM personnes WHERE id = 291), 3, '2019-11-04'),
  ((SELECT id FROM personnes WHERE id = 292), 1, '2023-11-01'),
  ((SELECT id FROM personnes WHERE id = 293), 1, '2018-10-15'),
  ((SELECT id FROM personnes WHERE id = 294), 1, '2021-12-01'),
  ((SELECT id FROM personnes WHERE id = 295), 1, '1997-01-01')
ON CONFLICT DO NOTHING;

WITH membre_attr(personne, corps, grade, date_debut) AS (
VALUES
    (1, 1, 1, '2010-01-01'),
    (3, 2, 4, '2012-02-01'),
    (6, 1, 2, '2003-09-25'),
    (7, 1, 1, '2004-10-01'),
    (10, 1, 1, '2007-09-01'),
    (14, 2, 4, '2001-09-01'),
    (20, 2, 1, '2018-10-01'),
    (21, 1, 1, '2018-10-01'),
    (28, 1, 1, '2015-12-01'),
    (33, 2, 4, '1990-01-01'),
    (44, 2, 5, '2001-09-01'),
    (46, 2, 5, '2019-09-01'),
    (48, 1, 1, '2020-01-01'),
    (50, 1, 1, '2013-10-01'),
    (53, 1, 1, '2004-10-01'),
    (58, 1, 1, '2021-09-01'),
    (63, 1, 2, '2005-09-01'),
    (66, 1, 1, '2007-09-01'),
    (71, 1, 1, '2014-10-01'),
    (72, 1, 1, '2018-01-15'),
    (73, 1, 1, '2019-01-14'),
    (75, 1, 1, '2020-01-01'),
    (78, 1, 1, '2007-11-01'),
    (81, 2, 4, '2009-09-01'),
    (82, 2, 5, '2019-10-01'),
    (86, 1, 1, '2008-11-01'),
    (93, 2, 5, '2017-10-01'),
    (94, 1, 1, '2023-09-04'),
    (96, 2, 5, '2001-10-01'),
    (99, 2, 4, '2017-02-01'),
    (104, 2, 5, '2022-09-01'),
    (111, 1, 1, '2005-11-01'),
    (115, 1, 1, '2024-09-01'),
    (119, 2, 5, '2016-09-01'),
    (126, 2, 5, '2008-09-01'),
    (138, 1, 1, '2007-09-01'),
    (148, 5, 1, '2021-01-01'),
    (160, 1, 1, '2010-09-01'),
    (172, 1, 1, '2023-10-01'),
    (247, 1, 1, '2022-07-01'),
    (294, 1, 1, '2021-12-01')
)
INSERT INTO emplois_chercheurs (corps, grade, emploi)
SELECT ma.corps, ma.grade, e.id
FROM membre_attr ma
JOIN emplois e ON e.personne = ma.personne AND e.date_debut = ma.date_debut::date
WHERE NOT EXISTS (
  SELECT 1 FROM emplois_chercheurs ec WHERE ec.emploi = e.id
);

WITH membre_attr(personne, corps, grade, date_debut) AS (
VALUES
    (2, 4, 3, '2004-09-01'),
    (4, 3, 1, '2006-09-01'),
    (5, 4, 4, '2018-10-01'),
    (8, 5, 1, '2024-01-02'),
    (9, 3, 1, '2012-09-01'),
    (11, 4, 4, '1998-09-01'),
    (12, 3, 1, '2024-09-01'),
    (13, 3, 2, '1997-01-01'),
    (15, 3, 1, '2013-09-01'),
    (16, 4, 3, '2001-09-01'),
    (17, 6, 1, '2023-09-01'),
    (18, 3, 2, '1997-01-01'),
    (19, 3, 2, '1997-01-01'),
    (22, 4, 5, '2023-09-01'),
    (23, 3, 2, '1999-01-01'),
    (24, 3, 2, '1997-01-01'),
    (25, 4, 3, '2010-09-01'),
    (26, 4, 4, '2014-11-01'),
    (27, 3, 1, '2005-09-01'),
    (29, 3, 2, '1999-12-01'),
    (30, 3, 1, '2023-09-02'),
    (31, 3, 1, '2023-09-01'),
    (32, 3, 1, '2005-10-01'),
    (34, 3, 1, '2010-09-01'),
    (35, 4, 3, '1997-01-01'),
    (36, 3, 1, '2018-09-01'),
    (37, 4, 5, '2010-09-01'),
    (38, 3, 2, '1997-01-01'),
    (39, 4, 1, '2012-09-01'),
    (40, 4, 3, '1997-01-01'),
    (41, 3, 1, '2018-09-01'),
    (42, 3, 1, '2005-09-01'),
    (43, 4, 3, '1993-09-01'),
    (45, 3, 2, '1997-01-01'),
    (47, 3, 1, '2023-09-01'),
    (49, 3, 1, '2021-10-01'),
    (51, 3, 2, '1998-09-01'),
    (52, 3, 2, '1994-09-01'),
    (54, 4, 3, '1997-01-01'),
    (55, 4, 4, '2002-09-01'),
    (56, 3, 1, '2015-01-01'),
    (57, 4, 3, '1997-01-01'),
    (59, 3, 1, '2020-12-01'),
    (60, 4, 4, '1997-10-01'),
    (61, 4, 3, '1997-01-01'),
    (62, 3, 2, '1997-01-01'),
    (64, 3, 2, '1998-01-01'),
    (65, 3, 1, '2006-09-01'),
    (67, 4, 1, '2010-09-01'),
    (68, 3, 1, '2012-09-01'),
    (69, 3, 2, '1997-01-01'),
    (70, 3, 1, '1999-01-01'),
    (74, 3, 1, '2005-09-01'),
    (76, 3, 1, '2011-09-01'),
    (77, 4, 3, '1996-01-01'),
    (79, 3, 1, '2013-09-01'),
    (80, 3, 1, '2024-09-01'),
    (83, 3, 2, '1997-01-01'),
    (84, 3, 1, '2022-09-01'),
    (85, 3, 2, '1997-01-01'),
    (87, 3, 2, '1997-01-01'),
    (88, 3, 2, '2005-09-01'),
    (89, 3, 1, '2022-09-01'),
    (90, 3, 2, '1997-01-01'),
    (91, 4, 3, '1997-01-01'),
    (95, 3, 2, '2005-09-01'),
    (97, 3, 1, '2001-09-01'),
    (100, 4, 1, '2009-09-01'),
    (108, 4, 5, '2008-09-01'),
    (109, 3, 1, '2008-11-20'),
    (110, 3, 2, '2012-09-01'),
    (113, 4, 3, '2017-01-01'),
    (118, 4, 4, '2005-10-01'),
    (120, 4, 5, '2015-09-01'),
    (121, 3, 2, '2021-09-01'),
    (129, 3, 1, '2007-01-01'),
    (130, 3, 2, '2006-09-01'),
    (132, 3, 1, '2010-09-01'),
    (133, 3, 1, '2012-09-01'),
    (134, 3, 2, '1993-10-01'),
    (135, 4, 4, '2006-09-01'),
    (140, 3, 1, '2016-09-01'),
    (141, 4, 4, '2013-11-01'),
    (142, 4, 3, '2018-10-01'),
    (147, 3, 1, '2012-09-01'),
    (151, 3, 1, '2024-09-01'),
    (152, 3, 1, '1997-01-01'),
    (153, 3, 1, '2022-09-01'),
    (154, 3, 2, '2005-09-01'),
    (157, 3, 1, '2023-02-01'),
    (159, 3, 1, '2005-09-01'),
    (165, 4, 4, '2013-09-01'),
    (167, 4, 5, '1997-01-01'),
    (168, 4, 3, '2001-10-01'),
    (170, 4, 4, '2010-09-01'),
    (173, 3, 1, '2007-09-01'),
    (174, 3, 1, '2008-09-01'),
    (295, 4, 1, '1997-01-01')
)
INSERT INTO emplois_enseignants_chercheurs (corps, grade, emploi)
SELECT ma.corps, ma.grade, e.id
FROM membre_attr ma
JOIN emplois e ON e.personne = ma.personne AND e.date_debut = ma.date_debut::date
WHERE NOT EXISTS (
  SELECT 1 FROM emplois_enseignants_chercheurs ee WHERE ee.emploi = e.id
);

WITH membre_attr(personne, corps, grade, date_debut) AS (
VALUES
    (202, 8, 1, '2011-05-01'),
    (203, 12, 1, '2011-01-01'),
    (204, 8, 1, '2016-09-01'),
    (205, 11, 1, '2004-12-01'),
    (206, 11, 1, '2006-12-01'),
    (207, 12, 1, '2015-09-01'),
    (208, 8, 1, '2007-08-01'),
    (209, 10, 1, '2019-07-01'),
    (210, 11, 1, '2002-08-01'),
    (211, 9, 1, '2004-04-01'),
    (212, 11, 1, '1998-07-01')
)
INSERT INTO emplois_biatss (corps, grade, emploi)
SELECT ma.corps, ma.grade, e.id
FROM membre_attr ma
JOIN emplois e ON e.personne = ma.personne AND e.date_debut = ma.date_debut::date
WHERE NOT EXISTS (
  SELECT 1 FROM emplois_biatss eb WHERE eb.emploi = e.id
);

WITH cdd_attr(personne, date_debut) AS (
VALUES
    (213, '2023-01-01'),
    (214, '2019-04-01'),
    (215, '2019-09-01'),
    (216, '2018-02-01'),
    (217, '2024-11-15'),
    (218, '2024-12-02'),
    (219, '2024-10-01'),
    (220, '2024-01-01'),
    (221, '2023-09-04'),
    (222, '2022-11-01'),
    (223, '2020-10-01'),
    (224, '2023-11-01'),
    (225, '2016-12-12'),
    (226, '2020-09-10'),
    (227, '2020-12-01'),
    (228, '2021-02-12'),
    (229, '2021-11-01'),
    (230, '2022-06-01'),
    (231, '2019-10-01'),
    (232, '2019-11-15'),
    (233, '2018-01-15'),
    (234, '2024-04-02'),
    (235, '2020-09-01'),
    (236, '2024-10-01'),
    (237, '2020-11-01'),
    (238, '2024-10-01'),
    (239, '2023-04-03'),
    (240, '2019-09-01'),
    (241, '2024-11-01'),
    (242, '2024-10-01'),
    (243, '2024-10-15'),
    (244, '2024-10-01'),
    (245, '2020-02-02'),
    (246, '2021-03-01'),
    (248, '2022-10-01'),
    (249, '2019-02-01'),
    (250, '2017-09-01'),
    (251, '2024-09-01'),
    (252, '2024-10-01'),
    (253, '2023-02-01'),
    (254, '2017-09-01'),
    (255, '2014-10-01'),
    (256, '2007-10-01'),
    (257, '2023-09-15'),
    (259, '2018-09-01'),
    (260, '2021-01-01'),
    (261, '2021-09-01'),
    (262, '2023-02-01'),
    (263, '2024-09-01'),
    (264, '2016-04-01'),
    (265, '2018-05-28'),
    (266, '2023-11-01'),
    (267, '2020-09-01'),
    (268, '2020-10-01'),
    (269, '2020-10-01'),
    (270, '2022-10-01'),
    (271, '2021-10-01'),
    (272, '2019-11-01'),
    (273, '2024-09-01'),
    (274, '2021-11-01'),
    (276, '2021-09-01'),
    (277, '2017-10-01'),
    (278, '2018-10-15'),
    (279, '2021-03-15'),
    (280, '2019-10-01'),
    (282, '2024-10-01'),
    (283, '2019-09-01'),
    (284, '2022-12-01'),
    (285, '2020-09-01'),
    (286, '2018-10-15'),
    (287, '2024-04-01'),
    (288, '2013-10-01'),
    (289, '2023-10-01'),
    (290, '2023-07-01'),
    (291, '2019-11-04'),
    (292, '2023-11-01'),
    (293, '2018-10-15')
),
matched AS (
  SELECT ca.personne,
         ca.date_debut,
         e.id AS emploi_id,
         al.id AS affectation_id
  FROM cdd_attr ca
  JOIN emplois e ON e.personne = ca.personne AND e.date_debut = ca.date_debut::date
  JOIN affectations_laboratoires al
    ON al.personne = ca.personne
   AND al.date_debut = ca.date_debut::date
)
INSERT INTO emplois_cdd (emploi, duree_mois)
SELECT m.emploi_id,
       CASE
         WHEN fal.date_fin IS NULL THEN 12
         ELSE GREATEST(
           1,
           (DATE_PART('year', AGE(fal.date_fin::date, e.date_debut))::int * 12) +
           DATE_PART('month', AGE(fal.date_fin::date, e.date_debut))::int +
           CASE WHEN DATE_PART('day', AGE(fal.date_fin::date, e.date_debut)) > 0 THEN 1 ELSE 0 END
         )
       END
FROM matched m
JOIN emplois e ON e.id = m.emploi_id
LEFT JOIN fin_affectations_laboratoires fal ON fal.affectation_laboratoire = m.affectation_id
WHERE NOT EXISTS (
  SELECT 1 FROM emplois_cdd c WHERE c.emploi = m.emploi_id
);



WITH doctorant_emplois (nom, prenom, date_naissance, date_debut, etablissement, ecole_doctorale, categorie_financement, etablissement_master) AS (
VALUES
    ('ABOUABDALLAH', 'Mohamed Anwar', '1995-09-08', '2019-10-01', 2, 1, 3, 4),
    ('ADERGHAL', 'Karim', '1988-08-02', '2016-03-01', 1, 1, 1, 2),
    ('AITKACI', 'Tassadit', '1990-07-09', '2019-02-01', 31, 1, 1, 4),
    ('ALAMI', 'Karim', '1990-09-12', '2017-10-01', 1, 1, 1, 5),
    ('ALBA', 'Vincent', '1996-09-26', '2022-09-01', 1, 1, 6, 4),
    ('AMARI', 'Rafik', '1985-09-03', '2022-01-01', 23, 1, 7, 2),
    ('ANDRIANTSOAMBEROMANGA', 'Maeva', '1998-09-06', '2022-10-01', 2, 1, 1, 3),
    ('APPRIOU', 'Aurélien', '1990-07-18', '2017-10-01', 2, 1, 6, 2),
    ('ARCHIPOFF', 'Simon', '1986-01-02', '2015-10-01', 1, 1, 1, 3),
    ('ASLOUDJ', 'Yanis', '2000-07-04', '2022-10-01', 1, 1, 1, 5),
    ('ASSOR', 'Ambre', '1996-11-28', '2020-10-01', 2, 1, 3, 2),
    ('AUVILLE', 'Asia', '2002-01-05', '2024-10-01', 2, 1, 1, 4),
    ('AWUKLU', 'Kokou-Yvon', '1993-01-13', '2022-10-01', 3, 1, 1, 3),
    ('AYYAR', 'Meghna Parameswaran', '1996-08-07', '2022-10-01', 1, 1, 1, 2),
    ('BAHI', 'Aref', '1999-07-13', '2024-09-01', 23, 1, 7, 2),
    ('BANDET', 'Alexis', '1995-06-15', '2021-09-01', 2, 1, 6, 4),
    ('BARJOU', 'Emile', '1996-01-29', '2019-10-01', 45, 1, 6, 2),
    ('BASTIDE', 'Paul', '1999-06-28', '2022-09-01', 1, 1, 1, 1),
    ('BATHIE', 'Gabriel', '1998-07-03', '2022-09-01', 1, 1, 1, 3),
    ('BAUCHER', 'Edgar', '2000-05-26', '2023-09-01', 1, 1, 1, 1),
    ('BEAUDOUX', 'Vincent', '1988-01-05', '2017-05-20', 3, 1, 3, 5),
    ('BEAUMARD', 'Colleen', '1997-06-02', '2022-10-01', 3, 1, 3, 2),
    ('BECHER', 'Cindy', '1994-12-11', '2018-09-01', 46, 1, 1, 2),
    ('BELLOUM', 'Rafik', '1992-07-02', '2017-05-01', 2, 1, 3, 4),
    ('BENAROCH', 'Camille', '1993-01-11', '2018-10-01', 2, 1, 3, 2),
    ('BENDI-OUIS', 'Yannis', '1995-04-25', '2023-10-01', 2, 1, 3, 3),
    ('BENMANSOUR', 'Tariq', '1982-01-11', '2015-03-01', 81, 1, 1, 5),
    ('BEZIAU', 'Paul', '1995-08-30', '2018-11-01', 82, 1, 3, 4),
    ('BILLY', 'Antoine', '1992-11-28', '2017-05-01', 83, 1, 4, 2),
    ('BINET', 'Anaïs', '1999-12-22', '2022-09-01', 1, 1, 1, 2),
    ('BIZIERE', 'Clotilde', '2000-02-19', '2024-09-01', 1, 1, 1, 3),
    ('BLANCHE', 'Alexandre', '1994-10-11', '2018-09-01', 1, 1, 1, 1),
    ('BONNET', 'Pierre', '1998-05-18', '2022-09-01', 1, 1, 1, 1),
    ('BOSE', 'Sougata', '1994-11-24', '2017-10-01', 1, 1, 1, 3),
    ('BOUGHARIOU', 'Rima', '1999-09-27', '2024-09-01', 16, 1, 7, 3),
    ('BOURNEUF', 'Romain', '2000-10-15', '2024-09-01', 1, 1, 1, 1),
    ('BOYER', 'Florian', '1991-05-01', '2017-05-01', 85, 1, 4, 2),
    ('BRASSART', 'Mathieu', '2000-12-11', '2023-11-01', 4, 1, 5, 3),
    ('BRIERE', 'Marie-Galadriel', '1995-11-09', '2019-10-01', 1, 1, 1, 5),
    ('BRUN', 'Anna-Louise', '2000-10-30', '2024-10-01', 1, 1, 3, 2),
    ('BRUNEL', 'Camille', '1989-09-12', '2017-12-01', 2, 1, 3, 2),
    ('CALLUAUD', 'Abel', '1997-08-16', '2022-10-03', 82, 1, 3, 4),
    ('CAM', 'Tristan', '2000-08-30', '2024-03-04', 88, 1, 4, 1),
    ('CARRARD', 'Thierry', '1976-10-26', '2003-07-28', 82, 1, 3, 4),
    ('CARRILLO LINDADO', 'Hernan Camilo', '1995-09-30', '2020-10-01', 1, 1, 1, 2),
    ('CASAMAYOU', 'Vincent', '1996-05-29', '2022-10-01', 1, 1, 1, 2),
    ('CASARES-SANTOS', 'Antonio', '1997-04-11', '2020-10-01', 1, 1, 1, 3),
    ('CASSAGNE', 'Adrien', '1989-02-02', '2017-10-01', 2, 1, 3, 4),
    ('CASSEAU', 'Christophe', '1970-02-21', '2019-11-01', 89, 1, 1, 5),
    ('CASTANET', 'Tobias', '1994-07-27', '2018-09-01', 1, 1, 1, 4),
    ('CAUBET', 'Christophe', '1996-06-04', '2019-11-18', 91, 1, 4, 2),
    ('CHAABOUNI', 'Nadia', '1991-06-14', '2017-06-01', 92, 1, 4, 3),
    ('CHAIX-EICHEL', 'Naomi', '1996-06-11', '2021-10-01', 1, 1, 1, 3),
    ('CHAMBRES', 'Gaëtan', '1994-07-15', '2018-09-01', 1, 1, 3, 2),
    ('CHAOUCHI', 'Aghiles', '1994-05-04', '2018-12-01', 1, 1, 2, 5),
    ('CHATEAU LAURENT', 'Hugo', '1996-09-15', '2020-11-01', 2, 1, 3, 3),
    ('CHEN', 'Wei', '1989-03-09', '2016-07-26', 101, 1, 7, 5),
    ('CIORNA', 'Vasile', '1990-02-11', '2020-06-01', 102, 1, 7, 5),
    ('CLAUDE', 'Elsa', '1997-11-04', '2021-10-01', 4, 1, 3, 5),
    ('COLAJANNI', 'Antonin', '2000-05-25', '2023-09-01', 1, 3, 1, 5),
    ('CORSINI', 'Timothée', '1997-06-20', '2021-09-01', 1, 1, 1, 1),
    ('COYE', 'Baptiste', '1992-06-30', '2020-04-01', 104, 1, 4, 4),
    ('CROSTA', 'Tomas', '1999-09-15', '2024-09-01', 1, 1, 2, 1),
    ('D''''AVIAU DE PIOLANT', 'Albert', '2000-03-16', '2023-10-01', 2, 1, 3, 4),
    ('DA SILVA', 'Simon', '1994-09-13', '2017-10-01', 1, 1, 1, 5),
    ('DAGAR', 'Snigdha', '1995-01-26', '2019-12-01', 2, 1, 2, 3),
    ('DAHAOUI', 'Ibrahim', '1993-02-23', '2020-02-01', 1, 1, 3, 1),
    ('DAOUDI', 'Idriss', '1992-10-28', '2018-10-01', 2, 1, 1, 4),
    ('DARBAR', 'Rajkumar', '1991-04-20', '2017-12-01', 2, 1, 3, 2),
    ('DARDOUR', 'Mayssa', '1997-10-26', '2022-04-01', 94, 1, 3, 3),
    ('DAVID', 'Jean-François', '1993-07-08', '2021-09-01', 2, 1, 6, 4),
    ('DE CASTRO PINTO', 'Théo', '1998-07-25', '2022-03-01', 108, 1, 4, 3),
    ('DELPY', 'Romain', '2000-04-06', '2023-09-01', 1, 1, 3, 3),
    ('DREYER', 'Pauline', '1993-03-05', '2023-10-01', 2, 1, 3, 2),
    ('DUCLUSAUD', 'Marc', '1998-01-28', '2022-10-01', 1, 1, 3, 3),
    ('DULAU', 'Idris', '1999-01-19', '2022-09-01', 1, 1, 3, 2),
    ('ECHEZARRETA ARRUTI', 'Ander', '1998-04-20', '2024-01-02', 1, 1, 3, 2),
    ('ECONOMIDES', 'Marie', '1995-12-28', '2020-12-14', 109, 1, 4, 2),
    ('EVEN', 'Melvin', '1998-02-08', '2021-10-01', 2, 1, 3, 2),
    ('FACCI', 'Aurélien', '2000-05-28', '2023-10-01', 110, 1, 4, 5),
    ('FEJER', 'Attila', '1991-01-25', '2018-10-01', 111, 1, 7, 2),
    ('FELSOCI', 'Marek', '1996-04-23', '2019-10-01', 2, 1, 2, 4),
    ('FERRON', 'Aymeric', '1999-03-19', '2023-03-01', 2, 1, 3, 2),
    ('FIRMO DRUMOND', 'Thalita', '1989-11-02', '2017-10-01', 2, 1, 3, 3),
    ('FONTAINE', 'Lucie', '1999-06-23', '2023-10-01', 1, 1, 3, 3),
    ('FONTAINE', 'Oscar', '2001-04-13', '2024-09-01', 1, 1, 3, 1),
    ('FOSSE', 'Rohan', '1995-10-08', '2017-11-15', 1, 1, 3, 3),
    ('FOURNEAU', 'Gary', '1999-07-02', '2021-10-01', 2, 1, 3, 2),
    ('FUCCELLARO', 'Maxime', '1995-06-08', '2021-01-01', 186, 1, 4, 1),
    ('GARRIGUES', 'Mathilde', '1991-06-04', '2020-01-06', 91, 1, 4, 5),
    ('GASPARD', 'Clément', '1998-05-04', '2022-09-01', 1, 1, 1, 3),
    ('GAVOILLE', 'Clément', '1998-08-16', '2021-01-01', 82, 1, 3, 4),
    ('GEBRESLASSIE', 'Abel Kahsay', '1995-08-07', '2022-10-01', 1, 1, 3, 5),
    ('GENAY', 'Adélaïde', '1996-04-15', '2019-10-01', 2, 1, 3, 2),
    ('GHASSEMI NEJDAD', 'Chabname', '1989-06-18', '2022-10-01', 1, 1, 1, 3),
    ('GHIGO', 'Vincent', '2000-12-09', '2024-10-01', 1, 1, 3, 3),
    ('GHNAYA', 'Imed', '1996-09-11', '2021-03-01', 4, 1, 2, 3),
    ('GIOVANNANGELI', 'Loann', '1996-11-09', '2020-10-01', 1, 1, 1, 5),
    ('GIRAUDEAU', 'Philippe', '1991-03-26', '2017-10-01', 2, 1, 3, 2),
    ('GOEDEFROIT', 'Charles', '1998-09-30', '2024-03-01', 157, 1, 4, 4),
    ('GROS CHAUVERGNE', 'Edwige', '1996-02-19', '2021-10-01', 2, 1, 3, 2),
    ('GUERRIERI', 'Pierre-Loup', '1999-10-27', '2024-03-01', 4, 1, 3, 5),
    ('GUEVARA GARBAN', 'Manuel', '1997-01-15', '2022-10-01', 1, 3, 1, 2),
    ('HALNAUT', 'Adrien', '1996-01-17', '2019-10-01', 1, 1, 1, 5),
    ('HASSINI', 'Lamyae', '2001-02-05', '2024-10-01', 1, 1, 3, 5),
    ('HILAIRE', 'Claire', '1997-10-06', '2020-10-01', 1, 1, 3, 1),
    ('HILAIRE', 'Thibault', '1997-02-26', '2021-09-01', 1, 1, 3, 3),
    ('HONORE', 'Valentin', '1991-10-11', '2017-11-01', 1, 1, 1, 4),
    ('HOUZELOT', 'Agathe', '1997-10-11', '2020-10-05', 115, 1, 4, 1),
    ('HUBNER', 'Nicolas', '2000-11-14', '2023-10-01', 1, 1, 3, 5),
    ('HYSENI', 'Fjola', '1995-05-11', '2020-10-01', 1, 1, 3, 3),
    ('IANNACITO', 'Martina', '1995-11-28', '2019-10-01', 2, 1, 3, 4),
    ('IBARBOURE', 'Sébastien', '1993-05-25', '2018-01-01', 118, 1, 6, 2),
    ('IBRAHIM', 'Aïda', '1995-01-25', '2021-04-01', 3, 3, 3, 3),
    ('JABALLI', 'Samawel', '1997-08-29', '2023-01-01', 1, 1, 7, 2),
    ('JACQUES', 'Amaury', '1996-06-10', '2022-10-01', 1, 1, 3, 1),
    ('JEAN', 'Robin', '1999-10-18', '2023-10-03', 3, 1, 3, 3),
    ('JEGOUREL', 'Adrien', '1998-08-01', '2022-03-21', 119, 1, 4, 5),
    ('JOLICOEUR', 'Lise', '1999-07-18', '2022-11-01', 82, 1, 3, 4),
    ('JOUANNEAU', 'Warren', '1991-01-19', '2020-01-14', 120, 1, 5, 2),
    ('KAMBIRE', 'Sidoine', '1996-06-12', '2019-11-15', 1, 1, 2, 5),
    ('KAMRAOUI', 'Reda Abdellah', '1995-09-07', '2019-11-01', 1, 1, 3, 2),
    ('KAO', 'Shih-shun', '1988-07-31', '2019-09-01', 1, 1, 3, 1),
    ('KARABOGHOSSIAN', 'Théo', '1993-06-08', '2017-09-01', 1, 1, 1, 1),
    ('KAUSHIK', 'Pramod', '1990-06-22', '2018-10-01', 2, 1, 10, 3),
    ('KHAMARI', 'Sabri', '1995-01-31', '2020-03-01', 4, 1, 2, 3),
    ('KHATTABI RIFFI', 'Adnane', '1996-03-07', '2019-11-01', 15, 1, 3, 1),
    ('KORKMAZ', 'Esragul', '1992-01-21', '2018-11-01', 2, 1, 3, 4),
    ('KORKMAZ', 'Kadir', '1989-04-15', '2019-11-15', 1, 1, 2, 5),
    ('KOVAL', 'Mogane', '1997-12-16', '2020-02-01', 2, 1, 3, 2),
    ('KSOURI', 'Chahrazed', '1990-12-03', '2016-09-01', 101, 1, 1, 5),
    ('LA ROCCA', 'Pierre', '1998-05-22', '2022-10-19', 1, 1, 3, 5),
    ('LAAROUSSI', 'Oussama', '1995-10-17', '2022-01-01', 23, 1, 7, 2),
    ('LACAUD', 'Mathias', '1993-03-19', '2017-08-01', 130, 1, 4, 5),
    ('LAFOURCADE', 'Pierre', '1999-12-17', '2023-09-01', 1, 1, 3, 3),
    ('LAJOU', 'Dimitri', '1994-08-31', '2018-09-01', 1, 1, 1, 1),
    ('LALLIER', 'Corentin', '1981-11-29', '2019-10-01', 120, 1, 5, 5),
    ('LARROZE-JARDINÉ', 'Sarah', '1998-07-01', '2021-10-01', 1, 1, 3, 3),
    ('LASSALLE-ASTIS', 'Nina', '1998-04-09', '2023-02-01', 132, 1, 5, 2),
    ('LASSERRE', 'Alice', '1999-12-16', '2022-09-01', 2, 1, 3, 4),
    ('LATAPPY', 'Corentin', '2000-11-28', '2021-07-15', 133, 1, 4, 5),
    ('LAUDONIO', 'Matteo', '1993-06-01', '2018-10-01', 1, 1, 3, 1),
    ('LAUMOND', 'Antoine', '1991-06-28', '2016-04-01', 1, 1, 3, 5),
    ('LE BOT', 'Edern', '1998-10-01', '2022-10-01', 1, 1, 3, 2),
    ('LE MEUDEC', 'Juliette', '2001-05-21', '2023-10-01', 2, 1, 3, 2),
    ('LECOMTE', 'Maxime', '1996-02-22', '2020-11-01', 135, 1, 3, 5),
    ('LEGRAND', 'Clément', '1997-12-23', '2021-09-01', 1, 1, 1, 1),
    ('LENTZ', 'Antonin', '1992-07-16', '2017-11-01', 1, 1, 1, 1),
    ('LEVEAU', 'Julien', '1993-05-20', '2018-05-01', 137, 1, 4, 5),
    ('LION', 'Romain', '1994-12-17', '2018-10-01', 2, 1, 6, 4),
    ('LIRA NUNES', 'Alan', '1992-11-09', '2023-03-01', 2, 1, 7, 4),
    ('LISITO', 'Alycia', '1999-09-13', '2024-01-01', 42, 1, 4, 4),
    ('LONGUEFOSSE', 'Arthur', '1996-08-19', '2021-10-01', 1, 1, 3, 2),
    ('LOPEZ', 'Angélique', '1998-01-31', '2021-09-06', 178, 1, 5, 5),
    ('LOPEZ', 'Myriam', '1993-11-29', '2018-07-01', 120, 1, 4, 2),
    ('LOPEZ-RODRIGUEZ', 'Mario', '1988-05-09', '2022-02-01', 143, 1, 7, 2),
    ('LUCAS', 'Gwenolé', '1996-10-03', '2019-11-01', 2, 1, 3, 4),
    ('LUCAS', 'Simon', '2000-09-13', '2021-10-01', 1, 1, 3, 2),
    ('MAGANA LOPEZ', 'Gustavo', '1996-08-06', '2022-09-01', 1, 1, 3, 3),
    ('MAILLARD', 'Vimala', '1998-04-21', '2023-10-01', 1, 1, 3, 1),
    ('MALLICK', 'Rupayan', '1995-08-13', '2020-10-01', 1, 1, 3, 2),
    ('MANIÈRE', 'Quentin', '1995-11-14', '2019-10-01', 1, 1, 3, 3),
    ('MARCILLE', 'Clara', '1999-07-05', '2022-09-01', 1, 1, 1, 1),
    ('MARCÉ', 'Taïssir', '2001-01-22', '2024-10-09', 3, 1, 3, 1),
    ('MARIE-MAGDELAINE', 'Nicolas', '1991-12-16', '2017-07-01', 120, 1, 4, 5),
    ('MARISSENS CUEVA', 'Valérie', '1999-05-07', '2023-12-01', 2, 1, 3, 2),
    ('MARLIER', 'Maudeline', '1998-10-28', '2022-05-10', 95, 1, 4, 2),
    ('MARTIN', 'Pierre-Etienne', '1993-02-19', '2017-11-01', 1, 1, 2, 2),
    ('MARTIN', 'Vincent', '1996-02-05', '2019-10-01', 1, 1, 3, 2),
    ('MASCLE', 'Corto', '1998-11-17', '2021-09-01', 1, 1, 1, 3),
    ('MATRICON', 'Théo', '1997-10-24', '2021-10-01', 1, 1, 3, 3),
    ('MELGAR FERNANDEZ', 'Raquel', '2000-01-29', '2024-02-01', 1, 1, 3, 1),
    ('MENDIBOURE', 'Léo', '1994-04-14', '2018-01-01', 1, 1, 3, 5),
    ('MERCIER', 'Chloé', '1994-02-16', '2020-10-01', 2, 1, 3, 3),
    ('METUEKAM', 'Françoise', '1998-10-07', '2024-10-01', 1, 1, 3, 5),
    ('MOHAMED EL MAAROUF', 'Aboul-Karim', '1993-06-06', '2020-03-01', 94, 1, 1, 4),
    ('MONCE', 'Gustave', '1999-12-29', '2022-10-01', 1, 1, 1, 5),
    ('MONTOYA OBESO', 'Abraham', '1991-03-04', '2017-02-01', 143, 1, 7, 2),
    ('MOREL', 'Bastien', '2000-09-29', '2024-10-01', 1, 1, 3, 2),
    ('MOREL', 'Nicolas', '1999-07-07', '2023-11-01', 4, 1, 3, 5),
    ('MORIN', 'Ludovic', '1996-10-29', '2022-09-01', 1, 1, 3, 1),
    ('MORIN', 'Thomas', '1999-11-17', '2023-10-01', 1, 1, 3, 4),
    ('MORVAN', 'Rémi', '1997-12-12', '2021-09-01', 1, 1, 3, 3),
    ('MOUHOUB', 'Noureddine', '1995-07-19', '2019-10-01', 1, 1, 3, 5),
    ('MOULIE', 'Gabin', '1996-05-29', '2023-02-01', 145, 1, 4, 2),
    ('MUKAM', 'Augusta', '2000-04-29', '2022-10-15', 1, 1, 3, 5),
    ('MULLER', 'Thomas', '1999-07-13', '2022-09-01', 1, 1, 3, 1),
    ('MUNHOZ PEREIRA FILHO', 'Vanderlei', '1993-03-27', '2024-12-01', 2, 1, 3, 4),
    ('NADOR', 'Victor', '1996-03-01', '2020-10-01', 1, 1, 3, 1),
    ('NAQUIN', 'Emile', '1999-05-03', '2023-09-01', 1, 1, 1, 1),
    ('NARBONI', 'Jonathan', '1990-10-07', '2019-10-01', 94, 1, 1, 1),
    ('NAVET', 'Eloi', '2000-06-30', '2024-10-01', 1, 1, 3, 2),
    ('NGUYEN', 'Huy-Dung', '1995-09-17', '2020-10-01', 1, 1, 3, 2),
    ('NGUYEN', 'Van Man', '1996-02-05', '2019-11-01', 82, 1, 3, 4),
    ('NICOLAS', 'Brieuc', '2001-10-30', '2024-10-01', 2, 1, 3, 4),
    ('OOTA', 'Subba Reddy', '1989-04-17', '2020-11-01', 2, 1, 3, 3),
    ('ORHAN', 'Diane', '1997-11-25', '2022-09-01', 1, 1, 1, 4),
    ('OUMAZIZ', 'Mohamed Ameziane', '1993-05-15', '2016-09-01', 1, 1, 3, 5),
    ('OUVRARD', 'Paul', '1994-04-08', '2017-10-01', 1, 1, 3, 1),
    ('PADIOLLEAU', 'Guillaume', '1994-03-26', '2018-09-10', 82, 1, 3, 3),
    ('PAGLIARINI', 'Silvia', '1992-10-26', '2017-11-01', 2, 1, 3, 3),
    ('PALAUDE', 'Axel', '1998-10-03', '2021-10-01', 2, 1, 3, 3),
    ('PASCALIE', 'Romain', '1993-12-10', '2017-09-01', 1, 1, 3, 1),
    ('PAUL', 'Soumyajit', '1993-08-15', '2018-09-01', 1, 1, 3, 3),
    ('PELLETIER', 'Fabien', '1999-07-15', '2023-10-01', 1, 1, 3, 2),
    ('PEPIN', 'Thibaut', '1997-03-09', '2023-03-15', 82, 1, 3, 4),
    ('PERESSONI', 'Romain', '1996-12-01', '2019-10-15', 1, 1, 2, 4),
    ('PEREZ DE SAN ROMAN', 'Philippe', '1991-11-19', '2017-06-01', 149, 1, 4, 2),
    ('PESQUET', 'Baptiste', '1976-11-26', '2023-10-18', 4, 1, 1, 3),
    ('PICAVET', 'Timothé', '2000-04-24', '2024-09-01', 1, 1, 3, 1),
    ('PIRRONE', 'Antoine', '1994-08-23', '2018-12-01', 3, 1, 6, 2),
    ('PITTERI', 'Giorgia', '1991-05-22', '2017-11-15', 1, 1, 3, 2),
    ('POMME-CASSIEROU', 'Luc-Etienne', '1997-04-19', '2020-11-01', 1, 1, 2, 5),
    ('PORET', 'Maxime', '1994-04-14', '2019-10-01', 1, 1, 3, 2),
    ('PREVOST', 'Adrien', '1992-09-09', '2018-01-02', 95, 1, 4, 3),
    ('RACHEDI', 'Abdennour', '1995-06-23', '2019-10-21', 4, 1, 2, 5),
    ('RAHA', 'Ritam', '1996-07-04', '2019-10-01', 152, 1, 7, 3),
    ('RAIS', 'Sylvain', '2000-06-11', '2023-10-02', 1, 1, 3, 3),
    ('RAJANBABU', 'Govind', '1993-04-27', '2017-11-01', 1, 1, 3, 3),
    ('RAMANATHAN', 'Varun', '1995-12-04', '2018-09-01', 1, 1, 3, 3),
    ('RAPETTI', 'Alexandre', '1996-06-22', '2020-11-16', 82, 1, 3, 1),
    ('REBY', 'Kevin', '1985-10-26', '2019-09-03', 153, 1, 4, 2),
    ('REY', 'Stéphanie', '1984-05-28', '2017-03-01', 154, 1, 4, 2),
    ('REYNIER', 'Florian', '1994-10-25', '2019-01-14', 82, 1, 3, 4),
    ('RICHARD', 'Sébastien', '1999-04-11', '2023-09-01', 1, 1, 3, 2),
    ('RICHEFORT', 'Clément', '1998-12-05', '2021-10-13', 82, 1, 3, 4),
    ('RIGAUT', 'Coralie', '1999-11-18', '2024-10-01', 1, 1, 3, 2),
    ('RIXTE', 'Alice', '1996-04-10', '2022-09-01', 1, 1, 3, 3),
    ('ROC', 'Aline', '1995-11-07', '2019-09-01', 2, 1, 6, 2),
    ('RODRIGUEZ', 'Julien', '1996-03-04', '2020-10-14', 82, 1, 3, 4),
    ('RONCALLI', 'Théo', '1997-01-20', '2023-10-01', 1, 1, 3, 3),
    ('RUBIO PROANO', 'Andrés', '1989-11-24', '2018-10-01', 2, 1, 3, 4),
    ('RYSBAYEVA', 'Korlan', '1993-09-26', '2019-12-01', 1, 1, 3, 5),
    ('SANKAR', 'Remya', '1993-12-11', '2018-10-01', 2, 1, 3, 3),
    ('SARTORI', 'Richard', '1997-03-22', '2021-04-15', 157, 1, 4, 4),
    ('SCHABANEL', 'Juliette', '2000-02-09', '2024-09-01', 1, 1, 3, 1),
    ('SCHLICK', 'Charlie', '1996-10-26', '2019-10-01', 1, 1, 3, 2),
    ('SCHOETERS', 'Jason', '1993-04-17', '2017-11-01', 1, 1, 3, 1),
    ('SCRAVAGLIERI', 'Lana', '1998-04-23', '2022-11-01', 158, 1, 3, 4),
    ('SHILOVA', 'Alena', '1994-06-19', '2018-10-08', 2, 1, 3, 4),
    ('SLIMI', 'Anwer', '1996-02-10', '2020-01-01', 23, 1, 7, 2),
    ('SPITZER', 'Gian Luca', '2000-07-27', '2024-12-01', 3, 1, 3, 1),
    ('STROCK', 'Anthony', '1994-10-03', '2017-09-01', 1, 1, 3, 3),
    ('SWARTVAGHER', 'Philippe', '1996-07-21', '2019-10-01', 2, 1, 2, 4),
    ('SWESSI', 'Rania', '1999-01-11', '2023-04-01', 4, 1, 2, 3),
    ('SYLLA', 'Tidiane', '1987-06-08', '2018-10-01', 161, 1, 7, 5),
    ('TAHIRI', 'Mohamed', '2000-11-04', '2023-11-01', 91, 1, 4, 2),
    ('TAYEB', 'Hayfa', '1997-10-23', '2021-11-01', 2, 1, 3, 4),
    ('TEGANAHALLY SRIDHARA', 'Shrinidhi', '2000-08-12', '2024-10-01', 1, 1, 3, 1),
    ('TROCELLIER', 'David', '1997-12-09', '2021-10-01', 1, 1, 3, 2),
    ('TROCHON', 'Méline', '2002-01-30', '2024-11-01', 172, 1, 4, 4),
    ('TROUVAIN', 'Nathan', '1998-01-05', '2022-10-01', 2, 1, 3, 3),
    ('TSIAPKOLIS', 'Panagiotis', '1997-06-12', '2022-01-17', 104, 1, 4, 2),
    ('VANHATALO', 'Tara', '1995-08-17', '2021-06-28', 185, 3, 4, 2),
    ('VARIN', 'Zoé', '1998-07-13', '2022-09-01', 1, 1, 3, 1),
    ('VENKOVIC', 'Nicolas', '1986-02-22', '2018-10-01', 163, 1, 5, 4),
    ('VERDON', 'Elia', '1997-04-02', '2021-10-01', 1, 3, 1, 4),
    ('VERITE', 'Mathieu', '1989-08-27', '2019-09-01', 2, 1, 2, 4),
    ('VERNAECKT', 'Pierre', '1982-09-16', '2020-10-05', 181, 1, 5, 5),
    ('VIDAL', 'Nicolas', '1993-02-07', '2018-10-01', 2, 1, 3, 4),
    ('VINAYAGAME', 'Radjasouria', '1998-07-03', '2022-12-01', 157, 1, 4, 4),
    ('VU', 'Manh Tu', '1993-08-23', '2019-11-04', 153, 1, 4, 2),
    ('WALTHER', 'Dimitri', '2001-04-19', '2024-10-01', 82, 1, 3, 4),
    ('WEBER', 'Axelle', '1996-01-18', '2019-11-12', 182, 1, 4, 5),
    ('WELTER', 'Marc', '1989-06-29', '2022-02-01', 2, 1, 6, 2),
    ('XIANG', 'Yen-Fei', '1992-08-14', '2019-11-01', 2, 1, 3, 4),
    ('YACHEUR', 'Braddedine', '1996-03-25', '2020-10-01', 4, 1, 6, 5),
    ('YAKOVLEV', 'Ivan', '1997-11-17', '2021-09-01', 1, 1, 1, 1),
    ('YEBDA', 'Thinhinane', '1994-08-10', '2018-11-08', 165, 1, 4, 2),
    ('ZAMAI', 'Andrew', '2000-02-02', '2024-10-01', 1, 1, 1, 2),
    ('ZHAO', 'Xunyi', '1997-01-08', '2021-09-01', 2, 1, 3, 4),
    ('ZHU', 'Boyu', '1998-06-03', '2024-12-02', 1, 1, 3, 5),
    ('ZHUKOV', 'Alexey', '1998-03-10', '2023-09-18', 167, 1, 7, 2),
    ('ZORN', 'Timothé', '2001-10-08', '2025-01-01', 91, 1, 4, 5),
    ('ZOURE', 'Moubarak', '1995-03-20', '2018-11-01', 1, 1, 3, 5),
    ('ZRIGUI', 'Sarra', '1991-12-15', '2020-06-01', 184, 1, 7, 2)
),
matched AS (
  SELECT p.id AS personne_id,
         de.date_debut,
         de.etablissement,
         de.ecole_doctorale,
         de.categorie_financement,
         de.etablissement_master
  FROM doctorant_emplois de
  JOIN personnes p
    ON UPPER(p.nom) = UPPER(de.nom)
   AND UPPER(p.prenom) = UPPER(de.prenom)
   AND (de.date_naissance IS NULL
        OR p.date_naissance IS NOT DISTINCT FROM de.date_naissance::date)
),
existing AS (
  SELECT e.id, e.personne, e.date_debut, e.etablissement
  FROM emplois e
  JOIN matched m
    ON e.personne = m.personne_id
   AND e.date_debut = m.date_debut::date
   AND e.etablissement = m.etablissement
),
inserted AS (
  INSERT INTO emplois (personne, etablissement, date_debut)
  SELECT personne_id, etablissement, date_debut::date
  FROM matched m
  WHERE NOT EXISTS (
    SELECT 1 FROM emplois e
    WHERE e.personne = m.personne_id
      AND e.date_debut = m.date_debut::date
      AND e.etablissement = m.etablissement
  )
  RETURNING id, personne, date_debut, etablissement
),
all_emplois AS (
  SELECT id, personne, date_debut, etablissement FROM inserted
  UNION ALL
  SELECT id, personne, date_debut, etablissement FROM existing
)
INSERT INTO emplois_doctoraux (emploi, ecole_doctorale, categorie_financement_these, etablissement_master)
SELECT ae.id,
       m.ecole_doctorale,
       m.categorie_financement,
       m.etablissement_master
FROM all_emplois ae
JOIN matched m
  ON m.personne_id = ae.personne
 AND m.date_debut::date = ae.date_debut
 AND m.etablissement = ae.etablissement
WHERE m.ecole_doctorale IS NOT NULL
  AND NOT EXISTS (SELECT 1 FROM emplois_doctoraux ed WHERE ed.emploi = ae.id);

WITH doctorant_personnes (id, nom, prenom, sexe, nationalite, date_naissance) AS (
VALUES
  (1, 'ALBA', 'Vincent', 2, 1, '1996-09-26'),
  (2, 'ANDRIANTSOAMBEROMANGA', 'Maeva', 1, 43, '1998-09-06'),
  (3, 'ASLOUDJ', 'Yanis', 2, 1, '2000-07-04'),
  (4, 'AWUKLU', 'Kokou-Yvon', 2, 44, '1993-01-13'),
  (5, 'AYYAR', 'Meghna Parameswaran', 1, 11, '1996-08-07'),
  (6, 'BANDET', 'Alexis', 2, 1, '1995-06-15'),
  (7, 'BASTIDE', 'Paul', 2, 1, '1999-06-28'),
  (8, 'BATHIE', 'Gabriel', 2, 1, '1998-07-03'),
  (9, 'BAUCHER', 'Edgar', 2, 1, '2000-05-26'),
  (10, 'BEAUMARD', 'Colleen', 1, 1, '1997-06-02'),
  (11, 'BENDI-OUIS', 'Yannis', 2, 1, '1995-04-25'),
  (12, 'BINET', 'Anaïs', 1, 1, '1999-12-22'),
  (13, 'BONNET', 'Pierre', 2, 1, '1998-05-18'),
  (14, 'BRASSART', 'Mathieu', 2, 1, '2000-12-11'),
  (15, 'CALLUAUD', 'Abel', 2, 1, '1997-08-16'),
  (16, 'CAM', 'Tristan', 2, 1, '2000-08-30'),
  (17, 'CASAMAYOU', 'Vincent', 2, 1, '1996-05-29'),
  (18, 'CHAIX-EICHEL', 'Naomi', 1, 1, '1996-06-11'),
  (19, 'CIORNA', 'Vasile', 2, 45, '1990-02-11'),
  (20, 'CLAUDE', 'Elsa', 1, 1, '1997-11-04'),
  (21, 'COLAJANNI', 'Antonin', 2, 1, '2000-05-25'),
  (22, 'CORSINI', 'Timothée', 2, 1, '1997-06-20'),
  (23, 'DARDOUR', 'Mayssa', 1, 1, '1997-10-26'),
  (24, 'D''AVIAU DE PIOLANT', 'Albert', 2, 1, '2000-03-16'),
  (25, 'DAVID', 'Jean-François', 2, 1, '1993-07-08'),
  (26, 'DE CASTRO PINTO', 'Théo', 2, 1, '1998-07-25'),
  (27, 'DELPY', 'Romain', 2, 1, '2000-04-06'),
  (29, 'DREYER', 'Pauline', 1, 1, '1993-03-05'),
  (30, 'DUCLUSAUD', 'Marc', 2, 1, '1998-01-28'),
  (31, 'DULAU', 'Idris', 2, 1, '1999-01-19'),
  (32, 'ECHEZARRETA ARRUTI', 'Ander', 2, 5, '1998-04-20'),
  (33, 'ECONOMIDES', 'Marie', 1, 1, '1995-12-28'),
  (34, 'EVEN', 'Melvin', 2, 1, '1998-02-08'),
  (35, 'FACCI', 'Aurélien', 2, 1, '2000-05-28'),
  (36, 'FERRON', 'Aymeric', 2, 1, '1999-03-19'),
  (37, 'FONTAINE', 'Lucie', 1, 1, '1999-06-23'),
  (38, 'FOURNEAU', 'Gary', 2, 1, '1999-07-02'),
  (39, 'FUCCELLARO', 'Maxime', 2, 1, '1995-06-08'),
  (40, 'GASPARD', 'Clément', 2, 1, '1998-05-04'),
  (41, 'GEBRESLASSIE', 'Abel Kahsay', 2, 23, '1995-08-07'),
  (42, 'GHASSEMI NEJDAD', 'Chabname', 1, 1, '1989-06-18'),
  (43, 'GROS CHAUVERGNE', 'Edwige', 1, 1, '1996-02-19'),
  (44, 'GUERRIERI', 'Pierre-Loup', 2, 1, '1999-10-27'),
  (45, 'GUEVARA GARBAN', 'Manuel', 2, 1, '1997-01-15'),
  (46, 'HILAIRE', 'Thibault', 2, 1, '1997-02-26'),
  (47, 'HOUZELOT', 'Agathe', 1, 1, '1997-10-11'),
  (48, 'HUBNER', 'Nicolas', 2, 1, '2000-11-14'),
  (49, 'IBRAHIM', 'Aïda', 1, 5, '1995-01-25'),
  (50, 'JABALLI', 'Samawel', 2, 20, '1997-08-29'),
  (51, 'JACQUES', 'Amaury', 2, 49, '1996-06-10'),
  (52, 'JEAN', 'Robin', 2, 1, '1999-10-18'),
  (53, 'JEGOUREL', 'Adrien', 2, 1, '1998-08-01'),
  (54, 'JOLICOEUR', 'Lise', 1, 1, '1999-07-18'),
  (55, 'LA ROCCA', 'Pierre', 2, 1, '1998-05-22'),
  (56, 'LAAROUSSI', 'Oussama', 2, 20, '1995-10-17'),
  (57, 'LAFOURCADE', 'Pierre', 2, 1, '1999-12-17'),
  (58, 'LARROZE-JARDINÉ', 'Sarah', 1, 1, '1998-07-01'),
  (59, 'LASSALLE-ASTIS', 'Nina', 1, 1, '1998-04-09'),
  (60, 'LASSERRE', 'Alice', 1, 1, '1999-12-16'),
  (61, 'LE BOT', 'Edern', 2, 1, '1998-10-01'),
  (62, 'LE MEUDEC', 'Juliette', 1, 1, '2001-05-21'),
  (63, 'LECOMTE', 'Maxime', 2, 1, '1996-02-22'),
  (64, 'LIRA NUNES', 'Alan', 2, 10, '1992-11-09'),
  (65, 'LISITO', 'Alycia', 1, 1, '1999-09-13'),
  (66, 'LONGUEFOSSE', 'Arthur', 2, 1, '1996-08-19'),
  (67, 'LUCAS', 'Simon', 2, 1, '2000-09-13'),
  (68, 'MAGANA LOPEZ', 'Gustavo', 2, 12, '1996-08-06'),
  (69, 'MARCILLE', 'Clara', 1, 1, '1999-07-05'),
  (70, 'MARISSENS CUEVA', 'Valérie', 1, 49, '1999-05-07'),
  (71, 'MARLIER', 'Maudeline', 1, 1, '1998-10-28'),
  (72, 'MASCLE', 'Corto', 2, 1, '1998-11-17'),
  (73, 'MATRICON', 'Théo', 2, 1, '1997-10-24'),
  (74, 'MELGAR FERNANDEZ', 'Raquel', 1, 5, '2000-01-29'),
  (75, 'MONCE', 'Gustave', 2, 1, '1999-12-29'),
  (76, 'MOREL', 'Nicolas', 2, 1, '1999-07-07'),
  (77, 'MORIN', 'Ludovic', 2, 1, '1996-10-29'),
  (78, 'MORIN', 'Thomas', 2, 1, '1999-11-17'),
  (79, 'MORVAN', 'Rémi', 2, 1, '1997-12-12'),
  (80, 'MOULIE', 'Gabin', 2, 1, '1996-05-29'),
  (81, 'MUKAM', 'Augusta', 1, 39, '2000-04-29'),
  (82, 'MULLER', 'Thomas', 2, 1, '1999-07-13'),
  (83, 'NAQUIN', 'Emile', 2, 1, '1999-05-03'),
  (84, 'ORHAN', 'Diane', 1, 1, '1997-11-25'),
  (85, 'PALAUDE', 'Axel', 2, 1, '1998-10-03'),
  (86, 'PELLETIER', 'Fabien', 2, 1, '1999-07-15'),
  (87, 'PEPIN', 'Thibaut', 2, 1, '1997-03-09'),
  (88, 'PESQUET', 'Baptiste', 2, 1, '1976-11-26'),
  (89, 'PICAVET', 'Timothé', 2, 1, '2000-04-24'),
  (90, 'POMME-CASSIEROU', 'Luc-Etienne', 2, 1, '1997-04-19'),
  (91, 'RAIS', 'Sylvain', 2, 1, '2000-06-11'),
  (92, 'RICHARD', 'Sébastien', 2, 1, '1999-04-11'),
  (93, 'RICHEFORT', 'Clément', 2, 1, '1998-12-05'),
  (94, 'RIXTE', 'Alice', 1, 1, '1996-04-10'),
  (95, 'RODRIGUEZ', 'Julien', 2, 1, '1996-03-04'),
  (96, 'RONCALLI', 'Théo', 2, 1, '1997-01-20'),
  (97, 'SARTORI', 'Richard', 2, 1, '1997-03-22'),
  (98, 'SCRAVAGLIERI', 'Lana', 1, 1, '1998-04-23'),
  (99, 'SWESSI', 'Rania', 1, 20, '1999-01-11'),
  (100, 'TAHIRI', 'Mohamed', 2, 1, '2000-11-04'),
  (101, 'TAYEB', 'Hayfa', 1, 20, '1997-10-23'),
  (102, 'TROCELLIER', 'David', 2, 1, '1997-12-09'),
  (103, 'TROUVAIN', 'Nathan', 2, 1, '1998-01-05'),
  (104, 'TSIAPKOLIS', 'Panagiotis', 2, 1, '1997-06-12'),
  (105, 'VARIN', 'Zoé', 1, 1, '1998-07-13'),
  (106, 'VERDON', 'Elia', 1, 1, '1997-04-02'),
  (107, 'VINAYAGAME', 'Radjasouria', 2, 1, '1998-07-03'),
  (108, 'WELTER', 'Marc', 2, 56, '1989-06-29'),
  (109, 'ZHAO', 'Xunyi', 2, 6, '1997-01-08'),
  (110, 'ZHUKOV', 'Alexey', 2, 8, '1998-03-10'),
  (111, 'SCHABANEL', 'Juliette', 1, 1, '2000-02-09'),
  (113, 'NAVET', 'Eloi', 2, 1, '2000-06-30'),
  (114, 'TEGANAHALLY SRIDHARA', 'Shrinidhi', 2, 11, '2000-08-12'),
  (115, 'SPITZER', 'Gian Luca', 2, 3, '2000-07-27'),
  (116, 'FONTAINE', 'Oscar', 2, 1, '2001-04-13'),
  (117, 'LE VAN', 'Loi', 2, NULL, '1990-10-06'),
  (118, 'BOURNEUF', 'Romain', 2, 1, '2000-10-15'),
  (119, 'BOUGHARIOU', 'Rima', 1, 20, '1999-09-27'),
  (120, 'HASSINI', 'Lamyae', 1, 18, '2001-02-05'),
  (121, 'RIGAUT', 'Coralie', 1, 1, '1999-11-18'),
  (122, 'CROSTA', 'Tomas', 2, 13, '1999-09-15'),
  (123, 'ZORN', 'Timothé', 2, 1, '2001-10-08'),
  (124, 'OUMAZIZ', 'Mohamed Ameziane', 2, 19, '1993-05-15'),
  (125, 'REY', 'Stéphanie', 1, 1, '1984-05-28'),
  (126, 'LAUMOND', 'Antoine', 2, 1, '1991-06-28'),
  (127, 'BELLOUM', 'Rafik', 2, 19, '1992-07-02'),
  (128, 'MONTOYA OBESO', 'Abraham', 3, 12, '1991-03-04'),
  (129, 'CHAABOUNI', 'Nadia', 1, 20, '1991-06-14'),
  (130, 'PASCALIE', 'Romain', 2, 1, '1993-12-10'),
  (131, 'MENDIBOURE', 'Léo', 2, 1, '1994-04-14'),
  (132, 'KARABOGHOSSIAN', 'Théo', 2, 1, '1993-06-08'),
  (133, 'DA SILVA', 'Simon', 2, 1, '1994-09-13'),
  (134, 'LACAUD', 'Mathias', 2, 1, '1993-03-19'),
  (135, 'ALAMI', 'Karim', 2, 18, '1990-09-12'),
  (136, 'HONORE', 'Valentin', 2, 1, '1991-10-11'),
  (137, 'STROCK', 'Anthony', 2, 1, '1994-10-03'),
  (138, 'PITTERI', 'Giorgia', 1, 4, '1991-05-22'),
  (139, 'ARCHIPOFF', 'Simon', 2, 1, '1986-01-02'),
  (140, 'FIRMO DRUMOND', 'Thalita', 1, 10, '1989-11-02'),
  (141, 'CASSAGNE', 'Adrien', 2, 1, '1989-02-02'),
  (142, 'BENMANSOUR', 'Tariq', 2, 19, '1982-01-11'),
  (143, 'APPRIOU', 'Aurélien', 2, 1, '1990-07-18'),
  (144, 'BILLY', 'Antoine', 2, 1, '1992-11-28'),
  (145, 'KSOURI', 'Chahrazed', 1, 1, '1990-12-03'),
  (146, 'MARTIN', 'Pierre-Etienne', 2, 1, '1993-02-19'),
  (147, 'ADERGHAL', 'Karim', 2, 18, '1988-08-02'),
  (148, 'BOSE', 'Sougata', 2, 11, '1994-11-24'),
  (150, 'OUVRARD', 'Paul', 2, 1, '1994-04-08'),
  (151, 'PAGLIARINI', 'Silvia', 1, 4, '1992-10-26'),
  (152, 'SCHOETERS', 'Jason', 2, 49, '1993-04-17'),
  (153, 'RAJANBABU', 'Govind', 2, 11, '1993-04-27'),
  (154, 'IBARBOURE', 'Sébastien', 2, 1, '1993-05-25'),
  (155, 'LENTZ', 'Antonin', 2, 1, '1992-07-16'),
  (156, 'BEAUDOUX', 'Vincent', 2, 1, '1988-01-05'),
  (157, 'CHEN', 'Wei', 2, 6, '1989-03-09'),
  (158, 'DAOUDI', 'Idriss', 3, 18, '1992-10-28'),
  (159, 'RUBIO PROANO', 'Andrés', 2, 54, '1989-11-24'),
  (160, 'BRUNEL', 'Camille', 1, 1, '1989-09-12'),
  (161, 'BOYER', 'Florian', 2, 1, '1991-05-01'),
  (162, 'LEVEAU', 'Julien', 2, 1, '1993-05-20'),
  (163, 'MARIE-MAGDELAINE', 'Nicolas', 2, 1, '1991-12-16'),
  (164, 'SHILOVA', 'Alena', 1, 8, '1994-06-19'),
  (165, 'SYLLA', 'Tidiane', 2, 34, '1987-06-08'),
  (166, 'BECHER', 'Cindy', 1, 1, '1994-12-11'),
  (167, 'LAJOU', 'Dimitri', 2, 1, '1994-08-31'),
  (168, 'BLANCHE', 'Alexandre', 2, 1, '1994-10-11'),
  (169, 'BEZIAU', 'Paul', 2, 1, '1995-08-30'),
  (170, 'BENAROCH', 'Camille', 1, 1, '1993-01-11'),
  (171, 'YEBDA', 'Thinhinane', 1, 19, '1994-08-10'),
  (172, 'VIDAL', 'Nicolas', 2, 1, '1993-02-07'),
  (173, 'ZOURE', 'Moubarak', 2, 35, '1995-03-20'),
  (174, 'PIRRONE', 'Antoine', 2, 1, '1994-08-23'),
  (175, 'RAMANATHAN', 'Varun', 2, 11, '1995-12-04'),
  (176, 'MARTIN', 'Vincent', 2, 1, '1996-02-05'),
  (177, 'REYNIER', 'Florian', 2, 1, '1994-10-25'),
  (178, 'LAUDONIO', 'Matteo', 3, 4, '1993-06-01'),
  (179, 'NARBONI', 'Jonathan', 3, 1, '1990-10-07'),
  (180, 'SLIMI', 'Anwer', 2, 20, '1996-02-10'),
  (181, 'CASTANET', 'Tobias', 2, 1, '1994-07-27'),
  (182, 'KORKMAZ', 'Esragul', 1, 51, '1992-01-21'),
  (183, 'MANIÈRE', 'Quentin', 2, 1, '1995-11-14'),
  (184, 'BRIERE', 'Marie-Galadriel', 1, 1, '1995-11-09'),
  (185, 'FEJER', 'Attila', 2, 46, '1991-01-25'),
  (186, 'AITKACI', 'Tassadit', 3, 19, '1990-07-09'),
  (187, 'SWARTVAGHER', 'Philippe', 2, 1, '1996-07-21'),
  (188, 'VERITE', 'Mathieu', 2, 1, '1989-08-27'),
  (189, 'XIANG', 'Yen-Fei', 1, 6, '1992-08-14'),
  (190, 'PEREZ DE SAN ROMAN', 'Philippe', 2, 1, '1991-11-19'),
  (191, 'IANNACITO', 'Martina', 1, 4, '1995-11-28'),
  (192, 'SANKAR', 'Remya', 1, 11, '1993-12-11'),
  (193, 'ROC', 'Aline', 1, 1, '1995-11-07'),
  (194, 'VU', 'Manh Tu', 2, 53, '1993-08-23'),
  (195, 'LION', 'Romain', 2, 1, '1994-12-17'),
  (196, 'KAO', 'Shih-shun', 2, 50, '1988-07-31'),
  (197, 'PORET', 'Maxime', 2, 1, '1994-04-14'),
  (198, 'REBY', 'Kevin', 2, 1, '1985-10-26'),
  (199, 'NGUYEN', 'Van Man', 2, 1, '1996-02-05'),
  (200, 'LALLIER', 'Corentin', 2, 1, '1981-11-29'),
  (201, 'KAMRAOUI', 'Reda Abdellah', 2, 19, '1995-09-07'),
  (202, 'LOPEZ', 'Myriam', 1, 1, '1993-11-29'),
  (203, 'ABOUABDALLAH', 'Mohamed Anwar', 2, 18, '1995-09-08'),
  (204, 'JOUANNEAU', 'Warren', 2, 1, '1991-01-19'),
  (205, 'MOHAMED EL MAAROUF', 'Aboul-Karim', 2, 1, '1993-06-06'),
  (206, 'FELSOCI', 'Marek', 2, 47, '1996-04-23'),
  (207, 'KORKMAZ', 'Kadir', 2, 51, '1989-04-15'),
  (208, 'KHATTABI RIFFI', 'Adnane', 2, 18, '1996-03-07'),
  (209, 'DAGAR', 'Snigdha', 2, 11, '1995-01-26'),
  (210, 'PERESSONI', 'Romain', 2, 1, '1996-12-01'),
  (211, 'BARJOU', 'Emile', 2, 1, '1996-01-29'),
  (212, 'HILAIRE', 'Claire', 1, 1, '1997-10-06'),
  (213, 'RYSBAYEVA', 'Korlan', 1, 55, '1993-09-26'),
  (214, 'COYE', 'Baptiste', 2, 1, '1992-06-30'),
  (215, 'VENKOVIC', 'Nicolas', 2, 1, '1986-02-22'),
  (216, 'RAHA', 'Ritam', 2, 11, '1996-07-04'),
  (217, 'CAUBET', 'Christophe', 2, 1, '1996-06-04'),
  (218, 'NADOR', 'Victor', 2, 1, '1996-03-01'),
  (219, 'LUCAS', 'Gwenolé', 2, 1, '1996-10-03'),
  (220, 'PAUL', 'Soumyajit', 2, 11, '1993-08-15'),
  (221, 'MALLICK', 'Rupayan', 2, 11, '1995-08-13'),
  (222, 'NGUYEN', 'Huy-Dung', 2, 53, '1995-09-17'),
  (223, 'GIOVANNANGELI', 'Loann', 2, 1, '1996-11-09'),
  (224, 'CASARES-SANTOS', 'Antonio', 2, 5, '1997-04-11'),
  (225, 'HYSENI', 'Fjola', 1, 48, '1995-05-11'),
  (226, 'MOUHOUB', 'Noureddine', 2, 19, '1995-07-19'),
  (227, 'ASSOR', 'Ambre', 1, 1, '1996-11-28'),
  (228, 'YACHEUR', 'Braddedine', 2, 19, '1996-03-25'),
  (229, 'KHAMARI', 'Sabri', 2, 19, '1995-01-31'),
  (230, 'GAVOILLE', 'Clément', 2, 1, '1998-08-16'),
  (231, 'CARRILLO LINDADO', 'Hernan Camilo', 2, 1, '1995-09-30'),
  (232, 'CHATEAU LAURENT', 'Hugo', 2, 1, '1996-09-15'),
  (233, 'KOVAL', 'Mogane', 1, 1, '1997-12-16'),
  (234, 'HALNAUT', 'Adrien', 2, 1, '1996-01-17'),
  (235, 'MERCIER', 'Chloé', 1, 1, '1994-02-16'),
  (236, 'GHNAYA', 'Imed', 2, 20, '1996-09-11'),
  (237, 'RACHEDI', 'Abdennour', 2, 19, '1995-06-23'),
  (238, 'OOTA', 'Subba Reddy', 2, 11, '1989-04-17'),
  (239, 'VANHATALO', 'Tara', 1, 30, '1995-08-17'),
  (240, 'CASSEAU', 'Christophe', 2, 1, '1970-02-21'),
  (241, 'LATAPPY', 'Corentin', 2, 1, '2000-11-28'),
  (242, 'LEGRAND', 'Clément', 2, 1, '1997-12-23'),
  (243, 'LEPSOVA', 'Jana', 1, NULL, '1995-01-17'),
  (244, 'YAKOVLEV', 'Ivan', 2, 57, '1997-11-17'),
  (245, 'AUVILLE', 'Asia', 1, 1, '2002-01-05'),
  (246, 'BIZIERE', 'Clotilde', 1, 1, '2000-02-19'),
  (247, 'BRUN', 'Anna-Louise', 1, 1, '2000-10-30'),
  (248, 'GHIGO', 'Vincent', 2, 1, '2000-12-09'),
  (249, 'GOEDEFROIT', 'Charles', 2, 1, '1998-09-30'),
  (250, 'MARCÉ', 'Taïssir', 1, 1, '2001-01-22'),
  (251, 'METUEKAM', 'Françoise', 1, 1, '1998-10-07'),
  (252, 'MOREL', 'Bastien', 2, 1, '2000-09-29'),
  (253, 'MUNHOZ PEREIRA FILHO', 'Vanderlei', 2, 1, '1993-03-27'),
  (254, 'NICOLAS', 'Brieuc', 2, 1, '2001-10-30'),
  (255, 'TROCHON', 'Méline', 1, 1, '2002-01-30'),
  (256, 'WALTHER', 'Dimitri', 2, 1, '2001-04-19'),
  (257, 'ZAMAI', 'Andrew', 2, 4, '2000-02-02'),
  (258, 'ZHU', 'Boyu', 2, 6, '1998-06-03'),
  (260, 'AMARI', 'Rafik', 2, 1, '1985-09-03'),
  (261, 'BAHI', 'Aref', 2, 1, '1999-07-13'),
  (262, 'CARRARD', 'Thierry', 2, 1, '1976-10-26'),
  (263, 'CHAMBRES', 'Gaëtan', 2, 1, '1994-07-15'),
  (264, 'CHAOUCHI', 'Aghiles', 2, 19, '1994-05-04'),
  (265, 'DAHAOUI', 'Ibrahim', 2, 19, '1993-02-23'),
  (266, 'DARBAR', 'Rajkumar', 2, 11, '1991-04-20'),
  (267, 'FOSSE', 'Rohan', 2, 1, '1995-10-08'),
  (268, 'GARRIGUES', 'Mathilde', 1, 1, '1991-06-04'),
  (269, 'GENAY', 'Adélaïde', 1, 1, '1996-04-15'),
  (270, 'GIRAUDEAU', 'Philippe', 2, 1, '1991-03-26'),
  (271, 'KAMBIRE', 'Sidoine', 1, 35, '1996-06-12'),
  (272, 'KAUSHIK', 'Pramod', 2, 11, '1990-06-22'),
  (273, 'LOPEZ', 'Angélique', 1, 1, '1998-01-31'),
  (274, 'LOPEZ-RODRIGUEZ', 'Mario', 2, 12, '1988-05-09'),
  (275, 'MAILLARD', 'Vimala', 1, 1, '1998-04-21'),
  (276, 'PADIOLLEAU', 'Guillaume', 2, 1, '1994-03-26'),
  (277, 'PREVOST', 'Adrien', 2, 1, '1992-09-09'),
  (278, 'RAPETTI', 'Alexandre', 2, 1, '1996-06-22'),
  (279, 'SCHLICK', 'Charlie', 2, 1, '1996-10-26'),
  (280, 'VERNAECKT', 'Pierre', 2, 1, '1982-09-16'),
  (281, 'WEBER', 'Axelle', 1, 1, '1996-01-18'),
  (282, 'ZRIGUI', 'Sarra', 1, 20, '1991-12-15'),
  (283, 'INCONNU', 'Inconnu', 2, 1, '2000-01-01')
)
INSERT INTO personnes (nom, prenom, sexe, nationalite, date_naissance)
SELECT dp.nom, dp.prenom, dp.sexe, dp.nationalite, dp.date_naissance::date
FROM doctorant_personnes dp
WHERE NOT EXISTS (
  SELECT 1 FROM personnes p
  WHERE p.nom = dp.nom
    AND p.prenom = dp.prenom
    AND (p.date_naissance IS NOT DISTINCT FROM dp.date_naissance::date)
);

INSERT INTO tutelles_laboratoires (id, laboratoire, etablissement) VALUES
  (1, 1, 3),  -- CNRS
  (2, 1, 1),  -- Université de Bordeaux
  (3, 1, 4)   -- Bordeaux INP
ON CONFLICT (id) DO NOTHING;

INSERT INTO structures_laboratoires_kind (id, nom) VALUES
  (1, 'departement'),
  (2, 'equipe'),
  (3, 'axe')
ON CONFLICT (id) DO NOTHING;

INSERT INTO structures_laboratoires (id, laboratoire, nom, acronyme, kind, structure_parent, date_creation) VALUES
  (1, 1, 'CombAlgo', 'CombAlgo', 1, NULL, '2021-01-01'),
  (2, 1, 'I&S', 'I&S', 1, NULL, '2021-01-01'),
  (3, 1, 'M2F', 'M2F', 1, NULL, '2021-01-01'),
  (4, 1, 'SATANAS', 'SATANAS', 1, NULL, '2021-01-01'),
  (5, 1, 'SeD', 'SeD', 1, NULL, '2021-01-01'),
  (6, 1, 'SAR', 'SAR', 1, NULL, '2021-01-01'),
  (7, 1, 'IA', 'IA', 3, NULL, '2021-01-01'),
  (8, 1, 'Santé Numérique', 'Santé Numérique', 3, NULL, '2021-01-01'),
  (9, 1, 'Combinatoire et Interactions', 'Combinatoire et Interactions', 2, 1, '2021-01-01'),
  (10, 1, 'Graphes et Optimisation', 'Graphes et Optimisation', 2, 1, '2021-01-01'),
  (11, 1, 'Algorithmique Distribuée', 'Algorithmique Distribuée', 2, 1, '2021-01-01'),
  (12, 1, 'Information et Calcul Quantique', 'Information et Calcul Quantique', 2, 1, '2021-01-01'),
  (13, 1, 'MANIOC', 'MANIOC', 2, 2, '2021-01-01'),
  (14, 1, 'Traitement et analyse de données', 'Traitement et analyse de données', 2, 2, '2021-01-01'),
  (15, 1, 'MTV', 'MTV', 2, 3, '2021-01-01'),
  (16, 1, 'LX', 'LX', 2, 3, '2021-01-01'),
  (17, 1, 'RATIO', 'RATIO', 2, 3, '2021-01-01'),
  (18, 1, 'DART', 'DART', 2, 3, '2021-01-01'),
  (19, 1, 'SYNTHESE', 'SYNTHESE', 2, 3, '2021-01-01'),
  (20, 1, 'STORM', 'STORM', 2, 4, '2021-01-01'),
  (21, 1, 'TADaaM', 'TADaaM', 2, 4, '2021-01-01'),
  (22, 1, 'TOPAL', 'TOPAL', 2, 4, '2021-01-01'),
  (23, 1, 'Progress', 'Progress', 2, 5, '2021-01-01'),
  (24, 1, 'BKB', 'BKB', 2, 5, '2021-01-01'),
  (25, 1, 'NeS', 'NeS', 2, 5, '2021-01-01'),
  (26, 1, 'Administration', 'Administration', 2, 6, '2021-01-01'),
  (27, 1, 'Finance', 'Finance', 2, 6, '2021-01-01'),
  (28, 1, 'Système', 'Système', 2, 6, '2021-01-01')
ON CONFLICT (id) DO NOTHING;

SELECT setval(pg_get_serial_sequence('sexes', 'id'), COALESCE(MAX(id), 1)) FROM sexes;
SELECT setval(pg_get_serial_sequence('nationalites', 'id'), COALESCE(MAX(id), 1)) FROM nationalites;
SELECT setval(pg_get_serial_sequence('laboratoires', 'id'), COALESCE(MAX(id), 1)) FROM laboratoires;
SELECT setval(pg_get_serial_sequence('personnes', 'id'), COALESCE(MAX(id), 1)) FROM personnes;
INSERT INTO affectations_structures_laboratoires (personne, structure_laboratoire, date_debut) VALUES
  (1, 4, '2010-01-01'),
  (2, 5, '2004-09-01'),
  (3, 3, '2012-02-01'),
  (4, 3, '2006-09-01'),
  (5, 5, '2018-10-01'),
  (6, 4, '2003-09-25'),
  (7, 1, '2004-10-01'),
  (8, 2, '2024-01-02'),
  (9, 2, '2012-09-01'),
  (10, 2, '2007-09-01'),
  (11, 4, '1998-09-01'),
  (12, 2, '2024-09-01'),
  (13, 1, '1997-01-01'),
  (14, 4, '2001-09-01'),
  (15, 2, '2013-09-01'),
  (16, 2, '2001-09-01'),
  (17, 5, '2023-09-01'),
  (18, 2, '1997-01-01'),
  (19, 1, '1997-01-01'),
  (20, 3, '2018-10-01'),
  (21, 3, '2018-10-01'),
  (22, 2, '2023-09-01'),
  (23, 3, '1999-01-01'),
  (24, 2, '1997-01-01'),
  (25, 5, '2010-09-01'),
  (26, 5, '2014-11-01'),
  (27, 5, '2005-09-01'),
  (28, 1, '2015-12-01'),
  (29, 1, '1999-12-01'),
  (30, 1, '2023-09-02'),
  (31, 5, '2023-09-01'),
  (32, 5, '2005-10-01'),
  (33, 1, '1990-01-01'),
  (34, 1, '2010-09-01'),
  (35, 2, '1997-01-01'),
  (36, 5, '2018-09-01'),
  (37, 5, '2010-09-01'),
  (38, 3, '1997-01-01'),
  (39, 1, '2012-09-01'),
  (40, 5, '1997-01-01'),
  (41, 2, '2018-09-01'),
  (42, 2, '2005-09-01'),
  (43, 5, '1993-09-01'),
  (44, 4, '2001-09-01'),
  (45, 4, '1997-01-01'),
  (46, 2, '2019-09-01'),
  (47, 3, '2023-09-01'),
  (48, 5, '2020-01-01'),
  (49, 5, '2021-10-01'),
  (50, 1, '2013-10-01'),
  (51, 1, '1998-09-01'),
  (52, 5, '1994-09-01'),
  (53, 4, '2004-10-01'),
  (54, 2, '1997-01-01'),
  (55, 2, '2002-09-01'),
  (56, 5, '2015-01-01'),
  (57, 2, '1997-01-01'),
  (58, 2, '2021-09-01'),
  (59, 1, '2020-12-01'),
  (60, 1, '1997-10-01'),
  (61, 5, '1997-01-01'),
  (62, 3, '1997-01-01'),
  (63, 5, '2005-09-01'),
  (64, 5, '1998-01-01'),
  (65, 4, '2006-09-01'),
  (66, 4, '2007-09-01'),
  (67, 5, '2010-09-01'),
  (68, 4, '2012-09-01'),
  (69, 3, '1997-01-01'),
  (70, 2, '1999-01-01'),
  (71, 3, '2014-10-01'),
  (72, 3, '2018-01-15'),
  (73, 3, '2019-01-14'),
  (74, 3, '2005-09-01'),
  (75, 5, '2020-01-01'),
  (76, 5, '2011-09-01'),
  (77, 1, '1996-01-01'),
  (78, 3, '2007-11-01'),
  (79, 5, '2013-09-01'),
  (80, 5, '2024-09-01'),
  (81, 4, '2009-09-01'),
  (82, 4, '2019-10-01'),
  (83, 2, '1997-01-01'),
  (84, 3, '2022-09-01'),
  (85, 3, '1997-01-01'),
  (86, 5, '2008-11-01'),
  (87, 2, '1997-01-01'),
  (88, 4, '2005-09-01'),
  (89, 4, '2022-09-01'),
  (90, 1, '1997-01-01'),
  (91, 2, '1997-01-01'),
  (93, 2, '2017-10-01'),
  (94, 1, '2023-09-04'),
  (95, 2, '2005-09-01'),
  (96, 1, '2001-10-01'),
  (97, 3, '2001-09-01'),
  (98, 3, '2024-09-01'),
  (99, 3, '2017-02-01'),
  (100, 1, '2009-09-01'),
  (101, 2, '2018-09-01'),
  (102, 1, '2023-09-05'),
  (103, 1, '2007-11-01'),
  (104, 2, '2022-09-01'),
  (105, 3, '1996-09-01'),
  (106, 2, '2021-09-01'),
  (107, 4, '1999-10-18'),
  (108, 1, '2008-09-01'),
  (109, 5, '2008-11-20'),
  (110, 1, '2012-09-01'),
  (111, 1, '2005-11-01'),
  (112, 5, '1993-09-01'),
  (113, 1, '2017-01-01'),
  (114, 3, '2023-09-01'),
  (115, 5, '2024-09-01'),
  (116, 5, '2016-09-01'),
  (117, 3, '1998-01-01'),
  (118, 1, '2005-10-01'),
  (119, 2, '2016-09-01'),
  (120, 3, '2015-09-01'),
  (121, 4, '2021-09-01'),
  (122, 3, '2012-09-01'),
  (123, 2, '2019-10-01'),
  (124, 3, '1997-01-01'),
  (125, 3, '1998-08-01'),
  (126, 5, '2008-09-01'),
  (127, 1, '2005-10-01'),
  (128, 1, '2006-09-01'),
  (129, 5, '2007-01-01'),
  (130, 4, '2006-09-01'),
  (131, 1, '1997-01-02'),
  (132, 1, '2010-09-01'),
  (133, 5, '2012-09-01'),
  (134, 3, '1993-10-01'),
  (135, 3, '2006-09-01'),
  (136, 4, '2002-09-01'),
  (137, 1, '1997-01-01'),
  (138, 5, '2007-09-01'),
  (139, 2, '2005-09-01'),
  (140, 4, '2016-09-01'),
  (141, 3, '2013-11-01'),
  (142, 3, '2018-10-01'),
  (143, 1, '2002-09-01'),
  (144, 4, '1997-01-01'),
  (145, 3, '2017-09-01'),
  (146, 5, '2008-09-01'),
  (147, 3, '2012-09-01'),
  (148, 4, '2021-01-01'),
  (149, 2, '2021-09-01'),
  (150, 5, '2015-09-01'),
  (151, 3, '2024-09-01'),
  (152, 4, '1997-01-01'),
  (153, 1, '2022-09-01'),
  (154, 3, '2005-09-01'),
  (155, 2, '2006-09-01'),
  (156, 5, '2017-10-01'),
  (157, 5, '2023-02-01'),
  (158, 2, '2011-09-01'),
  (159, 3, '2005-09-01'),
  (160, 2, '2010-09-01'),
  (161, 3, '2013-09-01'),
  (162, 4, '2017-12-01'),
  (163, 2, '1997-01-01'),
  (164, 5, '1997-01-01'),
  (165, 3, '2013-09-01'),
  (166, 1, '1997-01-01'),
  (167, 2, '1997-01-01'),
  (168, 3, '2001-10-01'),
  (169, 4, '2023-09-03'),
  (170, 2, '2010-09-01'),
  (171, 1, '2015-09-01'),
  (172, 4, '2023-10-01'),
  (173, 5, '2007-09-01'),
  (174, 4, '2008-09-01'),
  (175, 1, '2010-09-01'),
  (176, 5, '2012-09-01'),
  (177, 2, '1997-01-01'),
  (178, 3, '2012-01-01'),
  (179, 4, '1997-01-01'),
  (180, 3, '2001-10-01'),
  (181, 3, '2004-08-01'),
  (182, 4, '2019-09-01'),
  (183, 3, '2005-09-01'),
  (184, 1, '2001-09-01'),
  (185, 1, '2000-01-01'),
  (186, 5, '2022-01-01'),
  (188, 6, '2020-09-01'),
  (189, 6, '2013-10-14'),
  (190, 6, '2004-12-01'),
  (191, 6, '2012-10-01'),
  (192, 4, '2005-02-01'),
  (193, 6, '2015-12-01'),
  (194, 6, '2024-12-01'),
  (195, 6, '2011-10-01'),
  (196, 6, '2020-01-01'),
  (197, 6, '2006-12-01'),
  (198, 6, '2016-12-01'),
  (199, 6, '2009-10-01'),
  (200, 5, '2012-07-02'),
  (201, 6, '2024-01-08'),
  (202, 6, '2011-05-01'),
  (203, 6, '2011-01-01'),
  (204, 6, '2016-09-01'),
  (205, 2, '2004-12-01'),
  (206, 5, '2006-12-01'),
  (207, 6, '2015-09-01'),
  (208, 6, '2007-08-01'),
  (209, 6, '2019-07-01'),
  (210, 3, '2002-08-01'),
  (211, 6, '2004-04-01'),
  (212, 6, '1998-07-01'),
  (213, 1, '2023-01-01'),
  (214, 2, '2019-04-01'),
  (215, 1, '2019-09-01'),
  (216, 5, '2018-02-01'),
  (217, 6, '2024-11-15'),
  (218, 3, '2024-12-02'),
  (219, 3, '2024-10-01'),
  (220, 3, '2024-01-01'),
  (221, 2, '2023-09-04'),
  (222, 3, '2022-11-01'),
  (223, 1, '2020-10-01'),
  (224, 1, '2023-11-01'),
  (225, 6, '2016-12-12'),
  (226, 1, '2020-09-10'),
  (227, 5, '2020-12-01'),
  (228, 3, '2021-02-12'),
  (229, 5, '2021-11-01'),
  (230, 6, '2022-06-01'),
  (231, 5, '2019-10-01'),
  (232, 1, '2019-11-15'),
  (233, 3, '2018-01-15'),
  (234, 6, '2024-04-02'),
  (235, 1, '2020-09-01'),
  (236, 2, '2024-10-01'),
  (237, 4, '2020-11-01'),
  (238, 2, '2024-10-01'),
  (239, 3, '2023-04-03'),
  (240, 1, '2019-09-01'),
  (241, 6, '2024-11-01'),
  (242, 2, '2024-10-01'),
  (243, 5, '2024-10-15'),
  (244, 3, '2024-10-01'),
  (245, 3, '2020-02-02'),
  (246, 3, '2021-03-01'),
  (247, 4, '2022-07-01'),
  (248, 5, '2022-10-01'),
  (249, 2, '2019-02-01'),
  (250, 2, '2017-09-01'),
  (251, 3, '2024-09-01'),
  (252, 3, '2024-10-01'),
  (253, 2, '2023-02-01'),
  (254, 3, '2017-09-01'),
  (255, 3, '2014-10-01'),
  (256, 6, '2007-10-01'),
  (257, 6, '2023-09-15'),
  (259, 1, '2018-09-01'),
  (260, 5, '2021-01-01'),
  (261, 5, '2021-09-01'),
  (262, 2, '2023-02-01'),
  (263, 5, '2024-09-01'),
  (264, 5, '2016-04-01'),
  (265, 6, '2018-05-28'),
  (266, 3, '2023-11-01'),
  (267, 5, '2020-09-01'),
  (268, 1, '2020-10-01'),
  (269, 1, '2020-10-01'),
  (270, 5, '2022-10-01'),
  (271, 2, '2021-10-01'),
  (272, 5, '2019-11-01'),
  (273, 3, '2024-09-01'),
  (274, 5, '2021-11-01'),
  (275, 5, '2016-05-23'),
  (276, 5, '2021-09-01'),
  (277, 2, '2017-10-01'),
  (278, 2, '2018-10-15'),
  (279, 6, '2021-03-15'),
  (280, 2, '2019-10-01'),
  (281, 5, '2000-01-01'),
  (282, 3, '2024-10-01'),
  (283, 1, '2019-09-01'),
  (284, 3, '2022-12-01'),
  (285, 6, '2020-09-01'),
  (286, 5, '2018-10-15'),
  (287, 3, '2024-04-01'),
  (288, 5, '2013-10-01'),
  (289, 3, '2023-10-01'),
  (290, 5, '2023-07-01'),
  (291, 2, '2019-11-04'),
  (292, 1, '2023-11-01'),
  (293, 2, '2018-10-15'),
  (294, 2, '2021-12-01'),
  (295, 3, '1997-01-01'),
  (296, 1, '2000-01-01')
ON CONFLICT DO NOTHING;

WITH doctorant_affectations (nom, prenom, date_naissance, departement, date_debut) AS (
VALUES
  ('ABOUABDALLAH', 'Mohamed Anwar', '1995-09-08', 4, '2019-10-01'),
  ('ADERGHAL', 'Karim', '1988-08-02', 2, '2016-03-01'),
  ('AITKACI', 'Tassadit', '1990-07-09', 4, '2019-02-01'),
  ('ALAMI', 'Karim', '1990-09-12', 5, '2017-10-01'),
  ('ALBA', 'Vincent', '1996-09-26', 4, '2022-09-01'),
  ('AMARI', 'Rafik', '1985-09-03', 2, '2022-01-01'),
  ('ANDRIANTSOAMBEROMANGA', 'Maeva', '1998-09-06', 3, '2022-10-01'),
  ('APPRIOU', 'Aurélien', '1990-07-18', 2, '2017-10-01'),
  ('ARCHIPOFF', 'Simon', '1986-01-02', 3, '2015-10-01'),
  ('ASLOUDJ', 'Yanis', '2000-07-04', 5, '2022-10-01'),
  ('ASSOR', 'Ambre', '1996-11-28', 2, '2020-10-01'),
  ('AUVILLE', 'Asia', '2002-01-05', 4, '2024-10-01'),
  ('AWUKLU', 'Kokou-Yvon', '1993-01-13', 3, '2022-10-01'),
  ('AYYAR', 'Meghna Parameswaran', '1996-08-07', 2, '2022-10-01'),
  ('BAHI', 'Aref', '1999-07-13', 2, '2024-09-01'),
  ('BANDET', 'Alexis', '1995-06-15', 4, '2021-09-01'),
  ('BARJOU', 'Emile', '1996-01-29', 2, '2019-10-01'),
  ('BASTIDE', 'Paul', '1999-06-28', 1, '2022-09-01'),
  ('BATHIE', 'Gabriel', '1998-07-03', 3, '2022-09-01'),
  ('BAUCHER', 'Edgar', '2000-05-26', 1, '2023-09-01'),
  ('BEAUDOUX', 'Vincent', '1988-01-05', 5, '2017-05-20'),
  ('BEAUMARD', 'Colleen', '1997-06-02', 2, '2022-10-01'),
  ('BECHER', 'Cindy', '1994-12-11', 2, '2018-09-01'),
  ('BELLOUM', 'Rafik', '1992-07-02', 4, '2017-05-01'),
  ('BENAROCH', 'Camille', '1993-01-11', 2, '2018-10-01'),
  ('BENDI-OUIS', 'Yannis', '1995-04-25', 3, '2023-10-01'),
  ('BENMANSOUR', 'Tariq', '1982-01-11', 5, '2015-03-01'),
  ('BEZIAU', 'Paul', '1995-08-30', 4, '2018-11-01'),
  ('BILLY', 'Antoine', '1992-11-28', 2, '2017-05-01'),
  ('BINET', 'Anaïs', '1999-12-22', 2, '2022-09-01'),
  ('BIZIERE', 'Clotilde', '2000-02-19', 3, '2024-09-01'),
  ('BLANCHE', 'Alexandre', '1994-10-11', 1, '2018-09-01'),
  ('BONNET', 'Pierre', '1998-05-18', 1, '2022-09-01'),
  ('BOSE', 'Sougata', '1994-11-24', 3, '2017-10-01'),
  ('BOUGHARIOU', 'Rima', '1999-09-27', 3, '2024-09-01'),
  ('BOURNEUF', 'Romain', '2000-10-15', 1, '2024-09-01'),
  ('BOYER', 'Florian', '1991-05-01', 2, '2017-05-01'),
  ('BRASSART', 'Mathieu', '2000-12-11', 3, '2023-11-01'),
  ('BRIERE', 'Marie-Galadriel', '1995-11-09', 5, '2019-10-01'),
  ('BRUN', 'Anna-Louise', '2000-10-30', 2, '2024-10-01'),
  ('BRUNEL', 'Camille', '1989-09-12', 2, '2017-12-01'),
  ('CALLUAUD', 'Abel', '1997-08-16', 4, '2022-10-03'),
  ('CAM', 'Tristan', '2000-08-30', 1, '2024-03-04'),
  ('CARRARD', 'Thierry', '1976-10-26', 4, '2003-07-28'),
  ('CARRILLO LINDADO', 'Hernan Camilo', '1995-09-30', 2, '2020-10-01'),
  ('CASAMAYOU', 'Vincent', '1996-05-29', 2, '2022-10-01'),
  ('CASARES-SANTOS', 'Antonio', '1997-04-11', 3, '2020-10-01'),
  ('CASSAGNE', 'Adrien', '1989-02-02', 4, '2017-10-01'),
  ('CASSEAU', 'Christophe', '1970-02-21', 5, '2019-11-01'),
  ('CASTANET', 'Tobias', '1994-07-27', 4, '2018-09-01'),
  ('CAUBET', 'Christophe', '1996-06-04', 2, '2019-11-18'),
  ('CHAABOUNI', 'Nadia', '1991-06-14', 3, '2017-06-01'),
  ('CHAIX-EICHEL', 'Naomi', '1996-06-11', 3, '2021-10-01'),
  ('CHAMBRES', 'Gaëtan', '1994-07-15', 2, '2018-09-01'),
  ('CHAOUCHI', 'Aghiles', '1994-05-04', 5, '2018-12-01'),
  ('CHATEAU LAURENT', 'Hugo', '1996-09-15', 3, '2020-11-01'),
  ('CHEN', 'Wei', '1989-03-09', 5, '2016-07-26'),
  ('CIORNA', 'Vasile', '1990-02-11', 5, '2020-06-01'),
  ('CLAUDE', 'Elsa', '1997-11-04', 5, '2021-10-01'),
  ('COLAJANNI', 'Antonin', '2000-05-25', 5, '2023-09-01'),
  ('CORSINI', 'Timothée', '1997-06-20', 1, '2021-09-01'),
  ('COYE', 'Baptiste', '1992-06-30', 4, '2020-04-01'),
  ('CROSTA', 'Tomas', '1999-09-15', 1, '2024-09-01'),
  ('D''AVIAU DE PIOLANT', 'Albert', '2000-03-16', 4, '2023-10-01'),
  ('DA SILVA', 'Simon', '1994-09-13', 5, '2017-10-01'),
  ('DAGAR', 'Snigdha', '1995-01-26', 3, '2019-12-01'),
  ('DAHAOUI', 'Ibrahim', '1993-02-23', 1, '2020-02-01'),
  ('DAOUDI', 'Idriss', '1992-10-28', 4, '2018-10-01'),
  ('DARBAR', 'Rajkumar', '1991-04-20', 2, '2017-12-01'),
  ('DARDOUR', 'Mayssa', '1997-10-26', 3, '2022-04-01'),
  ('DAVID', 'Jean-François', '1993-07-08', 4, '2021-09-01'),
  ('DE CASTRO PINTO', 'Théo', '1998-07-25', 3, '2022-03-01'),
  ('DELPY', 'Romain', '2000-04-06', 3, '2023-09-01'),
  ('DREYER', 'Pauline', '1993-03-05', 2, '2023-10-01'),
  ('DUCLUSAUD', 'Marc', '1998-01-28', 3, '2022-10-01'),
  ('DULAU', 'Idris', '1999-01-19', 2, '2022-09-01'),
  ('ECHEZARRETA ARRUTI', 'Ander', '1998-04-20', 2, '2024-01-02'),
  ('ECONOMIDES', 'Marie', '1995-12-28', 2, '2020-12-14'),
  ('EVEN', 'Melvin', '1998-02-08', 2, '2021-10-01'),
  ('FACCI', 'Aurélien', '2000-05-28', 5, '2023-10-01'),
  ('FEJER', 'Attila', '1991-01-25', 2, '2018-10-01'),
  ('FELSOCI', 'Marek', '1996-04-23', 4, '2019-10-01'),
  ('FERRON', 'Aymeric', '1999-03-19', 2, '2023-03-01'),
  ('FIRMO DRUMOND', 'Thalita', '1989-11-02', 3, '2017-10-01'),
  ('FONTAINE', 'Lucie', '1999-06-23', 3, '2023-10-01'),
  ('FONTAINE', 'Oscar', '2001-04-13', 1, '2024-09-01'),
  ('FOSSE', 'Rohan', '1995-10-08', 3, '2017-11-15'),
  ('FOURNEAU', 'Gary', '1999-07-02', 2, '2021-10-01'),
  ('FUCCELLARO', 'Maxime', '1995-06-08', 1, '2021-01-01'),
  ('GARRIGUES', 'Mathilde', '1991-06-04', 5, '2020-01-06'),
  ('GASPARD', 'Clément', '1998-05-04', 3, '2022-09-01'),
  ('GAVOILLE', 'Clément', '1998-08-16', 4, '2021-01-01'),
  ('GEBRESLASSIE', 'Abel Kahsay', '1995-08-07', 5, '2022-10-01'),
  ('GENAY', 'Adélaïde', '1996-04-15', 2, '2019-10-01'),
  ('GHASSEMI NEJDAD', 'Chabname', '1989-06-18', 3, '2022-10-01'),
  ('GHIGO', 'Vincent', '2000-12-09', 3, '2024-10-01'),
  ('GHNAYA', 'Imed', '1996-09-11', 3, '2021-03-01'),
  ('GIOVANNANGELI', 'Loann', '1996-11-09', 5, '2020-10-01'),
  ('GIRAUDEAU', 'Philippe', '1991-03-26', 2, '2017-10-01'),
  ('GOEDEFROIT', 'Charles', '1998-09-30', 4, '2024-03-01'),
  ('GROS CHAUVERGNE', 'Edwige', '1996-02-19', 2, '2021-10-01'),
  ('GUERRIERI', 'Pierre-Loup', '1999-10-27', 5, '2024-03-01'),
  ('GUEVARA GARBAN', 'Manuel', '1997-01-15', 2, '2022-10-01'),
  ('HALNAUT', 'Adrien', '1996-01-17', 5, '2019-10-01'),
  ('HASSINI', 'Lamyae', '2001-02-05', 5, '2024-10-01'),
  ('HILAIRE', 'Claire', '1997-10-06', 1, '2020-10-01'),
  ('HILAIRE', 'Thibault', '1997-02-26', 3, '2021-09-01'),
  ('HONORE', 'Valentin', '1991-10-11', 4, '2017-11-01'),
  ('HOUZELOT', 'Agathe', '1997-10-11', 1, '2020-10-05'),
  ('HUBNER', 'Nicolas', '2000-11-14', 5, '2023-10-01'),
  ('HYSENI', 'Fjola', '1995-05-11', 3, '2020-10-01'),
  ('IANNACITO', 'Martina', '1995-11-28', 4, '2019-10-01'),
  ('IBARBOURE', 'Sébastien', '1993-05-25', 2, '2018-01-01'),
  ('IBRAHIM', 'Aïda', '1995-01-25', 3, '2021-04-01'),
  ('INCONNU', 'Inconnu', '2000-01-01', 1, '2024-01-01'),
  ('JABALLI', 'Samawel', '1997-08-29', 2, '2023-01-01'),
  ('JACQUES', 'Amaury', '1996-06-10', 1, '2022-10-01'),
  ('JEAN', 'Robin', '1999-10-18', 3, '2023-10-03'),
  ('JEGOUREL', 'Adrien', '1998-08-01', 5, '2022-03-21'),
  ('JOLICOEUR', 'Lise', '1999-07-18', 4, '2022-11-01'),
  ('JOUANNEAU', 'Warren', '1991-01-19', 2, '2020-01-14'),
  ('KAMBIRE', 'Sidoine', '1996-06-12', 5, '2019-11-15'),
  ('KAMRAOUI', 'Reda Abdellah', '1995-09-07', 2, '2019-11-01'),
  ('KAO', 'Shih-shun', '1988-07-31', 1, '2019-09-01'),
  ('KARABOGHOSSIAN', 'Théo', '1993-06-08', 1, '2017-09-01'),
  ('KAUSHIK', 'Pramod', '1990-06-22', 3, '2018-10-01'),
  ('KHAMARI', 'Sabri', '1995-01-31', 3, '2020-03-01'),
  ('KHATTABI RIFFI', 'Adnane', '1996-03-07', 1, '2019-11-01'),
  ('KORKMAZ', 'Esragul', '1992-01-21', 4, '2018-11-01'),
  ('KORKMAZ', 'Kadir', '1989-04-15', 5, '2019-11-15'),
  ('KOVAL', 'Mogane', '1997-12-16', 2, '2020-02-01'),
  ('KSOURI', 'Chahrazed', '1990-12-03', 5, '2016-09-01'),
  ('LA ROCCA', 'Pierre', '1998-05-22', 5, '2022-10-19'),
  ('LAAROUSSI', 'Oussama', '1995-10-17', 2, '2022-01-01'),
  ('LACAUD', 'Mathias', '1993-03-19', 5, '2017-08-01'),
  ('LAFOURCADE', 'Pierre', '1999-12-17', 3, '2023-09-01'),
  ('LAJOU', 'Dimitri', '1994-08-31', 1, '2018-09-01'),
  ('LALLIER', 'Corentin', '1981-11-29', 5, '2019-10-01'),
  ('LARROZE-JARDINÉ', 'Sarah', '1998-07-01', 3, '2021-10-01'),
  ('LASSALLE-ASTIS', 'Nina', '1998-04-09', 2, '2023-02-01'),
  ('LASSERRE', 'Alice', '1999-12-16', 4, '2022-09-01'),
  ('LATAPPY', 'Corentin', '2000-11-28', 5, '2021-07-15'),
  ('LAUDONIO', 'Matteo', '1993-06-01', 1, '2018-10-01'),
  ('LAUMOND', 'Antoine', '1991-06-28', 5, '2016-04-01'),
  ('LE BOT', 'Edern', '1998-10-01', 2, '2022-10-01'),
  ('LE MEUDEC', 'Juliette', '2001-05-21', 2, '2023-10-01'),
  ('LE VAN', 'Loi', '1990-10-06', 5, '2024-09-01'),
  ('LECOMTE', 'Maxime', '1996-02-22', 5, '2020-11-01'),
  ('LEGRAND', 'Clément', '1997-12-23', 1, '2021-09-01'),
  ('LENTZ', 'Antonin', '1992-07-16', 1, '2017-11-01'),
  ('LEPSOVA', 'Jana', '1995-01-17', 1, '2020-10-01'),
  ('LEVEAU', 'Julien', '1993-05-20', 5, '2018-05-01'),
  ('LION', 'Romain', '1994-12-17', 4, '2018-10-01'),
  ('LIRA NUNES', 'Alan', '1992-11-09', 4, '2023-03-01'),
  ('LISITO', 'Alycia', '1999-09-13', 4, '2024-01-01'),
  ('LONGUEFOSSE', 'Arthur', '1996-08-19', 2, '2021-10-01'),
  ('LOPEZ', 'Angélique', '1998-01-31', 5, '2021-09-06'),
  ('LOPEZ', 'Myriam', '1993-11-29', 2, '2018-07-01'),
  ('LOPEZ-RODRIGUEZ', 'Mario', '1988-05-09', 2, '2022-02-01'),
  ('LUCAS', 'Gwenolé', '1996-10-03', 4, '2019-11-01'),
  ('LUCAS', 'Simon', '2000-09-13', 2, '2021-10-01'),
  ('MAGANA LOPEZ', 'Gustavo', '1996-08-06', 3, '2022-09-01'),
  ('MAILLARD', 'Vimala', '1998-04-21', 1, '2023-10-01'),
  ('MALLICK', 'Rupayan', '1995-08-13', 2, '2020-10-01'),
  ('MANIÈRE', 'Quentin', '1995-11-14', 3, '2019-10-01'),
  ('MARCILLE', 'Clara', '1999-07-05', 1, '2022-09-01'),
  ('MARCÉ', 'Taïssir', '2001-01-22', 1, '2024-10-09'),
  ('MARIE-MAGDELAINE', 'Nicolas', '1991-12-16', 5, '2017-07-01'),
  ('MARISSENS CUEVA', 'Valérie', '1999-05-07', 2, '2023-12-01'),
  ('MARLIER', 'Maudeline', '1998-10-28', 2, '2022-05-10'),
  ('MARTIN', 'Pierre-Etienne', '1993-02-19', 2, '2017-11-01'),
  ('MARTIN', 'Vincent', '1996-02-05', 2, '2019-10-01'),
  ('MASCLE', 'Corto', '1998-11-17', 3, '2021-09-01'),
  ('MATRICON', 'Théo', '1997-10-24', 3, '2021-10-01'),
  ('MELGAR FERNANDEZ', 'Raquel', '2000-01-29', 1, '2024-02-01'),
  ('MENDIBOURE', 'Léo', '1994-04-14', 5, '2018-01-01'),
  ('MERCIER', 'Chloé', '1994-02-16', 3, '2020-10-01'),
  ('METUEKAM', 'Françoise', '1998-10-07', 5, '2024-10-01'),
  ('MOHAMED EL MAAROUF', 'Aboul-Karim', '1993-06-06', 4, '2020-03-01'),
  ('MONCE', 'Gustave', '1999-12-29', 5, '2022-10-01'),
  ('MONTOYA OBESO', 'Abraham', '1991-03-04', 2, '2017-02-01'),
  ('MOREL', 'Bastien', '2000-09-29', 2, '2024-10-01'),
  ('MOREL', 'Nicolas', '1999-07-07', 5, '2023-11-01'),
  ('MORIN', 'Ludovic', '1996-10-29', 1, '2022-09-01'),
  ('MORIN', 'Thomas', '1999-11-17', 4, '2023-10-01'),
  ('MORVAN', 'Rémi', '1997-12-12', 3, '2021-09-01'),
  ('MOUHOUB', 'Noureddine', '1995-07-19', 5, '2019-10-01'),
  ('MOULIE', 'Gabin', '1996-05-29', 2, '2023-02-01'),
  ('MUKAM', 'Augusta', '2000-04-29', 5, '2022-10-15'),
  ('MULLER', 'Thomas', '1999-07-13', 1, '2022-09-01'),
  ('MUNHOZ PEREIRA FILHO', 'Vanderlei', '1993-03-27', 4, '2024-12-01'),
  ('NADOR', 'Victor', '1996-03-01', 1, '2020-10-01'),
  ('NAQUIN', 'Emile', '1999-05-03', 1, '2023-09-01'),
  ('NARBONI', 'Jonathan', '1990-10-07', 1, '2019-10-01'),
  ('NAVET', 'Eloi', '2000-06-30', 2, '2024-10-01'),
  ('NGUYEN', 'Huy-Dung', '1995-09-17', 2, '2020-10-01'),
  ('NGUYEN', 'Van Man', '1996-02-05', 4, '2019-11-01'),
  ('NICOLAS', 'Brieuc', '2001-10-30', 4, '2024-10-01'),
  ('OOTA', 'Subba Reddy', '1989-04-17', 3, '2020-11-01'),
  ('ORHAN', 'Diane', '1997-11-25', 4, '2022-09-01'),
  ('OUMAZIZ', 'Mohamed Ameziane', '1993-05-15', 5, '2016-09-01'),
  ('OUVRARD', 'Paul', '1994-04-08', 1, '2017-10-01'),
  ('PADIOLLEAU', 'Guillaume', '1994-03-26', 3, '2018-09-10'),
  ('PAGLIARINI', 'Silvia', '1992-10-26', 3, '2017-11-01'),
  ('PALAUDE', 'Axel', '1998-10-03', 3, '2021-10-01'),
  ('PASCALIE', 'Romain', '1993-12-10', 1, '2017-09-01'),
  ('PAUL', 'Soumyajit', '1993-08-15', 3, '2018-09-01'),
  ('PELLETIER', 'Fabien', '1999-07-15', 2, '2023-10-01'),
  ('PEPIN', 'Thibaut', '1997-03-09', 4, '2023-03-15'),
  ('PERESSONI', 'Romain', '1996-12-01', 4, '2019-10-15'),
  ('PEREZ DE SAN ROMAN', 'Philippe', '1991-11-19', 2, '2017-06-01'),
  ('PESQUET', 'Baptiste', '1976-11-26', 3, '2023-10-18'),
  ('PICAVET', 'Timothé', '2000-04-24', 1, '2024-09-01'),
  ('PIRRONE', 'Antoine', '1994-08-23', 2, '2018-12-01'),
  ('PITTERI', 'Giorgia', '1991-05-22', 2, '2017-11-15'),
  ('POMME-CASSIEROU', 'Luc-Etienne', '1997-04-19', 5, '2020-11-01'),
  ('PORET', 'Maxime', '1994-04-14', 2, '2019-10-01'),
  ('PREVOST', 'Adrien', '1992-09-09', 3, '2018-01-02'),
  ('RACHEDI', 'Abdennour', '1995-06-23', 5, '2019-10-21'),
  ('RAHA', 'Ritam', '1996-07-04', 3, '2019-10-01'),
  ('RAIS', 'Sylvain', '2000-06-11', 3, '2023-10-02'),
  ('RAJANBABU', 'Govind', '1993-04-27', 3, '2017-11-01'),
  ('RAMANATHAN', 'Varun', '1995-12-04', 3, '2018-09-01'),
  ('RAPETTI', 'Alexandre', '1996-06-22', 1, '2020-11-16'),
  ('REBY', 'Kevin', '1985-10-26', 2, '2019-09-03'),
  ('REY', 'Stéphanie', '1984-05-28', 2, '2017-03-01'),
  ('REYNIER', 'Florian', '1994-10-25', 4, '2019-01-14'),
  ('RICHARD', 'Sébastien', '1999-04-11', 2, '2023-09-01'),
  ('RICHEFORT', 'Clément', '1998-12-05', 4, '2021-10-13'),
  ('RIGAUT', 'Coralie', '1999-11-18', 2, '2024-10-01'),
  ('RIXTE', 'Alice', '1996-04-10', 3, '2022-09-01'),
  ('ROC', 'Aline', '1995-11-07', 2, '2019-09-01'),
  ('RODRIGUEZ', 'Julien', '1996-03-04', 4, '2020-10-14'),
  ('RONCALLI', 'Théo', '1997-01-20', 3, '2023-10-01'),
  ('RUBIO PROANO', 'Andrés', '1989-11-24', 4, '2018-10-01'),
  ('RYSBAYEVA', 'Korlan', '1993-09-26', 5, '2019-12-01'),
  ('SANKAR', 'Remya', '1993-12-11', 3, '2018-10-01'),
  ('SARTORI', 'Richard', '1997-03-22', 4, '2021-04-15'),
  ('SCHABANEL', 'Juliette', '2000-02-09', 1, '2024-09-01'),
  ('SCHLICK', 'Charlie', '1996-10-26', 2, '2019-10-01'),
  ('SCHOETERS', 'Jason', '1993-04-17', 1, '2017-11-01'),
  ('SCRAVAGLIERI', 'Lana', '1998-04-23', 4, '2022-11-01'),
  ('SHILOVA', 'Alena', '1994-06-19', 4, '2018-10-08'),
  ('SLIMI', 'Anwer', '1996-02-10', 2, '2020-01-01'),
  ('SPITZER', 'Gian Luca', '2000-07-27', 1, '2024-12-01'),
  ('STROCK', 'Anthony', '1994-10-03', 3, '2017-09-01'),
  ('SWARTVAGHER', 'Philippe', '1996-07-21', 4, '2019-10-01'),
  ('SWESSI', 'Rania', '1999-01-11', 3, '2023-04-01'),
  ('SYLLA', 'Tidiane', '1987-06-08', 5, '2018-10-01'),
  ('TAHIRI', 'Mohamed', '2000-11-04', 2, '2023-11-01'),
  ('TAYEB', 'Hayfa', '1997-10-23', 4, '2021-11-01'),
  ('TEGANAHALLY SRIDHARA', 'Shrinidhi', '2000-08-12', 1, '2024-10-01'),
  ('TROCELLIER', 'David', '1997-12-09', 2, '2021-10-01'),
  ('TROCHON', 'Méline', '2002-01-30', 4, '2024-11-01'),
  ('TROUVAIN', 'Nathan', '1998-01-05', 3, '2022-10-01'),
  ('TSIAPKOLIS', 'Panagiotis', '1997-06-12', 2, '2022-01-17'),
  ('VANHATALO', 'Tara', '1995-08-17', 2, '2021-06-28'),
  ('VARIN', 'Zoé', '1998-07-13', 1, '2022-09-01'),
  ('VENKOVIC', 'Nicolas', '1986-02-22', 4, '2018-10-01'),
  ('VERDON', 'Elia', '1997-04-02', 4, '2021-10-01'),
  ('VERITE', 'Mathieu', '1989-08-27', 4, '2019-09-01'),
  ('VERNAECKT', 'Pierre', '1982-09-16', 5, '2020-10-05'),
  ('VIDAL', 'Nicolas', '1993-02-07', 4, '2018-10-01'),
  ('VINAYAGAME', 'Radjasouria', '1998-07-03', 4, '2022-12-01'),
  ('VU', 'Manh Tu', '1993-08-23', 2, '2019-11-04'),
  ('WALTHER', 'Dimitri', '2001-04-19', 4, '2024-10-01'),
  ('WEBER', 'Axelle', '1996-01-18', 5, '2019-11-12'),
  ('WELTER', 'Marc', '1989-06-29', 2, '2022-02-01'),
  ('XIANG', 'Yen-Fei', '1992-08-14', 4, '2019-11-01'),
  ('YACHEUR', 'Braddedine', '1996-03-25', 5, '2020-10-01'),
  ('YAKOVLEV', 'Ivan', '1997-11-17', 1, '2021-09-01'),
  ('YEBDA', 'Thinhinane', '1994-08-10', 2, '2018-11-08'),
  ('ZAMAI', 'Andrew', '2000-02-02', 2, '2024-10-01'),
  ('ZHAO', 'Xunyi', '1997-01-08', 4, '2021-09-01'),
  ('ZHU', 'Boyu', '1998-06-03', 5, '2024-12-02'),
  ('ZHUKOV', 'Alexey', '1998-03-10', 2, '2023-09-18'),
  ('ZORN', 'Timothé', '2001-10-08', 5, '2025-01-01'),
  ('ZOURE', 'Moubarak', '1995-03-20', 5, '2018-11-01'),
  ('ZRIGUI', 'Sarra', '1991-12-15', 2, '2020-06-01')
)
INSERT INTO affectations_laboratoires (personne, laboratoire, date_debut)
SELECT p.id, 1, COALESCE(da.date_debut, '2000-01-01')::date
FROM doctorant_affectations da
JOIN personnes p
  ON p.nom = da.nom
 AND p.prenom = da.prenom
 AND (p.date_naissance IS NOT DISTINCT FROM da.date_naissance::date)
WHERE NOT EXISTS (
  SELECT 1 FROM affectations_laboratoires al
  WHERE al.personne = p.id AND al.laboratoire = 1
);

WITH doctorant_affectations (nom, prenom, date_naissance, departement, date_debut) AS (
VALUES
  ('ABOUABDALLAH', 'Mohamed Anwar', '1995-09-08', 4, '2019-10-01'),
  ('ADERGHAL', 'Karim', '1988-08-02', 2, '2016-03-01'),
  ('AITKACI', 'Tassadit', '1990-07-09', 4, '2019-02-01'),
  ('ALAMI', 'Karim', '1990-09-12', 5, '2017-10-01'),
  ('ALBA', 'Vincent', '1996-09-26', 4, '2022-09-01'),
  ('AMARI', 'Rafik', '1985-09-03', 2, '2022-01-01'),
  ('ANDRIANTSOAMBEROMANGA', 'Maeva', '1998-09-06', 3, '2022-10-01'),
  ('APPRIOU', 'Aurélien', '1990-07-18', 2, '2017-10-01'),
  ('ARCHIPOFF', 'Simon', '1986-01-02', 3, '2015-10-01'),
  ('ASLOUDJ', 'Yanis', '2000-07-04', 5, '2022-10-01'),
  ('ASSOR', 'Ambre', '1996-11-28', 2, '2020-10-01'),
  ('AUVILLE', 'Asia', '2002-01-05', 4, '2024-10-01'),
  ('AWUKLU', 'Kokou-Yvon', '1993-01-13', 3, '2022-10-01'),
  ('AYYAR', 'Meghna Parameswaran', '1996-08-07', 2, '2022-10-01'),
  ('BAHI', 'Aref', '1999-07-13', 2, '2024-09-01'),
  ('BANDET', 'Alexis', '1995-06-15', 4, '2021-09-01'),
  ('BARJOU', 'Emile', '1996-01-29', 2, '2019-10-01'),
  ('BASTIDE', 'Paul', '1999-06-28', 1, '2022-09-01'),
  ('BATHIE', 'Gabriel', '1998-07-03', 3, '2022-09-01'),
  ('BAUCHER', 'Edgar', '2000-05-26', 1, '2023-09-01'),
  ('BEAUDOUX', 'Vincent', '1988-01-05', 5, '2017-05-20'),
  ('BEAUMARD', 'Colleen', '1997-06-02', 2, '2022-10-01'),
  ('BECHER', 'Cindy', '1994-12-11', 2, '2018-09-01'),
  ('BELLOUM', 'Rafik', '1992-07-02', 4, '2017-05-01'),
  ('BENAROCH', 'Camille', '1993-01-11', 2, '2018-10-01'),
  ('BENDI-OUIS', 'Yannis', '1995-04-25', 3, '2023-10-01'),
  ('BENMANSOUR', 'Tariq', '1982-01-11', 5, '2015-03-01'),
  ('BEZIAU', 'Paul', '1995-08-30', 4, '2018-11-01'),
  ('BILLY', 'Antoine', '1992-11-28', 2, '2017-05-01'),
  ('BINET', 'Anaïs', '1999-12-22', 2, '2022-09-01'),
  ('BIZIERE', 'Clotilde', '2000-02-19', 3, '2024-09-01'),
  ('BLANCHE', 'Alexandre', '1994-10-11', 1, '2018-09-01'),
  ('BONNET', 'Pierre', '1998-05-18', 1, '2022-09-01'),
  ('BOSE', 'Sougata', '1994-11-24', 3, '2017-10-01'),
  ('BOUGHARIOU', 'Rima', '1999-09-27', 3, '2024-09-01'),
  ('BOURNEUF', 'Romain', '2000-10-15', 1, '2024-09-01'),
  ('BOYER', 'Florian', '1991-05-01', 2, '2017-05-01'),
  ('BRASSART', 'Mathieu', '2000-12-11', 3, '2023-11-01'),
  ('BRIERE', 'Marie-Galadriel', '1995-11-09', 5, '2019-10-01'),
  ('BRUN', 'Anna-Louise', '2000-10-30', 2, '2024-10-01'),
  ('BRUNEL', 'Camille', '1989-09-12', 2, '2017-12-01'),
  ('CALLUAUD', 'Abel', '1997-08-16', 4, '2022-10-03'),
  ('CAM', 'Tristan', '2000-08-30', 1, '2024-03-04'),
  ('CARRARD', 'Thierry', '1976-10-26', 4, '2003-07-28'),
  ('CARRILLO LINDADO', 'Hernan Camilo', '1995-09-30', 2, '2020-10-01'),
  ('CASAMAYOU', 'Vincent', '1996-05-29', 2, '2022-10-01'),
  ('CASARES-SANTOS', 'Antonio', '1997-04-11', 3, '2020-10-01'),
  ('CASSAGNE', 'Adrien', '1989-02-02', 4, '2017-10-01'),
  ('CASSEAU', 'Christophe', '1970-02-21', 5, '2019-11-01'),
  ('CASTANET', 'Tobias', '1994-07-27', 4, '2018-09-01'),
  ('CAUBET', 'Christophe', '1996-06-04', 2, '2019-11-18'),
  ('CHAABOUNI', 'Nadia', '1991-06-14', 3, '2017-06-01'),
  ('CHAIX-EICHEL', 'Naomi', '1996-06-11', 3, '2021-10-01'),
  ('CHAMBRES', 'Gaëtan', '1994-07-15', 2, '2018-09-01'),
  ('CHAOUCHI', 'Aghiles', '1994-05-04', 5, '2018-12-01'),
  ('CHATEAU LAURENT', 'Hugo', '1996-09-15', 3, '2020-11-01'),
  ('CHEN', 'Wei', '1989-03-09', 5, '2016-07-26'),
  ('CIORNA', 'Vasile', '1990-02-11', 5, '2020-06-01'),
  ('CLAUDE', 'Elsa', '1997-11-04', 5, '2021-10-01'),
  ('COLAJANNI', 'Antonin', '2000-05-25', 5, '2023-09-01'),
  ('CORSINI', 'Timothée', '1997-06-20', 1, '2021-09-01'),
  ('COYE', 'Baptiste', '1992-06-30', 4, '2020-04-01'),
  ('CROSTA', 'Tomas', '1999-09-15', 1, '2024-09-01'),
  ('D''AVIAU DE PIOLANT', 'Albert', '2000-03-16', 4, '2023-10-01'),
  ('DA SILVA', 'Simon', '1994-09-13', 5, '2017-10-01'),
  ('DAGAR', 'Snigdha', '1995-01-26', 3, '2019-12-01'),
  ('DAHAOUI', 'Ibrahim', '1993-02-23', 1, '2020-02-01'),
  ('DAOUDI', 'Idriss', '1992-10-28', 4, '2018-10-01'),
  ('DARBAR', 'Rajkumar', '1991-04-20', 2, '2017-12-01'),
  ('DARDOUR', 'Mayssa', '1997-10-26', 3, '2022-04-01'),
  ('DAVID', 'Jean-François', '1993-07-08', 4, '2021-09-01'),
  ('DE CASTRO PINTO', 'Théo', '1998-07-25', 3, '2022-03-01'),
  ('DELPY', 'Romain', '2000-04-06', 3, '2023-09-01'),
  ('DREYER', 'Pauline', '1993-03-05', 2, '2023-10-01'),
  ('DUCLUSAUD', 'Marc', '1998-01-28', 3, '2022-10-01'),
  ('DULAU', 'Idris', '1999-01-19', 2, '2022-09-01'),
  ('ECHEZARRETA ARRUTI', 'Ander', '1998-04-20', 2, '2024-01-02'),
  ('ECONOMIDES', 'Marie', '1995-12-28', 2, '2020-12-14'),
  ('EVEN', 'Melvin', '1998-02-08', 2, '2021-10-01'),
  ('FACCI', 'Aurélien', '2000-05-28', 5, '2023-10-01'),
  ('FEJER', 'Attila', '1991-01-25', 2, '2018-10-01'),
  ('FELSOCI', 'Marek', '1996-04-23', 4, '2019-10-01'),
  ('FERRON', 'Aymeric', '1999-03-19', 2, '2023-03-01'),
  ('FIRMO DRUMOND', 'Thalita', '1989-11-02', 3, '2017-10-01'),
  ('FONTAINE', 'Lucie', '1999-06-23', 3, '2023-10-01'),
  ('FONTAINE', 'Oscar', '2001-04-13', 1, '2024-09-01'),
  ('FOSSE', 'Rohan', '1995-10-08', 3, '2017-11-15'),
  ('FOURNEAU', 'Gary', '1999-07-02', 2, '2021-10-01'),
  ('FUCCELLARO', 'Maxime', '1995-06-08', 1, '2021-01-01'),
  ('GARRIGUES', 'Mathilde', '1991-06-04', 5, '2020-01-06'),
  ('GASPARD', 'Clément', '1998-05-04', 3, '2022-09-01'),
  ('GAVOILLE', 'Clément', '1998-08-16', 4, '2021-01-01'),
  ('GEBRESLASSIE', 'Abel Kahsay', '1995-08-07', 5, '2022-10-01'),
  ('GENAY', 'Adélaïde', '1996-04-15', 2, '2019-10-01'),
  ('GHASSEMI NEJDAD', 'Chabname', '1989-06-18', 3, '2022-10-01'),
  ('GHIGO', 'Vincent', '2000-12-09', 3, '2024-10-01'),
  ('GHNAYA', 'Imed', '1996-09-11', 3, '2021-03-01'),
  ('GIOVANNANGELI', 'Loann', '1996-11-09', 5, '2020-10-01'),
  ('GIRAUDEAU', 'Philippe', '1991-03-26', 2, '2017-10-01'),
  ('GOEDEFROIT', 'Charles', '1998-09-30', 4, '2024-03-01'),
  ('GROS CHAUVERGNE', 'Edwige', '1996-02-19', 2, '2021-10-01'),
  ('GUERRIERI', 'Pierre-Loup', '1999-10-27', 5, '2024-03-01'),
  ('GUEVARA GARBAN', 'Manuel', '1997-01-15', 2, '2022-10-01'),
  ('HALNAUT', 'Adrien', '1996-01-17', 5, '2019-10-01'),
  ('HASSINI', 'Lamyae', '2001-02-05', 5, '2024-10-01'),
  ('HILAIRE', 'Claire', '1997-10-06', 1, '2020-10-01'),
  ('HILAIRE', 'Thibault', '1997-02-26', 3, '2021-09-01'),
  ('HONORE', 'Valentin', '1991-10-11', 4, '2017-11-01'),
  ('HOUZELOT', 'Agathe', '1997-10-11', 1, '2020-10-05'),
  ('HUBNER', 'Nicolas', '2000-11-14', 5, '2023-10-01'),
  ('HYSENI', 'Fjola', '1995-05-11', 3, '2020-10-01'),
  ('IANNACITO', 'Martina', '1995-11-28', 4, '2019-10-01'),
  ('IBARBOURE', 'Sébastien', '1993-05-25', 2, '2018-01-01'),
  ('IBRAHIM', 'Aïda', '1995-01-25', 3, '2021-04-01'),
  ('INCONNU', 'Inconnu', '2000-01-01', 1, '2024-01-01'),
  ('JABALLI', 'Samawel', '1997-08-29', 2, '2023-01-01'),
  ('JACQUES', 'Amaury', '1996-06-10', 1, '2022-10-01'),
  ('JEAN', 'Robin', '1999-10-18', 3, '2023-10-03'),
  ('JEGOUREL', 'Adrien', '1998-08-01', 5, '2022-03-21'),
  ('JOLICOEUR', 'Lise', '1999-07-18', 4, '2022-11-01'),
  ('JOUANNEAU', 'Warren', '1991-01-19', 2, '2020-01-14'),
  ('KAMBIRE', 'Sidoine', '1996-06-12', 5, '2019-11-15'),
  ('KAMRAOUI', 'Reda Abdellah', '1995-09-07', 2, '2019-11-01'),
  ('KAO', 'Shih-shun', '1988-07-31', 1, '2019-09-01'),
  ('KARABOGHOSSIAN', 'Théo', '1993-06-08', 1, '2017-09-01'),
  ('KAUSHIK', 'Pramod', '1990-06-22', 3, '2018-10-01'),
  ('KHAMARI', 'Sabri', '1995-01-31', 3, '2020-03-01'),
  ('KHATTABI RIFFI', 'Adnane', '1996-03-07', 1, '2019-11-01'),
  ('KORKMAZ', 'Esragul', '1992-01-21', 4, '2018-11-01'),
  ('KORKMAZ', 'Kadir', '1989-04-15', 5, '2019-11-15'),
  ('KOVAL', 'Mogane', '1997-12-16', 2, '2020-02-01'),
  ('KSOURI', 'Chahrazed', '1990-12-03', 5, '2016-09-01'),
  ('LA ROCCA', 'Pierre', '1998-05-22', 5, '2022-10-19'),
  ('LAAROUSSI', 'Oussama', '1995-10-17', 2, '2022-01-01'),
  ('LACAUD', 'Mathias', '1993-03-19', 5, '2017-08-01'),
  ('LAFOURCADE', 'Pierre', '1999-12-17', 3, '2023-09-01'),
  ('LAJOU', 'Dimitri', '1994-08-31', 1, '2018-09-01'),
  ('LALLIER', 'Corentin', '1981-11-29', 5, '2019-10-01'),
  ('LARROZE-JARDINÉ', 'Sarah', '1998-07-01', 3, '2021-10-01'),
  ('LASSALLE-ASTIS', 'Nina', '1998-04-09', 2, '2023-02-01'),
  ('LASSERRE', 'Alice', '1999-12-16', 4, '2022-09-01'),
  ('LATAPPY', 'Corentin', '2000-11-28', 5, '2021-07-15'),
  ('LAUDONIO', 'Matteo', '1993-06-01', 1, '2018-10-01'),
  ('LAUMOND', 'Antoine', '1991-06-28', 5, '2016-04-01'),
  ('LE BOT', 'Edern', '1998-10-01', 2, '2022-10-01'),
  ('LE MEUDEC', 'Juliette', '2001-05-21', 2, '2023-10-01'),
  ('LE VAN', 'Loi', '1990-10-06', 5, '2024-09-01'),
  ('LECOMTE', 'Maxime', '1996-02-22', 5, '2020-11-01'),
  ('LEGRAND', 'Clément', '1997-12-23', 1, '2021-09-01'),
  ('LENTZ', 'Antonin', '1992-07-16', 1, '2017-11-01'),
  ('LEPSOVA', 'Jana', '1995-01-17', 1, '2020-10-01'),
  ('LEVEAU', 'Julien', '1993-05-20', 5, '2018-05-01'),
  ('LION', 'Romain', '1994-12-17', 4, '2018-10-01'),
  ('LIRA NUNES', 'Alan', '1992-11-09', 4, '2023-03-01'),
  ('LISITO', 'Alycia', '1999-09-13', 4, '2024-01-01'),
  ('LONGUEFOSSE', 'Arthur', '1996-08-19', 2, '2021-10-01'),
  ('LOPEZ', 'Angélique', '1998-01-31', 5, '2021-09-06'),
  ('LOPEZ', 'Myriam', '1993-11-29', 2, '2018-07-01'),
  ('LOPEZ-RODRIGUEZ', 'Mario', '1988-05-09', 2, '2022-02-01'),
  ('LUCAS', 'Gwenolé', '1996-10-03', 4, '2019-11-01'),
  ('LUCAS', 'Simon', '2000-09-13', 2, '2021-10-01'),
  ('MAGANA LOPEZ', 'Gustavo', '1996-08-06', 3, '2022-09-01'),
  ('MAILLARD', 'Vimala', '1998-04-21', 1, '2023-10-01'),
  ('MALLICK', 'Rupayan', '1995-08-13', 2, '2020-10-01'),
  ('MANIÈRE', 'Quentin', '1995-11-14', 3, '2019-10-01'),
  ('MARCILLE', 'Clara', '1999-07-05', 1, '2022-09-01'),
  ('MARCÉ', 'Taïssir', '2001-01-22', 1, '2024-10-09'),
  ('MARIE-MAGDELAINE', 'Nicolas', '1991-12-16', 5, '2017-07-01'),
  ('MARISSENS CUEVA', 'Valérie', '1999-05-07', 2, '2023-12-01'),
  ('MARLIER', 'Maudeline', '1998-10-28', 2, '2022-05-10'),
  ('MARTIN', 'Pierre-Etienne', '1993-02-19', 2, '2017-11-01'),
  ('MARTIN', 'Vincent', '1996-02-05', 2, '2019-10-01'),
  ('MASCLE', 'Corto', '1998-11-17', 3, '2021-09-01'),
  ('MATRICON', 'Théo', '1997-10-24', 3, '2021-10-01'),
  ('MELGAR FERNANDEZ', 'Raquel', '2000-01-29', 1, '2024-02-01'),
  ('MENDIBOURE', 'Léo', '1994-04-14', 5, '2018-01-01'),
  ('MERCIER', 'Chloé', '1994-02-16', 3, '2020-10-01'),
  ('METUEKAM', 'Françoise', '1998-10-07', 5, '2024-10-01'),
  ('MOHAMED EL MAAROUF', 'Aboul-Karim', '1993-06-06', 4, '2020-03-01'),
  ('MONCE', 'Gustave', '1999-12-29', 5, '2022-10-01'),
  ('MONTOYA OBESO', 'Abraham', '1991-03-04', 2, '2017-02-01'),
  ('MOREL', 'Bastien', '2000-09-29', 2, '2024-10-01'),
  ('MOREL', 'Nicolas', '1999-07-07', 5, '2023-11-01'),
  ('MORIN', 'Ludovic', '1996-10-29', 1, '2022-09-01'),
  ('MORIN', 'Thomas', '1999-11-17', 4, '2023-10-01'),
  ('MORVAN', 'Rémi', '1997-12-12', 3, '2021-09-01'),
  ('MOUHOUB', 'Noureddine', '1995-07-19', 5, '2019-10-01'),
  ('MOULIE', 'Gabin', '1996-05-29', 2, '2023-02-01'),
  ('MUKAM', 'Augusta', '2000-04-29', 5, '2022-10-15'),
  ('MULLER', 'Thomas', '1999-07-13', 1, '2022-09-01'),
  ('MUNHOZ PEREIRA FILHO', 'Vanderlei', '1993-03-27', 4, '2024-12-01'),
  ('NADOR', 'Victor', '1996-03-01', 1, '2020-10-01'),
  ('NAQUIN', 'Emile', '1999-05-03', 1, '2023-09-01'),
  ('NARBONI', 'Jonathan', '1990-10-07', 1, '2019-10-01'),
  ('NAVET', 'Eloi', '2000-06-30', 2, '2024-10-01'),
  ('NGUYEN', 'Huy-Dung', '1995-09-17', 2, '2020-10-01'),
  ('NGUYEN', 'Van Man', '1996-02-05', 4, '2019-11-01'),
  ('NICOLAS', 'Brieuc', '2001-10-30', 4, '2024-10-01'),
  ('OOTA', 'Subba Reddy', '1989-04-17', 3, '2020-11-01'),
  ('ORHAN', 'Diane', '1997-11-25', 4, '2022-09-01'),
  ('OUMAZIZ', 'Mohamed Ameziane', '1993-05-15', 5, '2016-09-01'),
  ('OUVRARD', 'Paul', '1994-04-08', 1, '2017-10-01'),
  ('PADIOLLEAU', 'Guillaume', '1994-03-26', 3, '2018-09-10'),
  ('PAGLIARINI', 'Silvia', '1992-10-26', 3, '2017-11-01'),
  ('PALAUDE', 'Axel', '1998-10-03', 3, '2021-10-01'),
  ('PASCALIE', 'Romain', '1993-12-10', 1, '2017-09-01'),
  ('PAUL', 'Soumyajit', '1993-08-15', 3, '2018-09-01'),
  ('PELLETIER', 'Fabien', '1999-07-15', 2, '2023-10-01'),
  ('PEPIN', 'Thibaut', '1997-03-09', 4, '2023-03-15'),
  ('PERESSONI', 'Romain', '1996-12-01', 4, '2019-10-15'),
  ('PEREZ DE SAN ROMAN', 'Philippe', '1991-11-19', 2, '2017-06-01'),
  ('PESQUET', 'Baptiste', '1976-11-26', 3, '2023-10-18'),
  ('PICAVET', 'Timothé', '2000-04-24', 1, '2024-09-01'),
  ('PIRRONE', 'Antoine', '1994-08-23', 2, '2018-12-01'),
  ('PITTERI', 'Giorgia', '1991-05-22', 2, '2017-11-15'),
  ('POMME-CASSIEROU', 'Luc-Etienne', '1997-04-19', 5, '2020-11-01'),
  ('PORET', 'Maxime', '1994-04-14', 2, '2019-10-01'),
  ('PREVOST', 'Adrien', '1992-09-09', 3, '2018-01-02'),
  ('RACHEDI', 'Abdennour', '1995-06-23', 5, '2019-10-21'),
  ('RAHA', 'Ritam', '1996-07-04', 3, '2019-10-01'),
  ('RAIS', 'Sylvain', '2000-06-11', 3, '2023-10-02'),
  ('RAJANBABU', 'Govind', '1993-04-27', 3, '2017-11-01'),
  ('RAMANATHAN', 'Varun', '1995-12-04', 3, '2018-09-01'),
  ('RAPETTI', 'Alexandre', '1996-06-22', 1, '2020-11-16'),
  ('REBY', 'Kevin', '1985-10-26', 2, '2019-09-03'),
  ('REY', 'Stéphanie', '1984-05-28', 2, '2017-03-01'),
  ('REYNIER', 'Florian', '1994-10-25', 4, '2019-01-14'),
  ('RICHARD', 'Sébastien', '1999-04-11', 2, '2023-09-01'),
  ('RICHEFORT', 'Clément', '1998-12-05', 4, '2021-10-13'),
  ('RIGAUT', 'Coralie', '1999-11-18', 2, '2024-10-01'),
  ('RIXTE', 'Alice', '1996-04-10', 3, '2022-09-01'),
  ('ROC', 'Aline', '1995-11-07', 2, '2019-09-01'),
  ('RODRIGUEZ', 'Julien', '1996-03-04', 4, '2020-10-14'),
  ('RONCALLI', 'Théo', '1997-01-20', 3, '2023-10-01'),
  ('RUBIO PROANO', 'Andrés', '1989-11-24', 4, '2018-10-01'),
  ('RYSBAYEVA', 'Korlan', '1993-09-26', 5, '2019-12-01'),
  ('SANKAR', 'Remya', '1993-12-11', 3, '2018-10-01'),
  ('SARTORI', 'Richard', '1997-03-22', 4, '2021-04-15'),
  ('SCHABANEL', 'Juliette', '2000-02-09', 1, '2024-09-01'),
  ('SCHLICK', 'Charlie', '1996-10-26', 2, '2019-10-01'),
  ('SCHOETERS', 'Jason', '1993-04-17', 1, '2017-11-01'),
  ('SCRAVAGLIERI', 'Lana', '1998-04-23', 4, '2022-11-01'),
  ('SHILOVA', 'Alena', '1994-06-19', 4, '2018-10-08'),
  ('SLIMI', 'Anwer', '1996-02-10', 2, '2020-01-01'),
  ('SPITZER', 'Gian Luca', '2000-07-27', 1, '2024-12-01'),
  ('STROCK', 'Anthony', '1994-10-03', 3, '2017-09-01'),
  ('SWARTVAGHER', 'Philippe', '1996-07-21', 4, '2019-10-01'),
  ('SWESSI', 'Rania', '1999-01-11', 3, '2023-04-01'),
  ('SYLLA', 'Tidiane', '1987-06-08', 5, '2018-10-01'),
  ('TAHIRI', 'Mohamed', '2000-11-04', 2, '2023-11-01'),
  ('TAYEB', 'Hayfa', '1997-10-23', 4, '2021-11-01'),
  ('TEGANAHALLY SRIDHARA', 'Shrinidhi', '2000-08-12', 1, '2024-10-01'),
  ('TROCELLIER', 'David', '1997-12-09', 2, '2021-10-01'),
  ('TROCHON', 'Méline', '2002-01-30', 4, '2024-11-01'),
  ('TROUVAIN', 'Nathan', '1998-01-05', 3, '2022-10-01'),
  ('TSIAPKOLIS', 'Panagiotis', '1997-06-12', 2, '2022-01-17'),
  ('VANHATALO', 'Tara', '1995-08-17', 2, '2021-06-28'),
  ('VARIN', 'Zoé', '1998-07-13', 1, '2022-09-01'),
  ('VENKOVIC', 'Nicolas', '1986-02-22', 4, '2018-10-01'),
  ('VERDON', 'Elia', '1997-04-02', 4, '2021-10-01'),
  ('VERITE', 'Mathieu', '1989-08-27', 4, '2019-09-01'),
  ('VERNAECKT', 'Pierre', '1982-09-16', 5, '2020-10-05'),
  ('VIDAL', 'Nicolas', '1993-02-07', 4, '2018-10-01'),
  ('VINAYAGAME', 'Radjasouria', '1998-07-03', 4, '2022-12-01'),
  ('VU', 'Manh Tu', '1993-08-23', 2, '2019-11-04'),
  ('WALTHER', 'Dimitri', '2001-04-19', 4, '2024-10-01'),
  ('WEBER', 'Axelle', '1996-01-18', 5, '2019-11-12'),
  ('WELTER', 'Marc', '1989-06-29', 2, '2022-02-01'),
  ('XIANG', 'Yen-Fei', '1992-08-14', 4, '2019-11-01'),
  ('YACHEUR', 'Braddedine', '1996-03-25', 5, '2020-10-01'),
  ('YAKOVLEV', 'Ivan', '1997-11-17', 1, '2021-09-01'),
  ('YEBDA', 'Thinhinane', '1994-08-10', 2, '2018-11-08'),
  ('ZAMAI', 'Andrew', '2000-02-02', 2, '2024-10-01'),
  ('ZHAO', 'Xunyi', '1997-01-08', 4, '2021-09-01'),
  ('ZHU', 'Boyu', '1998-06-03', 5, '2024-12-02'),
  ('ZHUKOV', 'Alexey', '1998-03-10', 2, '2023-09-18'),
  ('ZORN', 'Timothé', '2001-10-08', 5, '2025-01-01'),
  ('ZOURE', 'Moubarak', '1995-03-20', 5, '2018-11-01'),
  ('ZRIGUI', 'Sarra', '1991-12-15', 2, '2020-06-01')
)
INSERT INTO affectations_structures_laboratoires (personne, structure_laboratoire, date_debut)
SELECT p.id,
       CASE da.departement
         WHEN 1 THEN 1
         WHEN 2 THEN 2
         WHEN 3 THEN 3
         WHEN 4 THEN 4
         WHEN 5 THEN 5
         WHEN 6 THEN 6
       END AS structure_laboratoire,
       COALESCE(da.date_debut, '2000-01-01')::date AS date_debut
FROM doctorant_affectations da
JOIN personnes p
  ON p.nom = da.nom
 AND p.prenom = da.prenom
 AND (p.date_naissance IS NOT DISTINCT FROM da.date_naissance::date)
WHERE da.departement IS NOT NULL
  AND NOT EXISTS (
    SELECT 1 FROM affectations_structures_laboratoires asl
    WHERE asl.personne = p.id
      AND asl.structure_laboratoire = CASE da.departement
         WHEN 1 THEN 1
         WHEN 2 THEN 2
         WHEN 3 THEN 3
         WHEN 4 THEN 4
         WHEN 5 THEN 5
         WHEN 6 THEN 6
       END
  );

WITH equipe_affectations (personne, structure_laboratoire, date_debut) AS (
VALUES
  (10, 13, '2007-09-01'),
  (100, 10, '2009-09-01'),
  (102, 12, '2023-09-05'),
  (103, 11, '2007-11-01'),
  (104, 14, '2022-09-01'),
  (105, 16, '1996-09-01'),
  (106, 13, '2021-09-01'),
  (107, 21, '1999-10-18'),
  (108, 11, '2008-09-01'),
  (109, 25, '2008-11-20'),
  (11, 20, '1998-09-01'),
  (110, 10, '2012-09-01'),
  (111, 10, '2005-11-01'),
  (111, 11, '2005-11-01'),
  (112, 23, '1993-09-01'),
  (113, 9, '2017-01-01'),
  (114, 16, '2023-09-01'),
  (114, 19, '2023-09-01'),
  (115, 23, '2024-09-01'),
  (116, 23, '2016-09-01'),
  (117, 18, '1998-01-01'),
  (118, 12, '2005-10-01'),
  (118, 9, '2005-10-01'),
  (12, 13, '2024-09-01'),
  (120, 15, '2015-09-01'),
  (120, 16, '2015-09-01'),
  (121, 22, '2021-09-01'),
  (122, 16, '2012-09-01'),
  (123, 13, '2019-10-01'),
  (124, 18, '1997-01-01'),
  (125, 17, '1998-08-01'),
  (126, 23, '2008-09-01'),
  (127, 9, '2005-10-01'),
  (128, 11, '2006-09-01'),
  (129, 24, '2007-01-01'),
  (13, 10, '1997-01-01'),
  (130, 21, '2006-09-01'),
  (133, 23, '2012-09-01'),
  (134, 18, '1993-10-01'),
  (135, 16, '2006-09-01'),
  (135, 19, '2006-09-01'),
  (136, 20, '2002-09-01'),
  (137, 9, '1997-01-01'),
  (138, 23, '2007-09-01'),
  (139, 14, '2005-09-01'),
  (14, 22, '2001-09-01'),
  (141, 18, '2013-11-01'),
  (142, 15, '2018-10-01'),
  (142, 19, '2018-10-01'),
  (143, 10, '2002-09-01'),
  (144, 21, '1997-01-01'),
  (145, 15, '2017-09-01'),
  (145, 16, '2017-09-01'),
  (146, 24, '2008-09-01'),
  (147, 16, '2012-09-01'),
  (148, 21, '2021-01-01'),
  (15, 13, '2013-09-01'),
  (150, 24, '2015-09-01'),
  (151, 15, '2024-09-01'),
  (152, 22, '1997-01-01'),
  (153, 11, '2022-09-01'),
  (153, 12, '2022-09-01'),
  (154, 16, '2005-09-01'),
  (155, 13, '2006-09-01'),
  (156, 23, '2017-10-01'),
  (157, 23, '2023-02-01'),
  (158, 14, '2011-09-01'),
  (159, 15, '2005-09-01'),
  (16, 14, '2001-09-01'),
  (160, 14, '2010-09-01'),
  (161, 18, '2013-09-01'),
  (162, 20, '2017-12-01'),
  (163, 13, '1997-01-01'),
  (164, 24, '1997-01-01'),
  (165, 17, '2013-09-01'),
  (166, 10, '1997-01-01'),
  (168, 15, '2001-10-01'),
  (169, 22, '2023-09-03'),
  (17, 23, '2023-09-01'),
  (171, 12, '2015-09-01'),
  (171, 9, '2015-09-01'),
  (173, 24, '2007-09-01'),
  (174, 20, '2008-09-01'),
  (176, 24, '2012-09-01'),
  (177, 25, '1997-01-01'),
  (178, 18, '2012-01-01'),
  (179, 20, '1997-01-01'),
  (18, 14, '1997-01-01'),
  (180, 15, '2001-10-01'),
  (180, 16, '2001-10-01'),
  (180, 19, '2001-10-01'),
  (182, 21, '2019-09-01'),
  (183, 16, '2005-09-01'),
  (184, 11, '2001-09-01'),
  (186, 23, '2022-01-01'),
  (188, 26, '2020-09-01'),
  (190, 28, '2004-12-01'),
  (191, 28, '2012-10-01'),
  (193, 27, '2015-12-01'),
  (194, 27, '2024-12-01'),
  (195, 27, '2011-10-01'),
  (196, 27, '2020-01-01'),
  (198, 28, '2016-12-01'),
  (199, 28, '2009-10-01'),
  (2, 23, '2004-09-01'),
  (20, 17, '2018-10-01'),
  (201, 28, '2024-01-08'),
  (202, 26, '2011-05-01'),
  (203, 26, '2011-01-01'),
  (204, 27, '2016-09-01'),
  (205, 14, '2004-12-01'),
  (206, 24, '2006-12-01'),
  (207, 27, '2015-09-01'),
  (208, 27, '2007-08-01'),
  (209, 28, '2019-07-01'),
  (21, 16, '2018-10-01'),
  (211, 26, '2004-04-01'),
  (212, 28, '1998-07-01'),
  (217, 28, '2024-11-15'),
  (22, 14, '2023-09-01'),
  (221, 14, '2023-09-04'),
  (225, 28, '2016-12-12'),
  (229, 23, '2021-11-01'),
  (230, 26, '2022-06-01'),
  (231, 24, '2019-10-01'),
  (234, 26, '2024-04-02'),
  (24, 13, '1997-01-01'),
  (241, 28, '2024-11-01'),
  (242, 14, '2024-10-01'),
  (243, 23, '2024-10-15'),
  (247, 22, '2022-07-01'),
  (248, 23, '2022-10-01'),
  (249, 14, '2019-02-01'),
  (25, 23, '2010-09-01'),
  (250, 14, '2017-09-01'),
  (256, 26, '2007-10-01'),
  (257, 27, '2023-09-15'),
  (26, 24, '2014-11-01'),
  (260, 23, '2021-01-01'),
  (261, 23, '2021-09-01'),
  (262, 14, '2023-02-01'),
  (263, 23, '2024-09-01'),
  (264, 24, '2016-04-01'),
  (265, 26, '2018-05-28'),
  (266, 19, '2023-11-01'),
  (27, 24, '2005-09-01'),
  (270, 23, '2022-10-01'),
  (271, 14, '2021-10-01'),
  (272, 23, '2019-11-01'),
  (28, 10, '2015-12-01'),
  (28, 11, '2015-12-01'),
  (285, 27, '2020-09-01'),
  (29, 10, '1999-12-01'),
  (29, 9, '1999-12-01'),
  (294, 13, '2021-12-01'),
  (295, 16, '1997-01-01'),
  (3, 18, '2012-02-01'),
  (30, 11, '2023-09-02'),
  (31, 24, '2023-09-01'),
  (32, 24, '2005-10-01'),
  (33, 9, '1990-01-01'),
  (34, 9, '2010-09-01'),
  (35, 14, '1997-01-01'),
  (36, 23, '2018-09-01'),
  (37, 25, '2010-09-01'),
  (38, 15, '1997-01-01'),
  (4, 18, '2006-09-01'),
  (40, 23, '1997-01-01'),
  (41, 14, '2018-09-01'),
  (42, 14, '2005-09-01'),
  (43, 23, '1993-09-01'),
  (45, 20, '1997-01-01'),
  (46, 14, '2019-09-01'),
  (47, 18, '2023-09-01'),
  (48, 23, '2020-01-01'),
  (49, 23, '2021-10-01'),
  (5, 24, '2018-10-01'),
  (50, 10, '2013-10-01'),
  (50, 9, '2013-10-01'),
  (51, 10, '1998-09-01'),
  (52, 23, '1994-09-01'),
  (53, 21, '2004-10-01'),
  (54, 14, '1997-01-01'),
  (55, 14, '2002-09-01'),
  (56, 24, '2015-01-01'),
  (57, 14, '1997-01-01'),
  (58, 13, '2021-09-01'),
  (59, 10, '2020-12-01'),
  (6, 20, '2003-09-25'),
  (60, 9, '1997-10-01'),
  (61, 24, '1997-01-01'),
  (62, 16, '1997-01-01'),
  (63, 24, '2005-09-01'),
  (64, 24, '1998-01-01'),
  (65, 22, '2006-09-01'),
  (66, 22, '2007-09-01'),
  (67, 23, '2010-09-01'),
  (68, 22, '2012-09-01'),
  (69, 18, '1997-01-01'),
  (71, 17, '2014-10-01'),
  (72, 16, '2018-01-15'),
  (72, 19, '2018-01-15'),
  (73, 16, '2019-01-14'),
  (73, 17, '2019-01-14'),
  (74, 15, '2005-09-01'),
  (75, 24, '2020-01-01'),
  (76, 25, '2011-09-01'),
  (77, 10, '1996-01-01'),
  (77, 11, '1996-01-01'),
  (77, 12, '1996-01-01'),
  (78, 15, '2007-11-01'),
  (78, 18, '2007-11-01'),
  (78, 19, '2007-11-01'),
  (79, 24, '2013-09-01'),
  (8, 13, '2024-01-02'),
  (80, 24, '2024-09-01'),
  (82, 21, '2019-10-01'),
  (83, 13, '1997-01-01'),
  (85, 15, '1997-01-01'),
  (86, 25, '2008-11-01'),
  (87, 14, '1997-01-01'),
  (88, 22, '2005-09-01'),
  (89, 20, '2022-09-01'),
  (9, 14, '2012-09-01'),
  (90, 9, '1997-01-01'),
  (93, 13, '2017-10-01'),
  (94, 12, '2023-09-04'),
  (95, 14, '2005-09-01'),
  (96, 10, '2001-10-01'),
  (96, 11, '2001-10-01'),
  (97, 15, '2001-09-01'),
  (98, 15, '2024-09-01'),
  (99, 18, '2017-02-01')
)
INSERT INTO affectations_structures_laboratoires (personne, structure_laboratoire, date_debut)
SELECT ea.personne, ea.structure_laboratoire, ea.date_debut::date
FROM equipe_affectations ea
WHERE NOT EXISTS (
  SELECT 1 FROM affectations_structures_laboratoires asl
  WHERE asl.personne = ea.personne
    AND asl.structure_laboratoire = ea.structure_laboratoire
);

WITH doctorant_equipe_affectations (nom, prenom, date_naissance, structure_laboratoire, date_debut) AS (
VALUES
  ('ADERGHAL', 'Karim', '1988-08-02', 14, '2016-03-01'),
  ('ALAMI', 'Karim', '1990-09-12', 24, '2017-10-01'),
  ('ALBA', 'Vincent', '1996-09-26', 20, '2022-09-01'),
  ('AMARI', 'Rafik', '1985-09-03', 14, '2022-01-01'),
  ('ANDRIANTSOAMBEROMANGA', 'Maeva', '1998-09-06', 18, '2022-10-01'),
  ('APPRIOU', 'Aurélien', '1990-07-18', 13, '2017-10-01'),
  ('ARCHIPOFF', 'Simon', '1986-01-02', 16, '2015-10-01'),
  ('ASLOUDJ', 'Yanis', '2000-07-04', 24, '2022-10-01'),
  ('ASSOR', 'Ambre', '1996-11-28', 13, '2020-10-01'),
  ('AUVILLE', 'Asia', '2002-01-05', 20, '2024-10-01'),
  ('AWUKLU', 'Kokou-Yvon', '1993-01-13', 17, '2022-10-01'),
  ('AYYAR', 'Meghna Parameswaran', '1996-08-07', 14, '2022-10-01'),
  ('BAHI', 'Aref', '1999-07-13', 14, '2024-09-01'),
  ('BANDET', 'Alexis', '1995-06-15', 21, '2021-09-01'),
  ('BARJOU', 'Emile', '1996-01-29', 14, '2019-10-01'),
  ('BASTIDE', 'Paul', '1999-06-28', 10, '2022-09-01'),
  ('BATHIE', 'Gabriel', '1998-07-03', 16, '2022-09-01'),
  ('BATHIE', 'Gabriel', '1998-07-03', 19, '2022-09-01'),
  ('BAUCHER', 'Edgar', '2000-05-26', 10, '2023-09-01'),
  ('BEAUDOUX', 'Vincent', '1988-01-05', 24, '2017-05-20'),
  ('BEAUMARD', 'Colleen', '1997-06-02', 14, '2022-10-01'),
  ('BECHER', 'Cindy', '1994-12-11', 14, '2018-09-01'),
  ('BENAROCH', 'Camille', '1993-01-11', 13, '2018-10-01'),
  ('BENDI-OUIS', 'Yannis', '1995-04-25', 18, '2023-10-01'),
  ('BENMANSOUR', 'Tariq', '1982-01-11', 23, '2015-03-01'),
  ('BILLY', 'Antoine', '1992-11-28', 14, '2017-05-01'),
  ('BINET', 'Anaïs', '1999-12-22', 14, '2022-09-01'),
  ('BIZIERE', 'Clotilde', '2000-02-19', 15, '2024-09-01'),
  ('BLANCHE', 'Alexandre', '1994-10-11', 10, '2018-09-01'),
  ('BONNET', 'Pierre', '1998-05-18', 9, '2022-09-01'),
  ('BOSE', 'Sougata', '1994-11-24', 15, '2017-10-01'),
  ('BOUGHARIOU', 'Rima', '1999-09-27', 18, '2024-09-01'),
  ('BOURNEUF', 'Romain', '2000-10-15', 10, '2024-09-01'),
  ('BOYER', 'Florian', '1991-05-01', 14, '2017-05-01'),
  ('BRASSART', 'Mathieu', '2000-12-11', 19, '2023-11-01'),
  ('BRIERE', 'Marie-Galadriel', '1995-11-09', 24, '2019-10-01'),
  ('BRUN', 'Anna-Louise', '2000-10-30', 14, '2024-10-01'),
  ('BRUNEL', 'Camille', '1989-09-12', 13, '2017-12-01'),
  ('CALLUAUD', 'Abel', '1997-08-16', 22, '2022-10-03'),
  ('CAM', 'Tristan', '2000-08-30', 12, '2024-03-04'),
  ('CARRILLO LINDADO', 'Hernan Camilo', '1995-09-30', 14, '2020-10-01'),
  ('CASAMAYOU', 'Vincent', '1996-05-29', 13, '2022-10-01'),
  ('CASARES-SANTOS', 'Antonio', '1997-04-11', 18, '2020-10-01'),
  ('CASSEAU', 'Christophe', '1970-02-21', 23, '2019-11-01'),
  ('CASTANET', 'Tobias', '1994-07-27', 22, '2018-09-01'),
  ('CAUBET', 'Christophe', '1996-06-04', 14, '2019-11-18'),
  ('CHAABOUNI', 'Nadia', '1991-06-14', 18, '2017-06-01'),
  ('CHAIX-EICHEL', 'Naomi', '1996-06-11', 18, '2021-10-01'),
  ('CHAMBRES', 'Gaëtan', '1994-07-15', 14, '2018-09-01'),
  ('CHAOUCHI', 'Aghiles', '1994-05-04', 23, '2018-12-01'),
  ('CHATEAU LAURENT', 'Hugo', '1996-09-15', 18, '2020-11-01'),
  ('CHEN', 'Wei', '1989-03-09', 23, '2016-07-26'),
  ('CIORNA', 'Vasile', '1990-02-11', 24, '2020-06-01'),
  ('CLAUDE', 'Elsa', '1997-11-04', 24, '2021-10-01'),
  ('COLAJANNI', 'Antonin', '2000-05-25', 24, '2023-09-01'),
  ('CORSINI', 'Timothée', '1997-06-20', 10, '2021-09-01'),
  ('CORSINI', 'Timothée', '1997-06-20', 11, '2021-09-01'),
  ('CROSTA', 'Tomas', '1999-09-15', 12, '2024-09-01'),
  ('D''AVIAU DE PIOLANT', 'Albert', '2000-03-16', 21, '2023-10-01'),
  ('DA SILVA', 'Simon', '1994-09-13', 23, '2017-10-01'),
  ('DAGAR', 'Snigdha', '1995-01-26', 18, '2019-12-01'),
  ('DAHAOUI', 'Ibrahim', '1993-02-23', 11, '2020-02-01'),
  ('DARBAR', 'Rajkumar', '1991-04-20', 13, '2017-12-01'),
  ('DARDOUR', 'Mayssa', '1997-10-26', 18, '2022-04-01'),
  ('DAVID', 'Jean-François', '1993-07-08', 22, '2021-09-01'),
  ('DE CASTRO PINTO', 'Théo', '1998-07-25', 15, '2022-03-01'),
  ('DELPY', 'Romain', '2000-04-06', 15, '2023-09-01'),
  ('DREYER', 'Pauline', '1993-03-05', 13, '2023-10-01'),
  ('DUCLUSAUD', 'Marc', '1998-01-28', 18, '2022-10-01'),
  ('DULAU', 'Idris', '1999-01-19', 14, '2022-09-01'),
  ('ECHEZARRETA ARRUTI', 'Ander', '1998-04-20', 14, '2024-01-02'),
  ('ECONOMIDES', 'Marie', '1995-12-28', 14, '2020-12-14'),
  ('EVEN', 'Melvin', '1998-02-08', 13, '2021-10-01'),
  ('FACCI', 'Aurélien', '2000-05-28', 24, '2023-10-01'),
  ('FEJER', 'Attila', '1991-01-25', 14, '2018-10-01'),
  ('FERRON', 'Aymeric', '1999-03-19', 13, '2023-03-01'),
  ('FIRMO DRUMOND', 'Thalita', '1989-11-02', 18, '2017-10-01'),
  ('FONTAINE', 'Lucie', '1999-06-23', 18, '2023-10-01'),
  ('FONTAINE', 'Oscar', '2001-04-13', 9, '2024-09-01'),
  ('FOSSE', 'Rohan', '1995-10-08', 17, '2017-11-15'),
  ('FOURNEAU', 'Gary', '1999-07-02', 13, '2021-10-01'),
  ('FUCCELLARO', 'Maxime', '1995-06-08', 11, '2021-01-01'),
  ('GARRIGUES', 'Mathilde', '1991-06-04', 23, '2020-01-06'),
  ('GASPARD', 'Clément', '1998-05-04', 18, '2022-09-01'),
  ('GAVOILLE', 'Clément', '1998-08-16', 21, '2021-01-01'),
  ('GEBRESLASSIE', 'Abel Kahsay', '1995-08-07', 24, '2022-10-01'),
  ('GENAY', 'Adélaïde', '1996-04-15', 13, '2019-10-01'),
  ('GHASSEMI NEJDAD', 'Chabname', '1989-06-18', 15, '2022-10-01'),
  ('GHIGO', 'Vincent', '2000-12-09', 16, '2024-10-01'),
  ('GIOVANNANGELI', 'Loann', '1996-11-09', 24, '2020-10-01'),
  ('GOEDEFROIT', 'Charles', '1998-09-30', 21, '2024-03-01'),
  ('GROS CHAUVERGNE', 'Edwige', '1996-02-19', 13, '2021-10-01'),
  ('GUERRIERI', 'Pierre-Loup', '1999-10-27', 23, '2024-03-01'),
  ('GUEVARA GARBAN', 'Manuel', '1997-01-15', 14, '2022-10-01'),
  ('HALNAUT', 'Adrien', '1996-01-17', 24, '2019-10-01'),
  ('HASSINI', 'Lamyae', '2001-02-05', 23, '2024-10-01'),
  ('HILAIRE', 'Claire', '1997-10-06', 10, '2020-10-01'),
  ('HILAIRE', 'Thibault', '1997-02-26', 15, '2021-09-01'),
  ('HOUZELOT', 'Agathe', '1997-10-11', 9, '2020-10-05'),
  ('HUBNER', 'Nicolas', '2000-11-14', 23, '2023-10-01'),
  ('HYSENI', 'Fjola', '1995-05-11', 18, '2020-10-01'),
  ('IBARBOURE', 'Sébastien', '1993-05-25', 13, '2018-01-01'),
  ('IBRAHIM', 'Aïda', '1995-01-25', 15, '2021-04-01'),
  ('JABALLI', 'Samawel', '1997-08-29', 14, '2023-01-01'),
  ('JACQUES', 'Amaury', '1996-06-10', 11, '2022-10-01'),
  ('JEAN', 'Robin', '1999-10-18', 17, '2023-10-03'),
  ('JEGOUREL', 'Adrien', '1998-08-01', 23, '2022-03-21'),
  ('JOLICOEUR', 'Lise', '1999-07-18', 20, '2022-11-01'),
  ('JOUANNEAU', 'Warren', '1991-01-19', 14, '2020-01-14'),
  ('KAMBIRE', 'Sidoine', '1996-06-12', 23, '2019-11-15'),
  ('KAMRAOUI', 'Reda Abdellah', '1995-09-07', 14, '2019-11-01'),
  ('KAO', 'Shih-shun', '1988-07-31', 10, '2019-09-01'),
  ('KARABOGHOSSIAN', 'Théo', '1993-06-08', 9, '2017-09-01'),
  ('KAUSHIK', 'Pramod', '1990-06-22', 18, '2018-10-01'),
  ('KHAMARI', 'Sabri', '1995-01-31', 18, '2020-03-01'),
  ('KHATTABI RIFFI', 'Adnane', '1996-03-07', 11, '2019-11-01'),
  ('KORKMAZ', 'Esragul', '1992-01-21', 22, '2018-11-01'),
  ('KORKMAZ', 'Kadir', '1989-04-15', 23, '2019-11-15'),
  ('KOVAL', 'Mogane', '1997-12-16', 13, '2020-02-01'),
  ('KSOURI', 'Chahrazed', '1990-12-03', 23, '2016-09-01'),
  ('LA ROCCA', 'Pierre', '1998-05-22', 25, '2022-10-19'),
  ('LAAROUSSI', 'Oussama', '1995-10-17', 14, '2022-01-01'),
  ('LACAUD', 'Mathias', '1993-03-19', 23, '2017-08-01'),
  ('LAFOURCADE', 'Pierre', '1999-12-17', 17, '2023-09-01'),
  ('LAJOU', 'Dimitri', '1994-08-31', 10, '2018-09-01'),
  ('LALLIER', 'Corentin', '1981-11-29', 24, '2019-10-01'),
  ('LARROZE-JARDINÉ', 'Sarah', '1998-07-01', 15, '2021-10-01'),
  ('LASSALLE-ASTIS', 'Nina', '1998-04-09', 14, '2023-02-01'),
  ('LASSERRE', 'Alice', '1999-12-16', 20, '2022-09-01'),
  ('LATAPPY', 'Corentin', '2000-11-28', 23, '2021-07-15'),
  ('LAUDONIO', 'Matteo', '1993-06-01', 9, '2018-10-01'),
  ('LAUMOND', 'Antoine', '1991-06-28', 24, '2016-04-01'),
  ('LE BOT', 'Edern', '1998-10-01', 14, '2022-10-01'),
  ('LE MEUDEC', 'Juliette', '2001-05-21', 13, '2023-10-01'),
  ('LE VAN', 'Loi', '1990-10-06', 23, '2024-09-01'),
  ('LECOMTE', 'Maxime', '1996-02-22', 24, '2020-11-01'),
  ('LEGRAND', 'Clément', '1997-12-23', 10, '2021-09-01'),
  ('LENTZ', 'Antonin', '1992-07-16', 10, '2017-11-01'),
  ('LEVEAU', 'Julien', '1993-05-20', 23, '2018-05-01'),
  ('LION', 'Romain', '1994-12-17', 20, '2018-10-01'),
  ('LIRA NUNES', 'Alan', '1992-11-09', 20, '2023-03-01'),
  ('LISITO', 'Alycia', '1999-09-13', 22, '2024-01-01'),
  ('LONGUEFOSSE', 'Arthur', '1996-08-19', 14, '2021-10-01'),
  ('LOPEZ', 'Angélique', '1998-01-31', 23, '2021-09-06'),
  ('LOPEZ', 'Myriam', '1993-11-29', 14, '2018-07-01'),
  ('LOPEZ-RODRIGUEZ', 'Mario', '1988-05-09', 14, '2022-02-01'),
  ('LUCAS', 'Gwenolé', '1996-10-03', 20, '2019-11-01'),
  ('LUCAS', 'Simon', '2000-09-13', 13, '2021-10-01'),
  ('MAGANA LOPEZ', 'Gustavo', '1996-08-06', 19, '2022-09-01'),
  ('MAILLARD', 'Vimala', '1998-04-21', 9, '2023-10-01'),
  ('MALLICK', 'Rupayan', '1995-08-13', 14, '2020-10-01'),
  ('MANIÈRE', 'Quentin', '1995-11-14', 17, '2019-10-01'),
  ('MARCILLE', 'Clara', '1999-07-05', 10, '2022-09-01'),
  ('MARCÉ', 'Taïssir', '2001-01-22', 10, '2024-10-09'),
  ('MARIE-MAGDELAINE', 'Nicolas', '1991-12-16', 23, '2017-07-01'),
  ('MARISSENS CUEVA', 'Valérie', '1999-05-07', 13, '2023-12-01'),
  ('MARLIER', 'Maudeline', '1998-10-28', 13, '2022-05-10'),
  ('MARTIN', 'Pierre-Etienne', '1993-02-19', 14, '2017-11-01'),
  ('MARTIN', 'Vincent', '1996-02-05', 14, '2019-10-01'),
  ('MASCLE', 'Corto', '1998-11-17', 15, '2021-09-01'),
  ('MASCLE', 'Corto', '1998-11-17', 16, '2021-09-01'),
  ('MASCLE', 'Corto', '1998-11-17', 19, '2021-09-01'),
  ('MATRICON', 'Théo', '1997-10-24', 19, '2021-10-01'),
  ('MELGAR FERNANDEZ', 'Raquel', '2000-01-29', 9, '2024-02-01'),
  ('MENDIBOURE', 'Léo', '1994-04-14', 23, '2018-01-01'),
  ('MERCIER', 'Chloé', '1994-02-16', 18, '2020-10-01'),
  ('METUEKAM', 'Françoise', '1998-10-07', 24, '2024-10-01'),
  ('MONCE', 'Gustave', '1999-12-29', 23, '2022-10-01'),
  ('MONTOYA OBESO', 'Abraham', '1991-03-04', 14, '2017-02-01'),
  ('MOREL', 'Bastien', '2000-09-29', 13, '2024-10-01'),
  ('MOREL', 'Nicolas', '1999-07-07', 23, '2023-11-01'),
  ('MORIN', 'Ludovic', '1996-10-29', 9, '2022-09-01'),
  ('MORIN', 'Thomas', '1999-11-17', 20, '2023-10-01'),
  ('MORVAN', 'Rémi', '1997-12-12', 16, '2021-09-01'),
  ('MORVAN', 'Rémi', '1997-12-12', 17, '2021-09-01'),
  ('MORVAN', 'Rémi', '1997-12-12', 19, '2021-09-01'),
  ('MOUHOUB', 'Noureddine', '1995-07-19', 23, '2019-10-01'),
  ('MOULIE', 'Gabin', '1996-05-29', 14, '2023-02-01'),
  ('MUKAM', 'Augusta', '2000-04-29', 23, '2022-10-15'),
  ('MULLER', 'Thomas', '1999-07-13', 9, '2022-09-01'),
  ('MUNHOZ PEREIRA FILHO', 'Vanderlei', '1993-03-27', 22, '2024-12-01'),
  ('NADOR', 'Victor', '1996-03-01', 9, '2020-10-01'),
  ('NAQUIN', 'Emile', '1999-05-03', 10, '2023-09-01'),
  ('NARBONI', 'Jonathan', '1990-10-07', 10, '2019-10-01'),
  ('NAVET', 'Eloi', '2000-06-30', 14, '2024-10-01'),
  ('NGUYEN', 'Huy-Dung', '1995-09-17', 14, '2020-10-01'),
  ('NGUYEN', 'Van Man', '1996-02-05', 20, '2019-11-01'),
  ('NICOLAS', 'Brieuc', '2001-10-30', 22, '2024-10-01'),
  ('OOTA', 'Subba Reddy', '1989-04-17', 18, '2020-11-01'),
  ('ORHAN', 'Diane', '1997-11-25', 20, '2022-09-01'),
  ('OUMAZIZ', 'Mohamed Ameziane', '1993-05-15', 23, '2016-09-01'),
  ('OUVRARD', 'Paul', '1994-04-08', 10, '2017-10-01'),
  ('PADIOLLEAU', 'Guillaume', '1994-03-26', 18, '2018-09-10'),
  ('PAGLIARINI', 'Silvia', '1992-10-26', 18, '2017-11-01'),
  ('PALAUDE', 'Axel', '1998-10-03', 18, '2021-10-01'),
  ('PASCALIE', 'Romain', '1993-12-10', 9, '2017-09-01'),
  ('PAUL', 'Soumyajit', '1993-08-15', 18, '2018-09-01'),
  ('PELLETIER', 'Fabien', '1999-07-15', 14, '2023-10-01'),
  ('PEREZ DE SAN ROMAN', 'Philippe', '1991-11-19', 14, '2017-06-01'),
  ('PESQUET', 'Baptiste', '1976-11-26', 18, '2023-10-18'),
  ('PICAVET', 'Timothé', '2000-04-24', 10, '2024-09-01'),
  ('PIRRONE', 'Antoine', '1994-08-23', 14, '2018-12-01'),
  ('PITTERI', 'Giorgia', '1991-05-22', 14, '2017-11-15'),
  ('POMME-CASSIEROU', 'Luc-Etienne', '1997-04-19', 24, '2020-11-01'),
  ('PORET', 'Maxime', '1994-04-14', 14, '2019-10-01'),
  ('PREVOST', 'Adrien', '1992-09-09', 15, '2018-01-02'),
  ('RACHEDI', 'Abdennour', '1995-06-23', 23, '2019-10-21'),
  ('RAHA', 'Ritam', '1996-07-04', 15, '2019-10-01'),
  ('RAIS', 'Sylvain', '2000-06-11', 15, '2023-10-02'),
  ('RAJANBABU', 'Govind', '1993-04-27', 15, '2017-11-01'),
  ('RAPETTI', 'Alexandre', '1996-06-22', 11, '2020-11-16'),
  ('REBY', 'Kevin', '1985-10-26', 14, '2019-09-03'),
  ('REY', 'Stéphanie', '1984-05-28', 14, '2017-03-01'),
  ('REYNIER', 'Florian', '1994-10-25', 21, '2019-01-14'),
  ('RICHARD', 'Sébastien', '1999-04-11', 14, '2023-09-01'),
  ('RICHEFORT', 'Clément', '1998-12-05', 22, '2021-10-13'),
  ('RIGAUT', 'Coralie', '1999-11-18', 14, '2024-10-01'),
  ('RIXTE', 'Alice', '1996-04-10', 16, '2022-09-01'),
  ('ROC', 'Aline', '1995-11-07', 13, '2019-09-01'),
  ('RODRIGUEZ', 'Julien', '1996-03-04', 21, '2020-10-14'),
  ('RONCALLI', 'Théo', '1997-01-20', 19, '2023-10-01'),
  ('RUBIO PROANO', 'Andrés', '1989-11-24', 21, '2018-10-01'),
  ('RYSBAYEVA', 'Korlan', '1993-09-26', 24, '2019-12-01'),
  ('SANKAR', 'Remya', '1993-12-11', 18, '2018-10-01'),
  ('SARTORI', 'Richard', '1997-03-22', 21, '2021-04-15'),
  ('SCHABANEL', 'Juliette', '2000-02-09', 9, '2024-09-01'),
  ('SCHLICK', 'Charlie', '1996-10-26', 13, '2019-10-01'),
  ('SCHOETERS', 'Jason', '1993-04-17', 10, '2017-11-01'),
  ('SCRAVAGLIERI', 'Lana', '1998-04-23', 20, '2022-11-01'),
  ('SHILOVA', 'Alena', '1994-06-19', 22, '2018-10-08'),
  ('SLIMI', 'Anwer', '1996-02-10', 14, '2020-01-01'),
  ('SPITZER', 'Gian Luca', '2000-07-27', 12, '2024-12-01'),
  ('STROCK', 'Anthony', '1994-10-03', 18, '2017-09-01'),
  ('SWARTVAGHER', 'Philippe', '1996-07-21', 21, '2019-10-01'),
  ('SWESSI', 'Rania', '1999-01-11', 18, '2023-04-01'),
  ('SYLLA', 'Tidiane', '1987-06-08', 23, '2018-10-01'),
  ('TAHIRI', 'Mohamed', '2000-11-04', 14, '2023-11-01'),
  ('TAYEB', 'Hayfa', '1997-10-23', 22, '2021-11-01'),
  ('TEGANAHALLY SRIDHARA', 'Shrinidhi', '2000-08-12', 12, '2024-10-01'),
  ('TROCELLIER', 'David', '1997-12-09', 13, '2021-10-01'),
  ('TROCHON', 'Méline', '2002-01-30', 21, '2024-11-01'),
  ('TROUVAIN', 'Nathan', '1998-01-05', 18, '2022-10-01'),
  ('TSIAPKOLIS', 'Panagiotis', '1997-06-12', 13, '2022-01-17'),
  ('VANHATALO', 'Tara', '1995-08-17', 14, '2021-06-28'),
  ('VARIN', 'Zoé', '1998-07-13', 9, '2022-09-01'),
  ('VERITE', 'Mathieu', '1989-08-27', 22, '2019-09-01'),
  ('VERNAECKT', 'Pierre', '1982-09-16', 23, '2020-10-05'),
  ('VIDAL', 'Nicolas', '1993-02-07', 21, '2018-10-01'),
  ('VINAYAGAME', 'Radjasouria', '1998-07-03', 20, '2022-12-01'),
  ('VU', 'Manh Tu', '1993-08-23', 14, '2019-11-04'),
  ('WALTHER', 'Dimitri', '2001-04-19', 22, '2024-10-01'),
  ('WEBER', 'Axelle', '1996-01-18', 24, '2019-11-12'),
  ('WELTER', 'Marc', '1989-06-29', 13, '2022-02-01'),
  ('YACHEUR', 'Braddedine', '1996-03-25', 23, '2020-10-01'),
  ('YAKOVLEV', 'Ivan', '1997-11-17', 10, '2021-09-01'),
  ('YEBDA', 'Thinhinane', '1994-08-10', 14, '2018-11-08'),
  ('ZAMAI', 'Andrew', '2000-02-02', 14, '2024-10-01'),
  ('ZHAO', 'Xunyi', '1997-01-08', 22, '2021-09-01'),
  ('ZHU', 'Boyu', '1998-06-03', 24, '2024-12-02'),
  ('ZHUKOV', 'Alexey', '1998-03-10', 14, '2023-09-18'),
  ('ZORN', 'Timothé', '2001-10-08', 23, '2025-01-01'),
  ('ZOURE', 'Moubarak', '1995-03-20', 23, '2018-11-01'),
  ('ZRIGUI', 'Sarra', '1991-12-15', 14, '2020-06-01')
)
INSERT INTO affectations_structures_laboratoires (personne, structure_laboratoire, date_debut)
SELECT p.id, dea.structure_laboratoire, COALESCE(dea.date_debut, '2000-01-01')::date
FROM doctorant_equipe_affectations dea
JOIN personnes p
  ON p.nom = dea.nom
 AND p.prenom = dea.prenom
 AND (p.date_naissance IS NOT DISTINCT FROM dea.date_naissance::date)
WHERE NOT EXISTS (
  SELECT 1 FROM affectations_structures_laboratoires asl
  WHERE asl.personne = p.id
    AND asl.structure_laboratoire = dea.structure_laboratoire
);

WITH depart_affectations (personne, date_depart) AS (
VALUES
  (1, '2022-08-31'),
  (11, '2023-03-01'),
  (19, '2022-08-31'),
  (23, '2021-08-31'),
  (35, '2023-08-31'),
  (39, '2023-08-31'),
  (44, '2022-08-31'),
  (54, '2023-08-31'),
  (61, '2022-12-01'),
  (63, '2021-12-31'),
  (69, '2024-08-31'),
  (70, '2010-09-01'),
  (75, '2022-01-01'),
  (81, '2022-08-31'),
  (84, '2023-08-31'),
  (85, '2024-08-31'),
  (91, '2021-08-31'),
  (95, '1999-01-01'),
  (100, '2023-09-01'),
  (101, '2023-08-31'),
  (102, '2024-11-30'),
  (112, '2023-12-01'),
  (119, '2023-09-01'),
  (131, '2021-08-31'),
  (132, '2021-08-31'),
  (138, '2024-08-31'),
  (140, '2023-10-01'),
  (149, '2023-12-31'),
  (150, '2022-08-31'),
  (158, '1999-01-01'),
  (164, '2022-08-31'),
  (166, '2025-08-31'),
  (167, '2021-08-31'),
  (170, '2024-02-15'),
  (175, '2022-08-31'),
  (181, '2024-08-31'),
  (189, '2023-12-31'),
  (190, '2024-01-31'),
  (196, '2024-01-31'),
  (203, '2024-02-28'),
  (206, '2025-07-29'),
  (209, '2022-10-31'),
  (213, '2023-09-30'),
  (214, '2021-03-31'),
  (215, '2020-08-31'),
  (216, '2020-08-31'),
  (217, '2025-09-19'),
  (218, '2025-08-31'),
  (219, '2025-07-31'),
  (220, '2024-12-31'),
  (221, '2025-09-15'),
  (222, '2024-01-31'),
  (223, '2024-06-30'),
  (224, '2024-02-29'),
  (225, '2021-10-15'),
  (226, '2021-08-31'),
  (227, '2021-10-31'),
  (228, '2023-03-31'),
  (229, '2023-12-20'),
  (230, '2025-05-31'),
  (231, '2023-02-20'),
  (232, '2022-01-31'),
  (233, '2020-02-14'),
  (235, '2021-08-31'),
  (236, '2025-03-31'),
  (237, '2021-10-31'),
  (238, '2025-09-30'),
  (239, '2025-08-31'),
  (239, '2027-12-31'),
  (240, '2020-12-31'),
  (242, '2025-09-30'),
  (243, '2024-12-14'),
  (244, '2025-09-30'),
  (245, '2021-01-31'),
  (248, '2024-03-31'),
  (249, '2023-12-31'),
  (250, '2021-06-30'),
  (252, '2024-08-31'),
  (253, '2024-07-31'),
  (254, '2022-06-30'),
  (255, '2021-12-31'),
  (256, '2020-05-31'),
  (257, '2025-09-14'),
  (259, '2020-02-29'),
  (260, '2024-08-31'),
  (261, '2025-08-31'),
  (262, '2025-08-31'),
  (263, '2025-09-30'),
  (264, '2021-06-30'),
  (265, '2020-12-11'),
  (266, '2024-03-14'),
  (267, '2021-08-31'),
  (268, '2025-08-31'),
  (269, '2021-09-30'),
  (270, '2024-03-31'),
  (271, '2023-01-26'),
  (272, '2024-06-30'),
  (273, '2025-08-31'),
  (274, '2023-10-31'),
  (275, '2020-12-31'),
  (276, '2023-08-31'),
  (277, '2022-08-31'),
  (278, '2020-01-14'),
  (279, '2022-09-19'),
  (280, '2023-08-31'),
  (282, '2025-09-30'),
  (283, '2020-12-31'),
  (284, '2023-08-31'),
  (285, '2021-08-31'),
  (286, '2021-02-28'),
  (287, '2024-08-15'),
  (288, '2021-10-31'),
  (289, '2025-09-30'),
  (290, '2025-08-31'),
  (291, '2024-03-14'),
  (292, '2024-10-31'),
  (293, '2022-08-31'),
  (295, '2022-08-31')
)
INSERT INTO fin_affectations_laboratoires (affectation_laboratoire, date_fin)
SELECT al.id, da.date_depart::date
FROM depart_affectations da
JOIN affectations_laboratoires al
  ON al.personne = da.personne
WHERE al.date_debut <= da.date_depart::date
  AND al.laboratoire = 1
  AND NOT EXISTS (
    SELECT 1 FROM fin_affectations_laboratoires fal
    WHERE fal.affectation_laboratoire = al.id
  );

SELECT setval(pg_get_serial_sequence('affectations_laboratoires', 'id'), COALESCE(MAX(id), 1)) FROM affectations_laboratoires;
SELECT setval(pg_get_serial_sequence('affectations_structures_laboratoires', 'id'), COALESCE(MAX(id), 1)) FROM affectations_structures_laboratoires;
SELECT setval(pg_get_serial_sequence('etablissements', 'id'), COALESCE(MAX(id), 1)) FROM etablissements;
SELECT setval(pg_get_serial_sequence('tutelles_laboratoires', 'id'), COALESCE(MAX(id), 1)) FROM tutelles_laboratoires;
SELECT setval(pg_get_serial_sequence('structures_laboratoires_kind', 'id'), COALESCE(MAX(id), 1)) FROM structures_laboratoires_kind;
SELECT setval(pg_get_serial_sequence('structures_laboratoires', 'id'), COALESCE(MAX(id), 1)) FROM structures_laboratoires;

COMMIT;
